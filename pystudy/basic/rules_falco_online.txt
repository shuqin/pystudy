{"data":[{"uuid":"299982922144124635","rule_name":"异常清理.bash_history内容","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现异常清理bash命令历史记录的可疑行为","handle_desc":"通过云端记录的bash审计日志排查攻击者执行的操作。","action_desc":"攻击者通过清理rm或者echo命令删除bash_history文件中的历史记录来逃避检测。"}],"score":9,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1070","name":"主机数据删除"},{"uuid":"T1070.003","name":"清除命令历史"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-05-18T08:11:54Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (ash,bash,csh,ksh,sh,tcsh,zsh,dash,rm,echo,chattr,cat) and process_create.cmd matches \"(\\brm.+\\.bash_history|(echo|cat).+\\>.*\\.bash_history|chattr\\s+\\+i.*.bash_history|history\\s+\\-c\\s*)\""},"group_id":""},{"uuid":"299982922144124725","rule_name":"虚拟机逃逸","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现虚拟机进程执行可以命令%(cmd)","handle_desc":"关闭恶意进程，并及时修复软件漏洞。","action_desc":"攻击者通过VMware、VitualBox的虚拟机逃逸漏洞在宿主机执行系统命令。"}],"score":9,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1068","name":"特权提升漏洞"}],"platforms":[11,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-05-18T05:55:01Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (vmware-vmx,vmware-dhcpd,vmnet-natd,VirtualBox,VirtualBoxVM) and process_create.pname in (ls,cat,useradd,nmap,base64,chattr,arp,passwd,adduser,masscan,hydra) and not process_create.cmd contains \"version\""},"group_id":""},{"uuid":"299982922144124776","rule_name":"powershell使用base64加解密","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现疑似powershell加密指令可能包含黑客执行的恶意命令","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"powershell使用base64加解密的两种形式，攻击者为了绕过检测，会在powershell命令中使用base加密。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.001","name":"POWERSHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-05-18T05:28:32Z","rule_roles":["1"],"rule_details":{"content":"not process_create.acmd[1] matches \"node.*?webpack\" and process_create.pname in (powershell.exe) and process_create.cmd matches \"([cC][oO][nN][vV][eE][rR][tT]\\]\\:\\:[fF][rR][oO][mM][bB][aA][sS][eE]64[sS][tT][rR][iI][nN][gG]\\(|\\-(([eE][nN][cC][oO][dD][eE][dD][cC][oO][mM][mM][aA][nN][dD])|([eE])|([eE][nN])|([eE][nN][cC])|([eE][nN][cC][oO])|([eE][nN][cC][oO][dD])|([eE][nN][cC][oO][dD][eE][dD]))\\s+.*)\""},"group_id":""},{"uuid":"299982922144124735","rule_name":"Powershell使用base64加解密","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"命令行%(cmd)中的加密指令可能包含黑客执行的恶意命令","handle_desc":"停止进程，删除相关文件","action_desc":"powershell通过base64加解密执行恶意命令"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059.001","name":"POWERSHELL"},{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-05-18T05:27:24Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (powershell.exe,cmd.exe) and process_create.cmd pmatch (\"\\-(([eE][nN][cC][oO][dD][eE][dD][cC][oO][mM][mM][aA][nN][dD])|([eE])|([eE][nN])|([eE][nN][cC])|([eE][nN][cC][oO])|([eE][nN][cC][oO][dD])|([eE][nN][cC][oO][dD][eE][dD]))\\s+.*\", \"[cC][oO][nN][vV][eE][rR][tT]\\]\\:\\:[fF][rR][oO][mM][bB][aA][sS][eE]64[sS][tT][rR][iI][nN][gG]\\(\")"},"group_id":""},{"uuid":"299982922144124708","rule_name":"bash生成交互式shell","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现生成bash交互式shell的可疑命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"bash -i参数是使用交互式shell执行，攻击者通常会bash -i方式来执行恶意bash命令，或者从外网获取命令执行。"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[21],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"容器规则，在非容器环境可能会有大量误报","operate_name":"liwei.liu","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-05-18T05:20:51Z","rule_roles":["1"],"rule_details":{"content":"not process_create.acmd[1] matches \"(pipenv|poetry\\s+shell)\" and process_create.pname in (ash, bash, csh, ksh, sh, tcsh, zsh, dash) and process_create.cmd matches \"^(\\/bin\\/|\\/usr\\/bin\\/)?(bash|sh|dash|tcsh|csh|ksh|zsh|ash)\\s+-i\\s?$\""},"group_id":""},{"uuid":"299982922144124742","rule_name":"nodejs进程执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现使用nodejs进程执行系统命令%(pname)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"使用nodejs进程执行系统命令。nodejs大多数情况下不会直接调用系统的关键命令比如powershell或者systeminfo等，因此这种行为很可疑。"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"wei.wen","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-05-17T03:06:41Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (node.exe) and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe ) and process_create.cmd matches \"^((?!node_modules|tfsagent).)*$\""},"group_id":""},{"uuid":"459962113629093933","rule_name":"利用ptrace、execve隐藏进程参数和进程可执行文件","displays":[{"type":"process_create","alarm_type":"QTAL-006","alarm_name":"隐藏进程","alarm_title":"发现进程%(pname)具有伪造的命令行%(cmd)和文件路径%(fpath)","handle_desc":"攻击者可通过ptrace和execve调用改变进程命令行和进程文件路径以实现进程隐藏、伪装目的。","action_desc":"实时检测进程启动时的命令行和文件路径"}],"score":8,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1036","name":"伪装"},{"uuid":"T1055.008","name":"PTRACE 系统调用"}],"platforms":[11,31],"data_type":1,"active":1,"custom":"default","min_version":"1.0","max_version":"999.999","comment":"","operate_name":"liwei.liu","created_at":"2023-05-10T03:13:03Z","updated_at":"2023-05-10T03:16:14Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd contains \"/proc/self/fd\" and process_create.path matches \"^\\/memfd\\/\""},"group_id":""},{"uuid":"452134821733335085","rule_name":"使用ps命令获取有关titanagent进程的详细信息_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)获取titanagent进程信息的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后，可通过系统自带命令获取系统中运行的进程列表。"}],"score":3,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1057","name":"进程发现"}],"platforms":[31,11,21],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T03:15:54Z","updated_at":"2023-04-28T03:07:02Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (ps) and process_create.cmd contains \"titanagent\" and not process_create.cmd matches \"ps\\s+-o\\s+stat\\s+-C\" and not process_create.cmd matches \"ps\\s-o\\spid=\\s-C\\stitanagent\""},"group_id":""},{"uuid":"299982922144124634","rule_name":"操作系统敏感文件","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现操作系统敏感文件的可疑行为，进程命令行为%(cmd)","handle_desc":"结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"通过导出/etc/passwd和/etc/shadow的文件内容，攻击者可以进行离线密码破解，攻击者也可以在bash历史记录文件或数据库历史记录文件中发现用户输入的明文密码。"}],"score":8,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1003.008","name":"/etc/passwd&amp;shadow"}],"platforms":[11,21,31],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-27T09:01:01Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (cat,head,tail,tac,less,more,vi,vim,nano,getent,vipw,vigr) and process_create.cmd matches \"(\\/etc\\/passwd|\\/etc\\/shadow)\""},"group_id":""},{"uuid":"299982922144124662","rule_name":"sudo漏洞提权","displays":[{"type":"default_source","alarm_type":"QTAL-004","alarm_name":"本地提权","alarm_title":"发现利用sudo漏洞提权的可疑行为%(cmd)","handle_desc":"停止并删除相关的恶意进程文件，及时对漏洞进行修补。","action_desc":"当攻击者获取到系统的初始访问权限时的进程执行用户可能并非root，通过利用系统内核或软件中存在的特权提升漏洞可以获取到系统的最高访问权限。"}],"score":3,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1068","name":"特权提升漏洞"}],"platforms":[11,21,31],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"M5服务端解析有bug，导致整个falco不可用，暂时禁用","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-25T03:43:14Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (sudoedit,sudo) and process_create.cmd matches \"(-s|-i|--login)\\s+.*\\\\\""},"group_id":""},{"uuid":"299982922144124728","rule_name":"Web应用异常执行history命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现Web应用%(proc.aname)异常执行history命令，进程命令行为%(cmd)","handle_desc":"排查恶意web文件进行删除，根据web日志排查攻击者的入侵途径，及时修补漏洞。","action_desc":"攻击者通过执行history命令查看bash历史记录，在其中可能找到用户输入的明文密码等敏感信息。"}],"score":9,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1552","name":"不安全的凭证"},{"uuid":"T1552.003","name":"BASH 历史记录"}],"platforms":[21,11,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T09:19:48Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd pmatch (\"java.*?((tomcat)|(shiro)|(zoomkeeper)|(log4j)|(weaver)|([rR]esin)|(dubbo)|(WebSphere)|(spring)|(jenkins)|(jira)|(atlassian)|(elasticsearch)|(jboss)|(solr)|(nexus)|(jackson)|(fastjson)|(activemq)|[cC][mM][sS]|[wW][eE][bB])\", \"apache\", \"httpd\", \"php-fpm\", \"postgres\", \"redis-server\") and process_create.pname in (bash,sh,dash,tcsh,csh,ksh,zsh) and process_create.cmd matches \"^(\\/bin\\/|\\/usr\\/bin\\/)?(bash|sh|dash|tcsh|csh|ksh|zsh)\\s+\\-c\\s+history\\s*(-[rc])?\\s*$\""},"group_id":""},{"uuid":"457238798900658221","rule_name":"Web服务调用python启动交互式shell","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web服务%(proc.aname)异常执行python命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者使用冰蝎客户端连接webshell后，通常会通过python的pty.spawn(\"/bin/bash\")获取一个真实的shell环境进行操作。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"},{"uuid":"T1140","name":"解混淆/解码文件或信息"},{"uuid":"T1202","name":"间接执行命令"}],"platforms":[21,11,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-04-21T08:19:21Z","updated_at":"2023-04-21T08:29:33Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd pmatch (\"java.*?((tomcat)|(shiro)|(zoomkeeper)|(log4j)|(weaver)|([rR]esin)|(dubbo)|(WebSphere)|(spring)|(jenkins)|(jira)|(atlassian)|(elasticsearch)|(jboss)|(solr)|(nexus)|(jackson)|(fastjson)|(activemq)|[cC][mM][sS]|[wW][eE][bB])\", \"apache\", \"httpd\", \"php-fpm\", \"postgres\", \"redis-server\") and process_create.pname in (python,python2,python3) and process_create.cmd matches \"-c\\s+['\\\"]?import\\s+pty\\s*;\\s*pty\\.spawn(['\\\"]\\/bin\\/bash['\\\"])\""},"group_id":""},{"uuid":"299982922144124726","rule_name":"Web服务异常调用python","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web服务异常执行python命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者执行python --help或python -V命令探测当前系统中安装的python版本后可利用python解码并执行base64加密的恶意代码，以此逃避防御并执行恶意命令，或直接利用python进行反弹shell操作。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"},{"uuid":"T1140","name":"解混淆/解码文件或信息"},{"uuid":"T1202","name":"间接执行命令"}],"platforms":[21,11,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T08:15:40Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd pmatch (\"java.*?((tomcat)|(shiro)|(zoomkeeper)|(log4j)|(weaver)|([rR]esin)|(dubbo)|(WebSphere)|(spring)|(jenkins)|(jira)|(atlassian)|(elasticsearch)|(jboss)|(solr)|(nexus)|(jackson)|(fastjson)|(activemq)|[cC][mM][sS]|[wW][eE][bB])\", \"apache\", \"httpd\", \"php-fpm\", \"postgres\", \"redis-server\") and process_create.pname in (python,python2,python3) and (process_create.cmd matches \"^(python\\w{0,1}|python\\w{0,1}\\s+-h|python\\w{0,1}\\s+\\-\\-help|python\\w{0,1}\\s+\\-V)\\s*$\" or process_create.cmd matches \"subprocess\\.(PIPE|Popen|run|call|check_all|check_output|getoutput|getstatusoutput)\" or process_create.cmd matches \"exec.*b64decode\")"},"group_id":""},{"uuid":"299982922144124637","rule_name":"Web服务异常写文件","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现Web服务执行curl命令进行文件写入，进程命令行为%(cmd)","handle_desc":"删除恶意文件并停止恶意进程，通过系统日志或其他告警排查攻击者的入侵途径，及时修补漏洞。","action_desc":"攻击者通过wget、curl、echo、base64等命令配合重定向操作可以在磁盘中写入恶意文件。"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T08:11:34Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (apache,apache2,httpd,php-fpm,java,postgres,redis-server) and process_create.cmd matches \"((curl.+\\:\\/\\/.+(\\-o\\s|\\>|\\>\\>).+)|(echo.*\\|.*base64.*\\-d.*\\>.*))\""},"group_id":""},{"uuid":"299982922144124837","rule_name":"sqlserver执行网络连接命令","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"sqlserver执行可疑的网络连接命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"sqlserver执行网络连接命令，包括ping,nslookup等。攻击者可能会通过漏洞尝试执行这些命令进行信息收集或者进一步渗透。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:57:16Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (sqlserver.exe,sqlservr.exe,MSSQL.exe,mssql.exe) and process_create.pname in (ping.exe,nslookup.exe) and process_create.acmd matches \"(([pP][iI][nN][gG])|([nN][sS][lL][oO][oO][kK][uU][pP]))(?!.*127\\.0\\.0\\.1|.*172\\.[1-3][0-9]\\.|.*10\\.|.*192\\.168\\.|.*localhost).*\""},"group_id":""},{"uuid":"299982922144124766","rule_name":"利用进程注入执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现无参数的rundll32进程疑似被注入恶意代码","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"无参数的rundll32进程疑似被注入恶意代码，正常的rundll32必须有参数才能持续运行，攻击者常用工具比如CS生成shellcode注入到rundll32进行权限维持，表现出的特征就是无参数的rundll32进程。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1055","name":"进程注入"},{"uuid":"T1218.011","name":"RUNDLL32"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:56:55Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd matches \"rundll32\\.exe$\" and process_create.pname in (powershell.exe,cmd.exe,net.exe,wmic.exe,netsh.exe,mimikatz.exe,nmap.exe,rundll32.exe,arp.exe,netstat.exe,tasklist.exe)"},"group_id":""},{"uuid":"299982922144124743","rule_name":"spoolsv.exe执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现spoolsv.exe执行系统命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者通过spoolsv.exe执行系统命令进行攻击。spoolsv.exe 是Print Spooler的进程，管理所有本地和网络打印队列及控制所有打印工作。很多木马会将自己伪装成spoolsv.exe，执行恶意操作"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:56:46Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.ppname in (spoolsv.exe) and process_create.pname in (powershell.exe,procdump.exe,cmd.exe,procdump64.exe )"},"group_id":""},{"uuid":"299982922144124738","rule_name":"CreateHiddenAccount创建隐藏用户","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现命令行中使用CreateHiddenAccount创建隐藏用户的行为，命令行为%(cmd)","handle_desc":"删除创建的用户，结束相关进程","action_desc":"使用CreateHiddenAccount创建隐藏用户进行权限维持。CreateHiddenAccount是一个可以在windows上创建指定隐藏账户的常用工具。"}],"score":9,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1136","name":"创建账户"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:56:34Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.ppname in (\"cmd.exe\",\"powershell.exe\") and process_create.cmd matches \"(CreateHiddenAccount.exe|CreateHiddenAccount_upx.exe|CreateHiddenAccount\\S+?.exe|CreateHiddenAccount_upx\\S+?.exe)\\s+?-u\\s?.+?\\s+?-p\\s+?.+\""},"group_id":""},{"uuid":"299982922144124770","rule_name":"利用winrm横向渗透","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现疑似利用winrm横向渗透的进程，命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"用winRM横向移动时，被攻击的机器会产生winrshost.exe进程，且执行的命令都是该进程的子进程"}],"score":10,"tactics":[{"uuid":"TA0008","name":"横向移动"}],"techniques":[{"uuid":"T1570","name":"横向工具传输"},{"uuid":"T1021","name":"远程服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:56:25Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname[1] in (wsmprovhost,wsmprovhost.exe,winrshost,winrshost.exe) and process_create.pname in (cmd.exe,powershell.exe)"},"group_id":""},{"uuid":"299982922144124764","rule_name":"suspicious_task_a","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现计划任务运行文件在系统TEMP目录，疑似后门计划任务，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"计划任务对应的文件应该在系统目录，或者其他用户配置的目录下，不应该存在于临时目录。很多攻击者由于只有临时目录的权限，只能把对应恶意文件保存到临时目录，配置计划任务进行权限维持。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1053","name":"计划任务/作业"},{"uuid":"T1053.005","name":"计划任务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:56:17Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname[1] in (taskeng.exe) and process_create.cmd matches \"^[cC]:\\\\[wW]indows\\\\[tT]emp\\\\.*?\\.[eE][xX][eE]\""},"group_id":""},{"uuid":"299982922144124757","rule_name":"suspicious_task_b","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现计划任务运行文件在系统TEMP目录，疑似后门计划任务，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"计划任务对应的文件应该在系统目录，或者其他用户配置的目录下，不应该存在于临时目录。很多攻击者由于只有临时目录的权限，只能把对应恶意文件保存到临时目录，配置计划任务进行权限维持。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1053.005","name":"计划任务"},{"uuid":"T1053","name":"计划任务/作业"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:56:10Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (svchost.exe) and process_create.acmd[1] matches \"netsvcs.*?-p\" and process_create.cmd matches \"^[cC]:\\\\[wW]indows\\\\[tT]emp\\\\.*?\\.[eE][xX][eE]$\""},"group_id":""},{"uuid":"299982922144124730","rule_name":"Office执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现Office产生恶意子进程%(pname)","handle_desc":"关闭并清除恶意文件。","action_desc":"攻击者通过将恶意代码插入Office文档中实现钓鱼攻击获取PC权限。"}],"score":9,"tactics":[{"uuid":"TA0001","name":"初始访问"}],"techniques":[{"uuid":"T1566","name":"钓鱼"},{"uuid":"T1566.001","name":"钓鱼附件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:55:57Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.ppname in (winword.exe,excel.exe,powerpnt.exe,hh.exe) and process_create.pname in (cmd.exe,powershell.exe,wmic.exe,cscript.exe,wscript.exe,mshta.exe,rundll32.exe,msiexec.exe,regsvr32.exe) and process_create.cmd matches \"^(?:(?!rundll32.*?(?:\\\\system32\\\\spool\\\\DRIVERS|OpenAs_RunDLL\\s+[a-zA-Z]:\\\\|:\\\\PROGRA.*?Office\\d+\\\\GrooveUtil\\.DLL)).)*$\""},"group_id":""},{"uuid":"299982922144124729","rule_name":"异常查询titanagent进程","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现恶意探测titanagent进程的行为","handle_desc":"结合日志以及漏洞检测结果排查业务漏洞利用痕迹。","action_desc":"攻击者通过ps命令探测当前主机是否已经安装TitanAgent。"}],"score":10,"tactics":[{"uuid":"TA0043","name":"侦查"}],"techniques":[{"uuid":"T1592","name":"搜集主机信息"},{"uuid":"T1592.002","name":"软件"}],"platforms":[21,11,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:55:44Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd pmatch (\"java.*?((tomcat)|(shiro)|(zoomkeeper)|(log4j)|(weaver)|([rR]esin)|(dubbo)|(WebSphere)|(spring)|(jenkins)|(jira)|(atlassian)|(elasticsearch)|(jboss)|(solr)|(nexus)|(jackson)|(fastjson)|(activemq)|[cC][mM][sS]|[wW][eE][bB])\", \"apache\", \"httpd\", \"php-fpm\", \"postgres\", \"redis-server\") and process_create.cmd matches \"ps.*\\|\\s+grep.+titan(?!\\_).*\""},"group_id":""},{"uuid":"299982922144124746","rule_name":"VMware Workstation虚拟机逃逸","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现通过VMware Workstation进行虚拟机逃逸，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者VMware Workstation进行虚拟机逃逸从而尝试获得主机权限"}],"score":10,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1068","name":"特权提升漏洞"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:54:02Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (vmware-vmx.exe,vmnetdhcp.exe,vmnat.exe) and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe )"},"group_id":""},{"uuid":"299982922144124747","rule_name":"VirtualBox虚拟机逃逸","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现通过VirtualBox进行虚拟机逃逸，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者VirtualBox进行虚拟机逃逸从而尝试获得主机权限"}],"score":10,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1068","name":"特权提升漏洞"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:53:54Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (VirtualBox.exe,VirtualBoxVM.exe) and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe )"},"group_id":""},{"uuid":"299982922144124745","rule_name":"Hyper-V虚拟机逃逸","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现通过Hyper-V进行虚拟机逃逸，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者Hyper-V进行虚拟机逃逸从而尝试获得主机权限"}],"score":10,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1068","name":"特权提升漏洞"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:53:49Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (vmwp.exe) and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe )"},"group_id":""},{"uuid":"299982922144124754","rule_name":"QEMU/KVM虚拟机逃逸","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现QEMU/KVM虚拟机逃逸行为，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者进行QEMU/KVM虚拟机逃逸从而尝试获得主机权限"}],"score":10,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1068","name":"特权提升漏洞"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:53:43Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (qemu-system-i386.exe,qemu-system-x86_64.exe) and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe)"},"group_id":""},{"uuid":"299982922144124740","rule_name":"impacket横向移动_service","displays":[{"type":"default_source","alarm_type":"QTAL-038","alarm_name":"异常进程树","alarm_title":"发现使用atexec.py脚本通过service横向移动，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"atexec.py脚本通过service横向移动，调用cmd.exe执行命令"}],"score":10,"tactics":[{"uuid":"TA0008","name":"横向移动"}],"techniques":[{"uuid":"T1570","name":"横向工具传输"},{"uuid":"T1021","name":"远程服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-21T06:53:32Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.ppname in (services.exe) and process_create.pname in (cmd.exe) and process_create.cmd matches \"\\/C\\s+.*?>.*?\\\\Temp\\\\.*?\\.tmp\\s+2>&1\""},"group_id":""},{"uuid":"299982922144124719","rule_name":"使用python常用安全工具","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现进程参数中包含可疑的python脚本名","handle_desc":"删除恶意脚本，停止相关恶意进程。","action_desc":"攻击者通过使用一些开源的python安全工具达到横向渗透、漏洞利用等目的。比如GitHack，sqlmap等。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"}],"platforms":[11,21,12,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-20T03:46:18Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (python.exe,python3,python2.7.exe,python,python2) and process_create.cmd matches \"\\b(logtamper\\.py|GitHacker\\.py|GitHack\\.py|sqlmap\\.py|gitea_lfs_rce\\.py|GetADUsers\\.py|GetNPUsers\\.py|GetUserSPNs\\.py|addcomputer\\.py|atexec\\.py|dcomexec\\.py|dpapi\\.py|esentutl\\.py|exchanger\\.py|findDelegation\\.py|getArch\\.py|getPac\\.py|getST\\.py|getTGT\\.py|goldenPac\\.py|karmaSMB\\.py|kintercept\\.py|lookupsid\\.py|mimikatz\\.py|mqtt_check\\.py|mssqlclient\\.py|mssqlinstance\\.py|netview\\.py|nmapAnswerMachine\\.py|ntfs-read\\.py|ntlmrelayx\\.py|psexec\\.py|raiseChild\\.py|rdp_check\\.py|registry-read\\.py|rpcdump\\.py|rpcmap\\.py|sambaPipe\\.py|samrdump\\.py|secretsdump\\.py|smbclient\\.py|smbexec\\.py|smbpasswd\\.py|smbrelayx\\.py|smbserver\\.py|ticketConverter\\.py|ticketer\\.py|wmiexec\\.py|wmipersist\\.py|wmiquery\\.py|windows-exploit-suggester\\.py|zenbuster\\.py)\\b\""},"group_id":""},{"uuid":"452145581867925549","rule_name":"rundll32.exe调用shell32.dll执行恶意命令及二进制文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现rundll32.exe调用shell32.dll执行恶意命令及二进制文件，进程命令行为%(cmd)","handle_desc":"删除恶意文件，结束恶意进程，检查网络连接，排查并溯源","action_desc":"shell32.dll是windows自带的动态链接库，提供了很多核心组件，可以用来创建shell对象，攻击者可以用shell32.dll执行恶意命令"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T05:02:47Z","updated_at":"2023-04-17T08:16:05Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"[Ss][hH][Ee][lL][lL]32\\.[Dd][lL][Ll]\\s*?\\,\\s*?Control_RunDLL\\s+?\\w+?\\.dll|[Ss][hH][Ee][lL][lL]32\\.[Dd][lL][Ll]\\s*?\\,\\s*?ShellExec_RunDLL\\s+?.+?.exe\""},"group_id":""},{"uuid":"452144389460852781","rule_name":"coregen.exe指定dll加载路径","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现coregen.exe指定dll文件加载路径，进程命令行为%(cmd)","handle_desc":"删除恶意文件，结束恶意进程，检测网络连接并排查溯源","action_desc":"coregen.exe是Xilinx ISE设计套件中的一个可执行文件，攻击者可以利用coregen.exe加载路径的恶意dll文件。"}],"score":5,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"chengzhi.zuo","created_at":"2023-03-17T04:50:57Z","updated_at":"2023-04-17T08:16:00Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (coregen.exe) and process_create.cmd matches \"\\/L\\s+?[cC]\\:\\\\.+?\\.dll\\s+\\w+\""},"group_id":""},{"uuid":"452155880696184877","rule_name":"rundll32调用zipfldr.dll执行恶意二进制文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现rundll32调用zipfldr.dll执行恶意二进制文件，进程命令行为%(cmd)","handle_desc":"删除恶意二进制文件，结束相关进程，检查网络连接并排查溯源","action_desc":"利用zipfldr.dll（Compressed Folder library）可以执行恶意二进制文件"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"},{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T06:45:06Z","updated_at":"2023-04-17T08:15:55Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"zipfldr\\.dll\\s*?\\,\\s*?RouteTheCall\\s+?\\w+?.exe|zipfldr\\.dll\\s*?\\,\\s*?RouteTheCall\\s+?file\\:\\/\\/.+?\\^.+?\\^.+?\\^.+?\\^.+?\\.\\^e\\^x\\^e\""},"group_id":""},{"uuid":"452143940150231085","rule_name":"bginfo.exe执行恶意vbs脚本","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现bginfo.exe执行恶意vbs脚本，进程命令行为%(cmd)","handle_desc":"删除恶意脚本，结束恶意进程，检测网络连接并排查溯源","action_desc":"bginfo.exe是SysInternals 套件中包含的背景信息实用程序，利用bginfo.exe可以执行恶意vbs脚本"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T04:46:29Z","updated_at":"2023-04-17T08:15:48Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (bginfo.exe) and process_create.cmd matches \"bginfo\\.bgi\\s+?\\/popup\\s+?\\/nolicprompt\""},"group_id":""},{"uuid":"452031396790140973","rule_name":"利用AccCheckConsole.exe加载托管的恶意dll","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现疑似利用AccCheckConsole.exe加载托管的恶意dll，进程命令行为%(cmd)","handle_desc":"关闭有关恶意进程，删除恶意dll，检查网络连接进行溯源","action_desc":"AccCheckConsole.exe用以验证UI辅助功能要求，利用利用AccCheckConsole.exe可以加载托管的恶意dll"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"},{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"chengzhi.zuo","created_at":"2023-03-16T10:08:28Z","updated_at":"2023-04-17T08:15:43Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (AccCheckConsole.exe) and process_create.cmd matches \"\\-window\\s+?\\\".+?\\\"\\s+?[Cc]\\:.+?\\\\\\w+.dll\""},"group_id":""},{"uuid":"452033744375644205","rule_name":"xwizard.exe加载注册表自定义恶意类","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现xwizard.exe加载注册表自定义恶意类，进程命令行为%(cmd)","handle_desc":"结束相关进程，删除自定义注册表，排查网络连接并溯源","action_desc":"xwizard.exe应该为Extensible wizard的缩写,中文翻译可扩展的向导主机进程"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"宽泛，后续需修改","operate_name":"chengzhi.zuo","created_at":"2023-03-16T10:31:47Z","updated_at":"2023-04-17T08:15:38Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (xwizard.exe) and process_create.cmd matches \"RunWizard\\s+\\{\\w+\\-\\w+-.+?\\}|RunWizard\\s+\\/taero\\s+?\\/u\\s+\\{\\w+\\-.+?\\}\""},"group_id":""},{"uuid":"452032090108592173","rule_name":"Msconfig.exe执行二进制文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Msconfig.exe执行二进制文件的行为，进程命令行为%(cmd)","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现Msconfig.exe执行二进制文件，攻击者会使用该二进制程序执行命令唤起二进制文件。"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T10:15:21Z","updated_at":"2023-04-17T08:15:33Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname matches \".*\\.exe\" and process_create.ppname contains \"Msconfig.exe\""},"group_id":""},{"uuid":"452030240454082605","rule_name":"expand.exe远程下载文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用expand.exe远程下载文件的行为，进程命令行为%(cmd)","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现expand.exe远程下载文件，攻击者会使用该二进制程序从远程服务器下载文件。"}],"score":9,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T09:56:59Z","updated_at":"2023-04-17T08:14:07Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (expand.exe) and process_create.cmd matches \"expand\\s*\\\\\\\\(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost).*bat\""},"group_id":""},{"uuid":"452025685825814573","rule_name":"GfxDownloadWrapper.exe远程下载文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用GfxDownloadWrapper.exe远程下载文件的行为，进程命令行为%(cmd)","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现GfxDownloadWrapper.exe远程下载文件，攻击者会使用该二进制程序从远程服务器下载文件。"}],"score":9,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T09:11:44Z","updated_at":"2023-04-17T08:09:56Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (GfxDownloadWrapper.exe) and process_create.cmd matches \"GfxDownloadWrapper\\.exe\\s*\\\"https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost).*\\.[\\w]+\\\"\""},"group_id":""},{"uuid":"452029235633061933","rule_name":"winword.exe远程下载文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用winword.exe远程下载文件的行为，进程命令行为%(cmd)","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现winword.exe远程下载文件，攻击者会使用该二进制程序从远程服务器下载文件，并保存到缓存目录。"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T09:47:00Z","updated_at":"2023-04-17T08:09:04Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (winword.exe) and process_create.cmd matches \"winword\\.exe\\s*\\\"https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)\""},"group_id":""},{"uuid":"452028780836290605","rule_name":"Excel远程下载文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Excel远程下载文件的行为，进程命令行为%(cmd)","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现Excel.exe远程下载文件，攻击者会使用该二进制程序从远程服务器下载文件，并保存到缓存目录。"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T09:42:29Z","updated_at":"2023-04-17T08:06:21Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Excel.exe) and process_create.cmd matches \"Excel\\.exe\\s*https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)\""},"group_id":""},{"uuid":"452013470620057645","rule_name":"Powerpnt.exe远程下载文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Powerpnt.exe远程下载文件的行为，进程命令行为%(cmd)","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现Powerpnt.exe远程下载文件，攻击者会使用该二进制程序从远程服务器下载文件，并保存到缓存目录。"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T07:10:23Z","updated_at":"2023-04-17T08:06:12Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Powerpnt.exe) and process_create.cmd matches \"Powerpnt\\.exe\\s*\\\"https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)\""},"group_id":""},{"uuid":"452013756084387885","rule_name":"certoc.exe远程下载程序","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用certoc.exe远程下载文件的行为，进程命令行为%(cmd)","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现certoc.exe.exe远程下载文件，攻击者会使用该二进制程序从远程服务器下载文件。"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T07:13:13Z","updated_at":"2023-04-17T08:06:05Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (certoc.exe) and process_create.cmd matches \"certoc\\.exe\\s*\\-GetCACAPS\\s*https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)\""},"group_id":""},{"uuid":"451985808564420653","rule_name":"cmdkey从主机获取凭据信息","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用cmdkey从主机获取凭据信息，进程命令行为%(cmd)","handle_desc":"杀死进程，排查入侵痕迹。","action_desc":"cmdkey.exe系统白文件，攻击者可以通过该文件从主机获取凭据信息"}],"score":7,"tactics":[{"uuid":"TA0006","name":"凭证访问"},{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1003","name":"系统凭证转储"},{"uuid":"T1005","name":"本地系统数据"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T02:35:35Z","updated_at":"2023-04-17T08:05:49Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (cmdkey.exe) and process_create.cmd matches \"cmdkey\\s*\\/list\""},"group_id":""},{"uuid":"452025300872593453","rule_name":"DataSvcUtil.exe远程下载文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用DataSvcUtil.exe远程下载文件的行为，进程命令行为%(cmd)","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现DataSvcUtil.exe远程下载文件，攻击者会使用该二进制程序从远程服务器下载文件。"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T09:07:54Z","updated_at":"2023-04-17T08:05:32Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (DataSvcUtil.exe) and process_create.cmd matches \"DataSvcUtil\\s*\\/out\\:.*\\/uri\\:https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)\""},"group_id":""},{"uuid":"452016439583309869","rule_name":"利用cdb.exe加载shellcode","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现疑似利用利用cdb.exe加载shellcode，进程命令行为%(cmd)","handle_desc":"结束恶意进程，删除恶意shellcode文件，检测网络连接，排查并溯源","action_desc":"cdb 是安装 windows debugging tools 时自带的一个命令行调试工具，由微软签发证书，攻击者利用cdb.exe可以加载shellcode及恶意命令"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T07:39:53Z","updated_at":"2023-04-17T08:05:22Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (cdb.exe) and process_create.cmd matches \"\\-cf\\s+?\\w+\\.wds\\s+?\\-o\\s+?\\w+.exe\""},"group_id":""},{"uuid":"452015256420483117","rule_name":"wscript.exe执行恶意脚本","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现疑似利用wscript.exe执行恶意脚本，进程命令行为%(cmd)","handle_desc":"结束恶意进程，删除恶意文件，排查并溯源","action_desc":"wscript.exe由Windows 用于执行脚本也可用于执行恶意脚本"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"chengzhi.zuo","created_at":"2023-03-16T07:28:07Z","updated_at":"2023-04-17T08:05:11Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (wscript.exe) and process_create.cmd matches \"\\:\\\\.+?\\\\.+?.txt\\:.+?.vbs|GetObject\\(\\\"script\\:[Hh][Tt][tT][Pp][sS]\\:\\/\\/.+?.js.+?>.+?\\&\\&.+?.txt\\:.+?.js\""},"group_id":""},{"uuid":"451987069741301805","rule_name":"ConfigSecurityPolicy.exe执行文件上传操作","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用ConfigSecurityPolicy.exe进行文件上传，进程命令行为%(cmd)","handle_desc":"杀死进程，检查是否为业务操作，排查入侵痕迹。","action_desc":"ConfigSecurityPolicy.exe是系统白文件，攻击者可以通过该文件将从主机上获取的文件上传到指定web服务器"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T02:48:07Z","updated_at":"2023-04-17T08:05:05Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (ConfigSecurityPolicy.exe) and process_create.cmd matches \"ConfigSecurityPolicy\\.exe\\s*.*https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)\""},"group_id":""},{"uuid":"451987034710474797","rule_name":"TTDInject.exe执行恶意二进制文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现TTDInject.exe执行恶意二进制文件，进程命令行为%(cmd)","handle_desc":"排查入侵痕迹，删除恶意二进制文件","action_desc":"TTDInject.exe由 Windows 1809 及更高版本用于调试Time Travel (Underlying call of tttracer.exe)，攻击者可以利用该程序执行恶意二进制文件"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断被执行文件","operate_name":"chengzhi.zuo","created_at":"2023-03-16T02:47:46Z","updated_at":"2023-04-17T08:04:15Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (TTDInject.exe) and process_create.cmd matches \"\\/[Cc][lL][Ii][eE][nN][Tt][Ss][cC][Ee][nN][Aa][rR][Ii][oO]\\s+?[tT][Tt][dD][Rr][eE][Cc][oO][Rr][dD][Ee][rR].+?[dD][Dd][lL][Oo][aA][Dd].+?[Cc][lL][Ii][eE][nN][Tt][pP][aA][rR][aA][mM][Ss].+?tmp.run.+?\\/[Ll][aA][uU][nN][cC][Hh].+?.exe|[Cc][lL][Ii][eE][nN][Tt][pP][aA][rR][aA][mM][Ss].+?tmp.run.+?[Ll][aA][uU][nN][cC][Hh].+?.exe\""},"group_id":""},{"uuid":"451986713309347885","rule_name":"CertReq.exe执行文件上传操作","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用CertReq.exe进行可疑的文件上传操作，进程命令行为%(cmd)","handle_desc":"杀死进程，检查是否为业务操作，排查入侵痕迹。","action_desc":"CertReq.exe是系统白文件，攻击者可以通过该文件将从主机上获取的文件上传到指定web服务器"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T02:44:34Z","updated_at":"2023-04-17T08:04:10Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (CertReq.exe) and process_create.cmd matches \"CertReq\\s*\\-Post\\s*\\-config\\s*https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)\""},"group_id":""},{"uuid":"451983764747190317","rule_name":"rpcping.exe发送NTLM哈希","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用rpcping.exe发送NTLM哈希的行为，进程命令行为%(cmd)","handle_desc":"杀死进程，排查入侵痕迹","action_desc":"检测到发送一个RPC测试连接到目标服务器，并强制在进程中发送NTLM哈希。"}],"score":8,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1187","name":"强制身份验证"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T02:15:17Z","updated_at":"2023-04-17T08:03:50Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rpcping.exe) and process_create.cmd matches \"rpcping\\s*[\\-\\/]s\\s{1,5}(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost).*NTLM\""},"group_id":""}],"total":336}

{"data":[{"uuid":"451890104814796845","rule_name":"利用Sc.exe修改已有服务的二进制文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Sc.exe修改已有服务的二进制文件，进程命令行为%(cmd)","handle_desc":"排查进程，结束恶意进程，恢复原有文件","action_desc":"sc.exeWindows 用于管理服务，攻击者可以利用其创建恶意服务或者修改已有服务"}],"score":5,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T10:44:51Z","updated_at":"2023-04-17T08:03:13Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Sc.exe) and process_create.cmd matches \"config\\s+?.+?binpath.+?\\\\\\\\\\w+.txt\\:.+?echo.+?>.+?&\\s*?sc\\s+?start\""},"group_id":""},{"uuid":"451890043326300205","rule_name":"TTTracer.exe执行dump进程内存","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用TTTracer.exe程序dump进程内存的行为，进程命令行为%(cmd)","handle_desc":"杀死进程，检查是否为业务使用，排查入侵痕迹。","action_desc":"TTTracer.exe是系统自带白名单二进制文件，攻击者可以通过该文件在dump指定进程内存"}],"score":7,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1560","name":"压缩收集的数据"},{"uuid":"T1113","name":"截图"},{"uuid":"T1003.001","name":"LSASS 内存"},{"uuid":"T1003","name":"系统凭证转储"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T10:44:15Z","updated_at":"2023-04-17T08:03:07Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (TTTracer.exe) and process_create.cmd matches \"TTTracer\\.exe\\s*\\-dumpFull\\s*\\-attach\""},"group_id":""},{"uuid":"452146260741193773","rule_name":"Msdt.exe执行恶意msi文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现Msdt.exe执行恶意msi文件，进程命令行为%(cmd)","handle_desc":"删除恶意msi文件，结束相关恶意进程，检查网络连接，排查并溯源","action_desc":"Msdt.exe是微软诊断工具包中的二进制程序，攻击者可以用Msdt.exe执行恶意的msi程序，绕过检测。"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"},{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T05:09:32Z","updated_at":"2023-04-17T08:01:14Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Msdt.exe) and process_create.cmd matches \"\\-path\\s+?[Cc]\\:.+?PCWDiagnostic\\.xml\\s+?\\-af.+?.xml\\s+?\\/skip\\s+?TRUE\""},"group_id":""},{"uuid":"451889600911114285","rule_name":"psr.exe执行屏幕截图","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用psr.exe进行屏幕截图的行为，进程命令行为%(cmd)","handle_desc":"杀死进程，检查是否为业务使用，排查入侵痕迹。","action_desc":"psr.exe是系统自带白名单二进制文件，攻击者可以通过该文件在在不创建GUI的情况下记录用户屏幕。您应该使用“psr.exe /stop”来停止录制并创建输出文件"}],"score":7,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1560","name":"压缩收集的数据"},{"uuid":"T1113","name":"截图"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T10:39:51Z","updated_at":"2023-04-17T08:00:55Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (psr.exe) and process_create.cmd matches \"psr\\.exe\\s*\\/start\\s*\\/output.*\\/sc\\s*1\\s*\\/gui\\s*0\""},"group_id":""},{"uuid":"451888739518513197","rule_name":"pktmon.exe捕获指定端口流量","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用pktmon.exe捕获指定端口流量的行为，进程命令行为%(cmd)","handle_desc":"检查是否为业务使用，排查入侵痕迹。","action_desc":"pktmon.exe是Windows白名单二进制程序，攻击者可以通过该程序捕获敏感流量。"}],"score":7,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1040","name":"网络嗅探"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T10:31:17Z","updated_at":"2023-04-17T08:00:38Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (pktmon.exe) and process_create.cmd matches \"pktmon\\.exe\\s*filter\\s*add\\s*\\-p\""},"group_id":""},{"uuid":"451889066841997357","rule_name":"fltMC.exe卸载SysmonDrv驱动","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用fltMC.exe卸载SysmonDrv驱动的行为，进程命令行为%(cmd)","handle_desc":"检查是否为业务使用，排查入侵痕迹。","action_desc":"fltMC.exe是Windows白名单二进制程序，攻击者可以通过该程序卸载安全代理常用的驱动：SysmonDrv驱动"}],"score":7,"tactics":[{"uuid":"TA0005","name":"逃避防御"},{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1562.001","name":"禁用或修改工具"},{"uuid":"T1562","name":"削弱防御"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T10:34:33Z","updated_at":"2023-04-17T08:00:29Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (fltMC.exe) and process_create.cmd matches \"fltMC\\.exe\\s*unload\\s*SysmonDrv\""},"group_id":""},{"uuid":"451889232500228141","rule_name":"Sc.exe创建恶意任务","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Sc.exe创建恶意任务的行为，进程命令行为%(cmd)","handle_desc":"排查进程，结束恶意进程","action_desc":"sc.exeWindows 用于管理服务，攻击者可以利用其创建恶意服务"}],"score":7,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T10:36:11Z","updated_at":"2023-04-17T08:00:19Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Sc.exe) and process_create.cmd matches \"create\\s+?\\w+\\s+?binpath.+?.txt\\:.+?>.+?start\\s*?\\=\\s*auto\""},"group_id":""},{"uuid":"451864581468323885","rule_name":"Findstr.exe远程下载文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Findstr.exe远程下载文件的行为，进程命令行为%(cmd)","handle_desc":"排查远程下载的文件是否为恶意，若为恶意删除文件，结束相关进程","action_desc":"Findstr.exe远程下载文件，一般情况下Findstr.exe不会被客户端调用"}],"score":3,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"后续需完善","operate_name":"chengzhi.zuo","created_at":"2023-03-15T06:31:18Z","updated_at":"2023-04-17T08:00:14Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Findstr.exe) and process_create.cmd matches \"\\/V\\s+?\\/L\\s+?.+?\\s+?\\\\\\\\[\\d\\.]+.+?\\>\""},"group_id":""},{"uuid":"451865536108691501","rule_name":"利用findstr.exe搜索组策略文件的凭证","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现可疑进程%(pname)搜索组策略文件保存的凭证，进程命令行为%(cmd)","handle_desc":"结束相关进程，阻止其搜索凭证","action_desc":"Findstr.exe远程下载文件，一般情况下Findstr.exe不会被客户端调用"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"后续需完善","operate_name":"chengzhi.zuo","created_at":"2023-03-15T06:40:47Z","updated_at":"2023-04-17T07:59:43Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Findstr.exe) and process_create.cmd matches \"\\/S\\s+?\\/I\\s+?cpassword\\s+?\\\\\\\\sysvol\\\\policies\""},"group_id":""},{"uuid":"451888552435777581","rule_name":"pktmon.exe捕获流量","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用pktmon.exe捕获流量的行为，进程命令行为%(cmd)","handle_desc":"检查是否为业务使用，排查入侵痕迹。","action_desc":"pktmon.exe是Windows白名单二进制程序，攻击者可以通过该程序捕获敏感流量。"}],"score":7,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1040","name":"网络嗅探"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T10:29:26Z","updated_at":"2023-04-17T07:59:29Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (pktmon.exe) and process_create.cmd matches \"pktmon\\.exe\\s*start\\s*\\-\\-etw\""},"group_id":""},{"uuid":"451886955060265005","rule_name":"进程运行manage-bde.wsf脚本","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现manage-bde.wsf脚本运行，进程命令行为%(cmd)","handle_desc":"杀死进程，排查入侵痕迹","action_desc":"在同一目录中运行manage-bde.wsf脚本,就会运行manage-bde.exe二进制程序，攻击者会因此运行有效负载文件。"}],"score":8,"tactics":[{"uuid":"TA0011","name":"命令与控制"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1216","name":"利用签名脚本代理执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T10:13:34Z","updated_at":"2023-04-17T07:59:10Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"\\\\manage-bde.wsf\""},"group_id":""},{"uuid":"451886470467158061","rule_name":"powershell通过脚本调用二进制文件b","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现通过powershell脚本调用二进制文件的行为，进程命令行为%(cmd)","handle_desc":"杀死进程，删除恶意文件。","action_desc":"CL_Invocation.ps1是系统自带的powershell脚本，攻击者通常使用该脚本执行二进制文件以逃避检测。"}],"score":8,"tactics":[{"uuid":"TA0005","name":"逃避防御"},{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1216","name":"利用签名脚本代理执行"},{"uuid":"T1059.001","name":"POWERSHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T10:08:45Z","updated_at":"2023-04-17T07:58:48Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (powershell.exe) and process_create.cmd matches \"\\\\CL_Invocation.ps1\\s*SyncInvoke\""},"group_id":""},{"uuid":"451886189935329325","rule_name":"powershell通过脚本调用二进制文件a","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现通过powershell脚本调用二进制文件的行为，进程命令行为%(cmd)","handle_desc":"杀死进程，删除恶意文件。","action_desc":"CL_Mutexverifiers.ps1是系统自带的powershell脚本，攻击者通常使用该脚本执行二进制文件以逃避检测。"}],"score":8,"tactics":[{"uuid":"TA0005","name":"逃避防御"},{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1216","name":"利用签名脚本代理执行"},{"uuid":"T1059.001","name":"POWERSHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T10:05:58Z","updated_at":"2023-04-17T07:58:33Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (powershell.exe) and process_create.cmd matches \"\\\\CL_Mutexverifiers.ps1\\s*runAfterCancelProcess\""},"group_id":""},{"uuid":"451879161020022829","rule_name":"Rasautou.exe执行dll导出函数","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Rasautou.exe执行dll导出函数，进程命令行为%(cmd)","handle_desc":"杀死进程，删除dll文件，排查入侵痕迹","action_desc":"rasautou.exe是微软远程访问拨号器程序，可以执行dll导出函数"}],"score":6,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1216","name":"利用签名脚本代理执行"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T08:56:09Z","updated_at":"2023-04-17T07:58:11Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Rasautou.exe) and process_create.cmd matches \"\\-d\\s+?.+?\\.dll\\s+?-p\""},"group_id":""},{"uuid":"451876603501215789","rule_name":"VSIISExeLauncher.exe执行二进制文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用VSIISExeLauncher.exe执行二进制文件，进程命令行为%(cmd)","handle_desc":"杀死进程，删除执行的二进制文件，排查入侵痕迹","action_desc":"VSIISExeLauncher.exe是Microsoft Visual Studio中具有的应用程序，攻击者通过使用该程序的-p参数执行恶意二进制文件。"}],"score":7,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1569","name":"系统服务"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T08:30:44Z","updated_at":"2023-04-17T07:58:01Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (VSIISExeLauncher.exe) and process_create.cmd matches \"VSIISExeLauncher\\.exe\\s*\\-p.*\\-a\""},"group_id":""},{"uuid":"451875713704788013","rule_name":"Tracker.exe执行dll注入","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Tracker.exe进行dll注入，进程命令行为%(cmd)","handle_desc":"杀死进程，停止被注入进程，删除文件","action_desc":"Tracker.exe是Windows系统的白名单二进制程序，攻击者可以使用它进行dll注入攻击。"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1055.001","name":"DLL 注入"},{"uuid":"T1569","name":"系统服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T08:21:53Z","updated_at":"2023-04-17T07:57:50Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Tracker.exe) and process_create.cmd matches \"Tracker.exe\\s*\\/d\\s*.*\\.dll\\s*\\/c\\s*.*\\.exe\""},"group_id":""},{"uuid":"451865516596789293","rule_name":"msxsl.exe执行远程xml文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用msxsl.exe执行远程xml文件，进程命令行为%(cmd)","handle_desc":"杀死进程，排查入侵痕迹","action_desc":"msxsl.exe是Windows系统下白名单二进制文件，攻击者可以通过它远程执行xml文件。"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T06:40:36Z","updated_at":"2023-04-17T07:57:21Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (msxsl.exe) and process_create.cmd matches \"msxsl\\.exe\\s*https\\:\\/\\/.*\\.xml\\s*https\\:\\/\\/.*\\.xml\""},"group_id":""},{"uuid":"451864135412482093","rule_name":"Remote.exe远程执行","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Remote.exe执行远程文件，进程命令行为%(cmd)","handle_desc":"杀死进程，删除文件，排查入侵痕迹","action_desc":"Remote.exe可以执行远程二进制文件而不将文件保存到磁盘，攻击者尝尝利用Remote.exe文件进行绕过安全检查。"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T06:26:53Z","updated_at":"2023-04-17T07:57:14Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (Remote.exe) and process_create.cmd matches \"Remote\\.exe\\s*\\/s\\s\\\"\\\\\\\\(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\\\"\""},"group_id":""},{"uuid":"451842718792941613","rule_name":"Dnscmd.exe远程加载恶意dll","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用%(pname)远程加载恶意dll，进程命令行为%(cmd)","handle_desc":"结束相关恶意进程，排查dll文件是否为恶意，若为恶意删除dll文件","action_desc":"Dnscmd.exe是用于管理 DNS 服务器的命令行界面，攻击者可以利用其加载恶意dll文件"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"Dnscmd.exe远程加载恶意dll","operate_name":"chengzhi.zuo","created_at":"2023-03-15T02:54:07Z","updated_at":"2023-04-17T07:56:54Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Dnscmd.exe) and process_create.cmd matches \"\\/config\\s+?\\/serverlevelplugindll\\s+?\\\\{1,2}.+?\\.dll\""},"group_id":""},{"uuid":"451745764905844781","rule_name":"dnx.exe执行C#代码","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用dnx.exe执行C#代码，进程命令行为%(cmd)","handle_desc":"杀死进程，删除恶意文件","action_desc":"dnx.exe是Windows系统二进制程序，攻击者可以通过它执行consoleapp文件夹中的c#代码。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-14T10:50:58Z","updated_at":"2023-04-17T07:56:49Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (dnx.exe) and process_create.cmd matches \"dnx.exe\\s*consoleapp\""},"group_id":""},{"uuid":"451745323195301933","rule_name":"devtoolslauncher.exe执行二进制文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用devtoolslauncher.exe执行二进制文件，进程命令行为%(cmd)","handle_desc":"杀死进程，删除文件","action_desc":"devtoolslauncher.exe是Windows系统的二进制文件，攻击者可以使用其通过给定的参数执行任何二进制文件。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-14T10:46:35Z","updated_at":"2023-04-17T07:56:41Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (devtoolslauncher.exe) and process_create.cmd matches \"devtoolslauncher.exe\\s*LaunchFor(Debug|Deploy).*\\\"\""},"group_id":""},{"uuid":"451744570519060525","rule_name":"msdeploy.exe执行bat文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用msdeploy.exe执行bat文件，进程命令行为%(cmd)","handle_desc":"杀死进程，删除恶意文件","action_desc":"msdeploy.exe是Windows server系统的二进制文件，可以通过该文件执行恶意bat文件，以绕过安全工具查杀。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-14T10:39:06Z","updated_at":"2023-04-17T07:56:32Z","rule_roles":["2","1"],"rule_details":{"content":"process_create.pname in (msdeploy.exe) and process_create.cmd matches \"msdeploy\\.exe\\s*\\-verb\\:sync\\s\\-source\\:RunCommand\\s\\-dest\\:runCommand\\=\\\".*\\\"\""},"group_id":""},{"uuid":"452131479527358509","rule_name":"pubprn.vbs执行远程sct文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用pubprn.vbs执行远程sct文件，进程命令行为%(cmd)","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现pubprn.vbs执行远程sct文件，攻击者可以通过pubprn.vbs文件远程执行sct文件，以实现远程控制和执行恶意代码。"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"},{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059.001","name":"POWERSHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T02:42:42Z","updated_at":"2023-04-17T07:55:51Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"pubprn\\.vbs.*script\\:https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost).*\\.sct\""},"group_id":""},{"uuid":"451885449170911277","rule_name":"利用explore执行恶意exe文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用explore执行恶意exe文件，进程命令行为%(cmd)","handle_desc":"排查相关进程，结束恶意进程，删除恶意文件并溯源","action_desc":"利用explore执行恶意exe文件。explore进程是文件资源管理器进程，攻击者可以通过这个进程间接执行其他恶意exe文件。"}],"score":5,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"chengzhi.zuo","created_at":"2023-03-15T09:58:36Z","updated_at":"2023-04-17T07:55:40Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (explorer.exe) and process_create.cmd matches \"\\/root\\,\\\".+?.exe\""},"group_id":""},{"uuid":"451878210037088301","rule_name":"Odbcconf.exe执行恶意DLL的函数","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现Odbcconf.exe加载恶意dll，执行其DllREgisterServer函数，进程命令行为%(cmd)","handle_desc":"结束相关进程，删除恶意dll","action_desc":"Odbcconf.exe在 Windows 中用于管理 ODBC 连接，攻击者可以利用该程序执行恶意dll。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"宽泛，后续需修改","operate_name":"chengzhi.zuo","created_at":"2023-03-15T08:46:41Z","updated_at":"2023-04-17T07:55:21Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Odbcconf.exe) and process_create.cmd matches \"\\/a\\s+?\\{REGSVR\\s+?.+?\\.dll\""},"group_id":""},{"uuid":"451870931057377325","rule_name":"Installutil.exe执行恶意文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Installutil.exe执行恶意文件，进程命令行为%(cmd)","handle_desc":"结束相关恶意进程，删除恶意文件","action_desc":"Installutil.exe是一个命令行实用工具，允许您通过在指定的程序集中执行安装程序组件来安装和卸载服务器资源，攻击者可以使用该程序执行恶意文件以逃避安全软件检测。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T07:34:23Z","updated_at":"2023-04-17T07:55:15Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Installutil.exe) and process_create.cmd\tmatches \"\\/logfile\\=\\s+?\\/[lL][oO][gG][Tt][oO][cC][Oo][Nn][Ss][Oo][Ll][eE]\\=false\\s+?\\/[Uu]\""},"group_id":""},{"uuid":"451984453871337517","rule_name":"rdrleakdiag.exe进行转储操作","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用rdrleakdiag.exe进行转储操作，进程命令行为%(cmd)","handle_desc":"杀死进程，删除转储文件，排查入侵痕迹。","action_desc":"rdrleakdiag.exe系统白文件，攻击者可以通过该文件和进程PID对LSASS进程进行转储，并创建转储文件。该进程会创建名为minidump_<PID>.dmp和results_<PID>.hlk的文件，通过这种行为，攻击者可以获取系统内的账户密码等敏感信息。"}],"score":8,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1003.001","name":"LSASS 内存"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T02:22:08Z","updated_at":"2023-04-17T07:55:04Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rdrleakdiag.exe) and process_create.cmd matches \"rdrleakdiag\\.exe\\s*\\/p\\s*\\d{3,5}\\s*\\/o\\s*c\\:\\\\evil\\s*\\/fullmemdmp\\s*\\/(?:wait|snap)\""},"group_id":""},{"uuid":"451984773376639021","rule_name":"dump64.exe进行转储操作","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用dump64.exe进行转储操作，进程命令行为%(cmd)","handle_desc":"杀死进程，删除转储文件，排查入侵痕迹。","action_desc":"dump64.exe系统白文件，攻击者可以通过该文件对LSASS进程进行转储，并创建转储文件，通过这种行为，攻击者可以获取系统内的账户密码等敏感信息。"}],"score":7,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1003.001","name":"LSASS 内存"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T02:25:18Z","updated_at":"2023-04-17T07:54:52Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (dump64.exe) and process_create.cmd matches \"dump64\\.exe.*\\.dmp\""},"group_id":""},{"uuid":"451985388613926957","rule_name":"sqldumper.exe进行转储操作","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用sqldumper.exe进行转储操作，进程命令行为%(cmd)","handle_desc":"杀死进程，删除转储文件，排查入侵痕迹。","action_desc":"sqldumper.exe系统白文件，攻击者可以通过该文件对LSASS进程进行转储，并创建转储文件，通过这种行为，攻击者可以获取系统内的账户密码等敏感信息。"}],"score":7,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1003.001","name":"LSASS 内存"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T02:31:25Z","updated_at":"2023-04-17T07:54:34Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (sqldumper.exe) and process_create.cmd matches \"sqldumper\\.exe\\s*\\d{3,5}\\s*0\\s*0x0110\""},"group_id":""},{"uuid":"452026237779443757","rule_name":"powershell.exe执行UtilityFunctions.ps1脚本","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现powershell.exe执行UtilityFunctions.ps1脚本，进程命令行为%(cmd)","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现powershell.exe执行UtilityFunctions.ps1脚本，通过这个脚本可以执行未签名的.NET程序，比如unsigned.dll里面的Main()函数，攻击者可以使用该脚本执行恶意C#命令。"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"},{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059.001","name":"POWERSHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T09:17:13Z","updated_at":"2023-04-17T07:54:25Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (powershell.exe) and process_create.cmd matches \"powershell\\.exe\\s\\-command\\s.*import\\-module.*\\.\\\\UtilityFunctions\\.ps1\""},"group_id":""},{"uuid":"452123293571350573","rule_name":"ftp.exe下载文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用ftp.exe下载文件的行为，进程命令行为%(cmd)","handle_desc":"杀死进程，删除二进制文件","action_desc":"使用ftp.exe生成新进程，下载二进制文件，攻击者可以通过该文件远程下载恶意程序"}],"score":9,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T01:21:23Z","updated_at":"2023-04-17T07:54:06Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (cmd.exe) and process_create.cmd matches \"cmd\\.exe\\s\\/c\\s\\\"\\@echo\\sopen\\s(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost).*\\@echo\\s*GET\\s\\/[\\w]+\\.[\\w]+\\>\\>ftp\\.txt\""},"group_id":""},{"uuid":"452131083887050797","rule_name":"Pester.bat脚本执行文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Pester.bat脚本执行文件，进程命令行为%(cmd)","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现Pester.bat脚本执行文件，Pester.bat是系统二进制白名单文件，白文件是指Windows系统自带的二进制文件，此类型文件常常可以规避安全软件查杀,可以通过该文件执行其他恶意二进制文件。"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"},{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059.001","name":"POWERSHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T02:38:46Z","updated_at":"2023-04-17T07:53:45Z","rule_roles":["1"],"rule_details":{"content":"process_create.pppath matches \"Program\\s*Files\\\\WindowsPowerShell\\\\Modules\\\\Pester.*Pester\\.bat\""},"group_id":""},{"uuid":"452133500661792813","rule_name":"SQLToolsPS.exe代理执行powershell命令","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用SQLToolsPS.exe代理执行powershell命令，进程命令行为%(cmd)","handle_desc":"确认是否为业务操作，杀死进程，排查入侵痕迹","action_desc":"SQLToolsPS.exe是Windows程序白文件，白程序是指Windows系统自带的二进制文件，此类型文件常常可以规避安全软件查杀\n，攻击者可以通过该程序代理执行powershell命令。"}],"score":8,"tactics":[{"uuid":"TA0011","name":"命令与控制"},{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059.001","name":"POWERSHELL"},{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T03:02:46Z","updated_at":"2023-04-17T07:53:34Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (SQLToolsPS.exe) and process_create.cmd matches \"SQLToolsPS\\.exe\\s*\\-noprofile\\s*\\-command\\s*Start\\-Process\""},"group_id":""},{"uuid":"452133695663374381","rule_name":"Sqlps.exe代理执行powershell命令","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用Sqlps.exe代理执行powershell命令，进程命令行为%(cmd)","handle_desc":"确认是否为业务操作，杀死进程，排查入侵痕迹","action_desc":"Sqlps.exe是Windows程序白文件，白文件是指Windows系统自带的二进制文件，此类型文件常常可以规避安全软件查杀，攻击者可以通过该程序代理执行powershell命令。"}],"score":8,"tactics":[{"uuid":"TA0011","name":"命令与控制"},{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059.001","name":"POWERSHELL"},{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T03:04:43Z","updated_at":"2023-04-17T07:53:24Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Sqlps.exe) and process_create.cmd matches \"Sqlps\\.exe\\s*\\-noprofile\\s*\\\"\\s*Start\\-Process\""},"group_id":""},{"uuid":"451985026679046189","rule_name":"ntdsutil.exe进行转储操作","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用ntdsutil.exe进行转储操作，进程命令行为%(cmd)","handle_desc":"杀死进程，删除转储文件，排查入侵痕迹。","action_desc":"ntdsutil.exe系统白文件，攻击者可以通过该文件对LSASS进程进行转储，并创建转储文件，通过这种行为，攻击者可以获取系统内的账户密码等敏感信息。"}],"score":7,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1003.001","name":"LSASS 内存"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T02:27:49Z","updated_at":"2023-04-17T07:53:17Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (ntdsutil.exe) and process_create.cmd matches \"ntdsutil\\.exe\\s*\\\"ac\\s*i\\s*ntds\\\"\\s*\\\"ifm\\\"\\s*\\\"create\\s*full.*q\\s*\\(dump\\s*ntds\\)\""},"group_id":""},{"uuid":"451984636608774189","rule_name":"adplus.exe进行转储操作","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用adplus.exe进行转储操作，进程命令行为%(cmd)","handle_desc":"杀死进程，删除转储文件，排查入侵痕迹。","action_desc":"adplus.exe系统白文件，攻击者可以通过该文件对LSASS进程进行转储，并创建转储文件，通过这种行为，攻击者可以获取系统内的账户密码等敏感信息。"}],"score":8,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1003.001","name":"LSASS 内存"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T02:23:57Z","updated_at":"2023-04-17T07:53:09Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (adplus.exe) and process_create.cmd matches \"adplus\\.exe\\s*\\-hang\\s*\\-pn\\s*lsass\\.exe\\s\\-o\\s*.*\\-quiet\""},"group_id":""},{"uuid":"452132311425613869","rule_name":"squirrel.exe代理执行powershell命令","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用squirrel.exe代理执行powershell命令，进程命令行为%(cmd)","handle_desc":"杀死进程，删除恶意文件","action_desc":"squirrel.exe类似于update.exe，自动寻找参数中的RELEASES文件然后下载更新包并执行，攻击者可以通过此行为下载执行远程恶意文件。"}],"score":7,"tactics":[{"uuid":"TA0005","name":"逃避防御"},{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059.001","name":"POWERSHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T02:50:58Z","updated_at":"2023-04-17T07:52:58Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (squirrel.exe) and process_create.cmd matches \"squirrel\\.exe\\s*\\-\\-(?:updateRoolback|update)\\s?=?(?:https\\:\\/\\/)?(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)\""},"group_id":""},{"uuid":"452134116922490925","rule_name":"esentutl.exe执行恶意文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现使用esentutl.exe执行恶意文件，进程命令行为%(cmd)","handle_desc":"杀死进程，删除恶意文件","action_desc":"esentutl.exe是Windows系统的二进制白程序，白程序是指Windows系统自带的二进制文件，此类型文件常常可以规避安全软件查杀，攻击者可以通过esentutl.exe间接执行本机恶意文件。"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T03:08:54Z","updated_at":"2023-04-17T07:52:47Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (esentutl.exe) and process_create.cmd matches \"esentutl\\.exe\\s*\\/y\\s*\\/vss.*ntds\\.dit\\s*\\/d.*\\.dit\""},"group_id":""},{"uuid":"452133075376144429","rule_name":"esentutl.exe执行远程下载","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用esentutl.exe从远程下载恶意文件的行为，进程命令行为%(cmd)","handle_desc":"杀死进程，删除恶意文件","action_desc":"esentutl.exe是Windows系统的二进制白程序，白程序是指Windows系统自带的二进制文件，此类型文件常常可以规避安全软件查杀，攻击者可以通过它下载远程服务器中的恶意文件"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T02:58:33Z","updated_at":"2023-04-17T07:52:29Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (esentutl.exe) and process_create.cmd matches \"esentutl\\.exe\\s*\\/y\\s*\\\\\\\\(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost).*\\/d.*\\/o\""},"group_id":""},{"uuid":"452133223720288301","rule_name":"update.exe执行二进制程序","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用update.exe执行可疑的二进制程序，进程命令行为%(cmd)","handle_desc":"杀死进程，删除恶意文件","action_desc":"update.exe是Windows系统的二进制白程序，白程序是指Windows系统自带的二进制文件，此类型文件常常可以规避安全软件查杀，攻击者可以通过它创建二进制程序并执行"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T03:00:01Z","updated_at":"2023-04-17T07:46:29Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Update.exe) and process_create.cmd matches \"Update\\.exe\\s*\\-\\-createShortcut\\s?=?.*\\-l\\s*\\=\\s*Startup\""},"group_id":""},{"uuid":"452130507556126765","rule_name":"SyncAppvPublishingServer.vbs远程下载","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用SyncAppvPublishingServer.vbs脚本远程下载，进程命令行为%(cmd)","handle_desc":"杀死进程，删除下载文件","action_desc":"SyncAppvPublishingServer.vbs是Windows系统白文件，白文件是指Windows系统自带的二进制文件，此类型文件常常可以规避安全软件查杀，攻击者可以通过该文件执行远程文件下载命令。"}],"score":8,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T02:33:02Z","updated_at":"2023-04-17T07:45:21Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"SyncAppvPublishingServer\\.vbs.*New\\-Object\\s*Net\\.WebClient\\)\\.DownloadString.*IEX\""},"group_id":""},{"uuid":"452129730888466477","rule_name":"cmdl32.exe下载文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"恶意利用cmdl32.exe下载文件，进程命令行为%(cmd)","handle_desc":"杀死进程，删除下载文件，排查入侵痕迹","action_desc":"cmdl32.exe可以从配置文件中指定的web地址下载文件。下载的文件将位于%TMP%，名称为VPNXXXX.tmp，其中“X”表示随机数或字母，攻击者可以通过该文件下载恶意程序"}],"score":8,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T02:25:20Z","updated_at":"2023-04-17T07:44:54Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (cmdl32.exe) and process_create.cmd matches \"cmdl32.*\\/vpn\\s*\\/lan.*config\""},"group_id":""},{"uuid":"452035598593556525","rule_name":"rundll32调用系统advpack.dll执行恶意dll","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"疑似调用系统advpack.dll执行恶意dll，进程命令行为%(cmd)","handle_desc":"删除恶意dll并结束相关进程，排查网络连接并溯源","action_desc":"rundll32.exe加载advpack.dll来安装软件和驱动程序，攻击者可以通过该行为安装恶意软件和恶意驱动程序。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T10:50:12Z","updated_at":"2023-04-17T07:44:34Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"advpack.dll\\s*?\\,RegisterOCX\\s+?\\w+.dll|advpack.dll\\s*?\\,RegisterOCX\\s+?\\w+.exe|advpack.dll\\,\\s+?RegisterOCX\\s+\\\"cmd\\.exe\\s+\\/c\""},"group_id":""},{"uuid":"452036039834337325","rule_name":"rundll32调用ieadvpack.dll执行恶意二进制文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"疑似调用系统ieadvpack.dll，进程命令行为%(cmd)","handle_desc":"删除恶意文件并结束相关进程，排查网络连接并溯源","action_desc":"适用于 Internet Explorer 的 INF 安装程序。具有许多与advpack.dll相同的功能，攻击者可以通过该文件执行恶意二进制文件。"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"chengzhi.zuo","created_at":"2023-03-16T10:54:35Z","updated_at":"2023-04-17T07:44:29Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"ieadvpack\\.dll\\s*?\\,\\s*?LaunchINFSection\\s+?[cC]\\:\\\\\\w+?\\.inf|ieadvpack\\.dll\\s*?\\,\\s*?RegisterOCX\""},"group_id":""},{"uuid":"452030013055696941","rule_name":"利用AgentExecutor.exe执行恶意powershell脚本","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现疑似利用AgentExecutor.exe执行恶意powershell脚本，进程命令行为%(cmd)","handle_desc":"结束恶意进程并删除恶意文件，检测网络连接，排查并溯源","action_desc":"AgentExecutor.exe是Intune托管设备中包含的Intune 管理扩展，攻击者可以通过该文件执行恶意powershell脚本，实现恶意命令执行。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"chengzhi.zuo","created_at":"2023-03-16T09:54:43Z","updated_at":"2023-04-17T07:44:20Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (AgentExecutor.exe) and process_create.cmd matches \"\\-powershell\\s+?\\\"[cC]\\:\\\\temp\\\\\\w+\\.ps1\\\"\\s+?.+?temp.+?temp.+?temp\""},"group_id":""},{"uuid":"452027415925882925","rule_name":"利用AppVLP.exe执行powershell命令","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现疑似利用AppVLP.exe执行powershell命令，进程命令行为%(cmd)","handle_desc":"结束恶意进程并删除恶意文件，检测网络连接，排查并溯源","action_desc":"AppVLP.exe是包含在 Microsoft Office 2016 中的应用程序虚拟化实用程序，攻击者可以通过使用该程序执行恶意powershell命令。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-16T09:28:55Z","updated_at":"2023-04-17T07:44:08Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname  in (AppVLP.exe) and process_create.pname in (powershell.exe) and process_create.cmd matches \"\\-c\\s+?\\\"\\$\\w+?\\=New-Object\\s+?\\-ComObject\\s+?shell.application.+?.ShellExecute|\\-c\\s+?\\\"\\$\\w+?\\=New-Object\\s+?\\-ComObject\\s+?excel.application.+?RegisterXLL\\(\""},"group_id":""},{"uuid":"452024226392571949","rule_name":"利用AppVLP.exe执行恶意bat脚本","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现疑似利用AppVLP.exe执行恶意bat脚本，进程命令行为%(cmd)","handle_desc":"结束恶意进程并删除恶意文件，检测网络连接，排查并溯源","action_desc":"AppVLP.exe是包含在 Microsoft Office 2016 中的应用程序虚拟化实用程序，攻击者可以通过使用该程序执行恶意bat脚本。"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"chengzhi.zuo","created_at":"2023-03-16T08:57:14Z","updated_at":"2023-04-17T07:43:58Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (AppVLP.exe) and process_create.cmd matches \"\\\\\\\\.+?\\\\\\w+.bat\""},"group_id":""},{"uuid":"451992122183122989","rule_name":"wlrmdr.exe执行恶意二进制文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现wlrmdr.exe执行恶意二进制文件，进程命令行为%(cmd)","handle_desc":"结束恶意进程，删除恶意文件，排查溯源","action_desc":"wlrmdr.exe是Windows系统的二进制白程序，白程序是指Windows系统自带的二进制文件，此类型文件常常可以规避安全软件查杀\n，攻击者可以通过它执行恶意二进制文件"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"chengzhi.zuo","created_at":"2023-03-16T03:38:18Z","updated_at":"2023-04-17T07:43:54Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (wlrmdr.exe) and process_create.cmd matches \"wlrmdr.exe -s 3600 -f 0 -t _ -m _ -a 11 -u calc.exe\""},"group_id":""},{"uuid":"451886425671991341","rule_name":"利用Runscripthelper.exe执行powershell脚本","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"利用Runscripthelper.exe执行恶意powershell脚本文件，进程命令行为%(cmd)","handle_desc":"排查相关进程，结束恶意进程，删除恶意文件并溯源","action_desc":"利用Runscripthelper.exe执行ps脚本。Runscripthelper.exe是一个PowerShell宿主进程，有微软签名，可以从特定目录读取PowerShell代码并加以执行"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断txt文本内容","operate_name":"chengzhi.zuo","created_at":"2023-03-15T10:08:18Z","updated_at":"2023-04-17T07:42:42Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (Runscripthelper.exe) and process_create.cmd matches \"surfacecheck\\s+?\\\\\\\\\\?\\\\.+?.txt\""},"group_id":""},{"uuid":"451865163922931757","rule_name":"procdump通过md参数执行dll","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现procdump通过md参数执行dll，进程命令行为%(cmd)","handle_desc":"杀死进程，删除恶意文件","action_desc":"攻击者通过将恶意代码写在dll的导出函数MiniDumpCallbackRoutine中，然后通过procdump调用md参数即可被执行"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1569","name":"系统服务"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-15T06:37:06Z","updated_at":"2023-04-17T07:42:36Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (procdump.exe,procdump64.exe) and process_create.cmd matches \"procdump(64)?\\.exe\\s*\\-md\""},"group_id":""}],"total":336}

{"data":[{"uuid":"299982922144124767","rule_name":"SharpRDP","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用RDP协议的命令执行工具SharpRDP执行命令，疑似被远程执行命令行","handle_desc":"杀掉对应进程，删除相关的文件和排查入侵痕迹，进一步处理。","action_desc":"SharpRDP是一个开源远程桌面协议（RDP）客户端，攻击者常用SharpRDP工具在靶机上执行系统命令或者传输恶意文件。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:42:01Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (SharpRDP.exe) and process_create.cmd matches \"((computername)|(command)|(username)|(password)|(elevated))\""},"group_id":""},{"uuid":"299982922144124722","rule_name":"利用Dnslog探测漏洞","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现Web应用异常访问dnslog的行为，进程命令行为%(cmd)","handle_desc":"排查恶意web文件进行清除，停止恶意进程并通过web日志排查攻击者的入侵途径，及时修补漏洞。","action_desc":"攻击者通过使用系统自带命令访问自建或公开的dnslog服务可以探测目标环境是否出网或验证是否存在漏洞。"}],"score":9,"tactics":[{"uuid":"TA0001","name":"初始访问"}],"techniques":[{"uuid":"T1190","name":"利用互联网上应用程序的缺陷"}],"platforms":[21,11,12,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:31:01Z","rule_roles":["1"],"rule_details":{"content":"(process_create.acmd pmatch (\"java.*?((tomcat)|(shiro)|(zoomkeeper)|(log4j)|(weaver)|([rR]esin)|(dubbo)|(WebSphere)|(spring)|(jenkins)|(jira)|(atlassian)|(elasticsearch)|(jboss)|(solr)|(nexus)|(jackson)|(fastjson)|(activemq)|[cC][mM][sS]|[wW][eE][bB])\", \"apache\", \"httpd\", \"php\", \"postgres\", \"redis-server\", \"node\", \"python\") or process_create.apname in (node.exe,python.exe,java.exe,httpd.exe,w3wp.exe,php-cgi.exe,Tomcat5.exe,Tomcat6.exe,Tomcat7.exe,Tomcat8.exe,Tomcat9.exe,Tomcat10.exe,JspStudy.exe,tomcat5.exe,tomcat6.exe,tomcat7.exe,tomcat8.exe,tomcat9.exe,tomcat10.exe,jspstudy.exe)) and process_create.pname in (nc,netcat,ncat,telnet,ping,nslookup,dig,traceroute,traceroute6,tracepath,tracepath6,curl,wget,ping.exe,nslookup.exe,tracert.exe) and process_create.cmd matches \"(dnslog\\.[a-zA-Z1-9]{1,10}|ceye\\.io|imgcdnns\\.com|burpcollaborator\\.net)(?!\\.|[a-zA-Z1-9])\""},"group_id":""},{"uuid":"299982922144124643","rule_name":"Web应用异常执行history命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现Web应用异常执行history命令%(cmd)","handle_desc":"排查恶意web文件进行删除，根据web日志排查攻击者的入侵途径，及时修补漏洞。","action_desc":"攻击者通过执行history命令查看bash历史记录，在其中可能找到用户输入的明文密码等敏感信息。"}],"score":9,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1552","name":"不安全的凭证"},{"uuid":"T1552.003","name":"BASH 历史记录"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:27:53Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (apache,apache2,httpd,php-fpm,java,postgres,redis-server) and process_create.pname in (bash,sh,dash,tcsh,csh,ksh,zsh) and process_create.cmd matches \"^(\\/bin\\/|\\/usr\\/bin\\/)?(bash|sh|dash|tcsh|csh|ksh|zsh)\\s+\\-c\\s+history\\s*(-[rc])?\\s*$\""},"group_id":""},{"uuid":"299982922144124727","rule_name":"Web应用执行网络连接命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web应用执行可疑的网络连接命令，进程命令行为%(cmd)","handle_desc":"排查恶意的web文件进行清除，通过web日志或其他告警排查确认攻击者的入侵途径，并及时修补漏洞。","action_desc":"攻击者通过webshell或web命令执行漏洞执行网络连接命令进行反弹shell、出网探测等操作。"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[21,11,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:27:13Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd pmatch (\"java.*?((tomcat)|(shiro)|(zoomkeeper)|(log4j)|(weaver)|([rR]esin)|(dubbo)|(WebSphere)|(spring)|(jenkins)|(jira)|(atlassian)|(elasticsearch)|(jboss)|(solr)|(nexus)|(jackson)|(fastjson)|(activemq)|[cC][mM][sS]|[wW][eE][bB])\", \"apache\", \"httpd\", \"php-fpm\", \"postgres\", \"redis-server\") and process_create.pname in (nc,netcat,ncat,telnet,ping,nslookup,dig,traceroute,traceroute6,tracepath,tracepath6) and process_create.cmd matches \"(nc|netcat|ncat|telnet|ping|nslookup|dig|traceroute|traceroute6|tracepath|tracepath6)(?!.*127\\.0\\.0\\.1|.*172\\.[1-3][0-9]\\.|.*10\\.|.*192\\.168\\.|.*localhost|.*\\.svc).*\""},"group_id":""},{"uuid":"299982922144124723","rule_name":"Web应用执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web应用异常执行系统命令，进程命令行为%(cmd)","handle_desc":"排查恶意的web文件进行清除，通过web日志或其他告警排查确定攻击者的入侵途径，及时修补漏洞。","action_desc":"攻击者通过webshell或web命令执行漏洞经常执行一些常见的命令，例如 passwd、useradd 等"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[21,11,12,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:26:54Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd pmatch (\"java.*?((tomcat)|(shiro)|(zoomkeeper)|(log4j)|(weaver)|([rR]esin)|(dubbo)|(WebSphere)|(spring)|(jenkins)|(jira)|(atlassian)|(elasticsearch)|(jboss)|(solr)|(nexus)|(jackson)|(fastjson)|(activemq)|[cC][mM][sS]|[wW][eE][bB])\", \"apache\", \"httpd\", \"php-fpm\", \"postgres\", \"redis-server\", \"node.exe\") and process_create.pname in (useradd,nmap,chattr,arp,passwd,adduser,masscan,hydra,powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe) and process_create.cmd matches \"^((?!node_modules|tfsagent).)*$\""},"group_id":""},{"uuid":"299982922144124720","rule_name":"Web服务异常写文件","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现Web服务进程使用curl命令进行文件写入，进程命令行为%(cmd)","handle_desc":"删除恶意文件并停止恶意进程，通过系统日志或其他告警排查攻击者的入侵途径，及时修补漏洞。","action_desc":"攻击者通过wget、curl、echo、base64等命令配合重定向操作可以在磁盘中写入恶意文件。"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[21,11,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:26:13Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd pmatch (\"java.*?((tomcat)|(shiro)|(zoomkeeper)|(log4j)|(weaver)|([rR]esin)|(dubbo)|(WebSphere)|(spring)|(jenkins)|(jira)|(atlassian)|(elasticsearch)|(jboss)|(solr)|(nexus)|(jackson)|(fastjson)|(activemq)|[cC][mM][sS]|[wW][eE][bB])\", \"apache\", \"httpd\", \"php-fpm\", \"postgres\", \"redis-server\") and process_create.cmd matches \"(?:\\bcurl\\b(?:(?:(?!\\s+(?:-d|-H)\\s+).)*?)\\s+.http[s]?:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost|(?:[\\w\\-]*\\.)*(?:byted\\.org|bytedance\\.net)\\b|(?:[\\w\\-]*\\.)*google\\.com\\b)[^|&;]*?(-o\\s+|>|>>)\\s*[^&\\s]+(?:\\s*[&;|]|$))|(?:echo.*?\\|.*?base64.*?-d.*?>[^&]+)\""},"group_id":""},{"uuid":"299982922144124638","rule_name":"Web服务异常调用python","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web服务异常执行python命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者执行python --help或python -V命令探测当前系统中安装的python版本后可利用python解码并执行base64加密的恶意代码，以此逃避防御并执行恶意命令，或直接利用python进行反弹shell操作。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"},{"uuid":"T1140","name":"解混淆/解码文件或信息"},{"uuid":"T1202","name":"间接执行命令"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:25:24Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (apache,apache2,httpd,php-fpm,java,postgres,redis-server) and process_create.pname in (python,python2,python3) and (process_create.cmd matches \"^(python\\w{0,1}|python\\w{0,1}\\s+-h|python\\w{0,1}\\s+\\-\\-help|python\\w{0,1}\\s+\\-V)\\s*$\" or process_create.cmd matches \"subprocess\\.(PIPE|Popen|run|call|check_all|check_output|getoutput|getstatusoutput)\" or process_create.cmd matches \"exec.*b64decode\")"},"group_id":""},{"uuid":"299982922144124618","rule_name":"Web应用执行网络连接命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web应用异常执行网络连接命令，命令行为%(cmd)","handle_desc":"排查恶意的web文件进行清除，通过web日志或其他告警排查确认攻击者的入侵途径，并及时修补漏洞。","action_desc":"攻击者通过webshell或web命令执行漏洞执行网络连接命令进行反弹shell、出网探测等操作。"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:24:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (apache,apache2,httpd,php-fpm,java,postgres,redis-server) and process_create.pname in (nc,netcat,ncat,telnet,ping,nslookup,dig,traceroute,traceroute6,tracepath,tracepath6) and process_create.cmd matches \"(nc|netcat|ncat|telnet|ping|nslookup|dig|traceroute|traceroute6|tracepath|tracepath6)(?!.*127\\.0\\.0\\.1|.*172\\.[1-3][0-9]\\.|.*10\\.|.*192\\.168\\.|.*localhost|.*\\.svc).*\""},"group_id":""},{"uuid":"299982922144124614","rule_name":"Web应用执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web应用异常执行系统命令，进程命令行为%(cmd)","handle_desc":"排查恶意的web文件进行清除，通过web日志或其他告警排查确定攻击者的入侵途径，及时修补漏洞。","action_desc":"攻击者通过webshell或web命令执行漏洞经常执行一些常见的命令，例如 passwd、useradd 等"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:24:18Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (apache,apache2,httpd,php-fpm,java,postgres,redis-server) and process_create.pname in (useradd,adduser,pwd,echo,chattr,arp,passwd,base64)"},"group_id":""},{"uuid":"299982922144124755","rule_name":"利用蚁剑webshell管理工具执行命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现疑似利用蚁剑webshell管理工具执行命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"蚁剑是一个webshell管理工具，攻击者可以上传webshell到系统上维持权限，并通过蚁剑工具连接webshell远程控制该系统。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:22:32Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (cmd.exe) and process_create.cmd matches \"cd\\s+\\/d\\s+.*?&.*?&echo\\s+([0-9a-f]{5,13}|\\[S\\])&cd&echo\\s+([0-9a-f]{5,13}|\\[E\\])\""},"group_id":""},{"uuid":"299982922144124711","rule_name":"本地敏感文件上传至外网","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"攻击者通过curl上传命令将服务器敏感文件发送到外网，进程命令行为%(cmd)","handle_desc":"停止恶意进程，删除恶意文件，排查WEB访问日志确定攻击者入侵途径，及时修补漏洞。","action_desc":"攻击者通过WEB服务漏洞获取系统初始访问权限，并通过curl将服务器敏感文件发送到外网"}],"score":9,"tactics":[{"uuid":"TA0001","name":"初始访问"},{"uuid":"TA0002","name":"执行"},{"uuid":"TA0010","name":"窃取"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"},{"uuid":"T1190","name":"利用互联网上应用程序的缺陷"},{"uuid":"T1567","name":"使用 WEB 服务窃取"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:22:24Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (java,apache,apache2,httpd,php-fpm) and process_create.pname in (curl,sh,bash) and process_create.cmd matches \"curl\\s+-X\\s+POST\\s+-F\\s+\\w+=@(?:\\/etc\\/(?:passwd|shadow)|\\/root\\/\\.ssh\\/(?:id_rsa|authorized_keys))\\s+http(?:s)?:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost|(?:[\\w\\-]*\\.)*(?:byted\\.org|bytedance\\.net)|(?:[\\w\\-]*\\.)*google\\.com)\\S+$\""},"group_id":""},{"uuid":"299982922144124721","rule_name":"Web服务异常操作计划任务文件","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现利用Web服务写计划任务操作，进程命令行为%(cmd)","handle_desc":"删除恶意计划任务、文件以及停止相关的恶意进程。","action_desc":"攻击者可以通过漏洞从web进程执行系统命令，添加计划任务实现权限持久化。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"},{"uuid":"T1053","name":"计划任务/作业"},{"uuid":"T1053.003","name":"CRON"}],"platforms":[21,11,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:22:11Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd pmatch (\"java.*?((tomcat)|(shiro)|(zoomkeeper)|(log4j)|(weaver)|([rR]esin)|(dubbo)|(WebSphere)|(spring)|(jenkins)|(jira)|(atlassian)|(elasticsearch)|(jboss)|(solr)|(nexus)|(jackson)|(fastjson)|(activemq)|[cC][mM][sS]|[wW][eE][bB])\", \"apache\", \"httpd\", \"php-fpm\", \"postgres\", \"redis-server\") and process_create.cmd matches \"echo\\s+[^&\\|;]*?>\\s*(?:\\/var\\/spool\\/cron\\/|\\/etc\\/cron\\.(?:hourly|weekly|monthly|daily|d)\\/)\\S+\""},"group_id":""},{"uuid":"299982922144124753","rule_name":"IIS进程执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现通过IIS进程执行系统命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"IIS Web进程执行了系统关键命令比如powershell，systeminfo，攻击者通常使用漏洞让web进程执行这些命令进行信息收集和进一步获取权限。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"},{"uuid":"T1569","name":"系统服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:21:45Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (w3wp.exe) and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,dsquery.exe,schtasks.exe )"},"group_id":""},{"uuid":"299982922144124756","rule_name":"AntSword执行PowerShell命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现疑似AntSword执行PowerShell命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"蚁剑是一个webshell管理工具，攻击者可以上传webshell到系统上维持权限，并通过蚁剑工具连接webshell远程控制该系统。蚁剑工具在用虚拟终端执行命令时有特殊的特征，比如会执行pwd和echo等。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.001","name":"POWERSHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:21:35Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (powershell.exe) and process_create.cmd matches \"cd\\s+.*?;.*?;echo\\s+([0-9a-f]{5,13}|\\[S\\]);\\(pwd\\)\\.path;echo\\s+([0-9a-f]{5,13}|\\[E\\])\""},"group_id":""},{"uuid":"299982922144124805","rule_name":"tomcat执行系统命令_b","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现tomcat执行敏感系统命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"tomcat执行可疑的系统命令，包括powershell,systeminfo,dsquery等。攻击者可能会通过漏洞或者webshell尝试执行这些命令进行信息收集或者进一步渗透。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:07:45Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (Tomcat5.exe,Tomcat6.exe,Tomcat7.exe,Tomcat8.exe,Tomcat9.exe,Tomcat10.exe,JspStudy.exe,tomcat5.exe,tomcat6.exe,tomcat7.exe,tomcat8.exe,tomcat9.exe,tomcat10.exe,jspstudy.exe) and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe)"},"group_id":""},{"uuid":"299982922144124809","rule_name":"tomcat执行网络连接命令_b","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现tomcat执行可疑的网络连接命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件，关闭网络连接","action_desc":"tomcat执行网络连接命令，包括ping,nslookup等。攻击者可能会通过漏洞或者webshell尝试执行这些命令进行信息收集或者进一步渗透。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:07:31Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (Tomcat5.exe,Tomcat6.exe,Tomcat7.exe,Tomcat8.exe,Tomcat9.exe,Tomcat10.exe,JspStudy.exe,tomcat5.exe,tomcat6.exe,tomcat7.exe,tomcat8.exe,tomcat9.exe,tomcat10.exe,jspstudy.exe) and process_create.pname in (ping.exe,nslookup.exe) and process_create.cmd matches \"(([pP][iI][nN][gG])|([nN][sS][lL][oO][oO][kK][uU][pP]))(?!.*127\\.0\\.0\\.1|.*172\\.[1-3][0-9]\\.|.*10\\.|.*192\\.168\\.|.*localhost).*\""},"group_id":""},{"uuid":"299982922144124810","rule_name":"tomcat执行网络连接命令_a","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现tomcat执行可疑的网络连接命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"tomcat执行网络连接命令，包括ping,nslookup等。攻击者可能会通过漏洞或者webshell尝试执行这些命令进行信息收集或者进一步渗透。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:07:15Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (java.exe) and process_create.acmd matches \"([tT][oO][mM][cC][aA][tT]|org\\.apache\\.catalina\\.startup\\.Bootstrap)\" and process_create.pname in (ping.exe,nslookup.exe) and process_create.cmd matches \"(([pP][iI][nN][gG])|([nN][sS][lL][oO][oO][kK][uU][pP]))(?!.*127\\.0\\.0\\.1|.*172\\.[1-3][0-9]\\.|.*10\\.|.*192\\.168\\.|.*localhost).*\""},"group_id":""},{"uuid":"299982922144124819","rule_name":"php执行网络连接命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"php执行可疑的网络连接命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"php执行网络连接命令，包括ping,nslookup等。攻击者可能会通过漏洞或者webshell尝试执行这些命令进行信息收集或者进一步渗透。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:07:01Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (php-cgi.exe) and process_create.pname in (ping.exe,nslookup.exe) and process_create.cmd matches \"(([pP][iI][nN][gG])|([nN][sS][lL][oO][oO][kK][uU][pP]))(?!.*127\\.0\\.0\\.1|.*172\\.[1-3][0-9]\\.|.*10\\.|.*192\\.168\\.|.*localhost).*\""},"group_id":""},{"uuid":"299982922144124836","rule_name":"weblogic执行网络连接命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"weblogic执行可疑的网络连接命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"weblogic执行网络连接命令，包括ping,nslookup等。攻击者可能会通过漏洞或者webshell尝试执行这些命令进行信息收集或者进一步渗透。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:06:48Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (java.exe) and process_create.acmd matches \"[wW][eE][bB][lL][oO][gG][iI][cC]\" and process_create.pname in (ping.exe,nslookup.exe) and process_create.cmd matches \"(([pP][iI][nN][gG])|([nN][sS][lL][oO][oO][kK][uU][pP]))(?!.*127\\.0\\.0\\.1|.*172\\.[1-3][0-9]\\.|.*10\\.|.*192\\.168\\.|.*localhost).*\""},"group_id":""},{"uuid":"299982922144124835","rule_name":"httpd执行网络连接命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"httpd执行可疑的网络连接命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"httpd执行网络连接命令，包括ping,nslookup等。攻击者可能会通过漏洞或者webshell尝试执行这些命令进行信息收集或者进一步渗透。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:06:40Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (httpd.exe) and process_create.pname in (ping.exe,nslookup.exe) and process_create.cmd matches \"(([pP][iI][nN][gG])|([nN][sS][lL][oO][oO][kK][uU][pP]))(?!.*127\\.0\\.0\\.1|.*172\\.[1-3][0-9]\\.|.*10\\.|.*192\\.168\\.|.*localhost).*\""},"group_id":""},{"uuid":"299982922144124833","rule_name":"IIS执行网络连接命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"IIS执行可疑的网络连接命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"IIS执行网络连接命令，包括ping,nslookup等。攻击者可能会通过漏洞或者webshell尝试执行这些命令进行信息收集或者进一步渗透。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:06:18Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (w3wp.exe) and process_create.pname in (ping.exe,nslookup.exe) and process_create.cmd matches \"(([pP][iI][nN][gG])|([nN][sS][lL][oO][oO][kK][uU][pP]))(?!.*127\\.0\\.0\\.1|.*172\\.[1-3][0-9]\\.|.*10\\.|.*192\\.168\\.|.*localhost).*\""},"group_id":""},{"uuid":"299982922144124830","rule_name":"weblogic执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"weblogic恶意执行敏感系统命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者通过web命令执行漏洞执行一些常见的命令，例如 passwd、useradd等，进行信息收集或者下一步渗透"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"},{"uuid":"T1569","name":"系统服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:05:06Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (java.exe) and process_create.acmd matches \"[wW][eE][bB][lL][oO][gG][iI][cC]\" and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe)"},"group_id":""},{"uuid":"299982922144124829","rule_name":"httpd进程执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"httpd进程执行敏感系统命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者可能会通过httpd漏洞或者webshell尝试执行systeminfo，schtasks等系统命令进行信息收集或者进一步渗透。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:04:49Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (httpd.exe) and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe)"},"group_id":""},{"uuid":"299982922144124820","rule_name":"php进程执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"php进程执行敏感系统命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，排查是否恶意，关闭恶意进程并删除恶意文件。","action_desc":"攻击者可能会通过php网站漏洞或者webshell尝试执行systeminfo，schtasks等系统命令进行信息收集或者进一步渗透。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T07:04:33Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (php-cgi.exe) and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe)"},"group_id":""},{"uuid":"299982922144124724","rule_name":"Web应用操作敏感文件","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web应用查看系统敏感文件的可疑命令%(cmd)","handle_desc":"结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"通过导出/etc/passwd和/etc/shadow的文件内容，攻击者可以进行离线密码破解，攻击者也可以在bash历史记录文件或数据库历史记录文件中发现用户输入的明文密码。"}],"score":8,"tactics":[{"uuid":"TA0006","name":"凭证访问"},{"uuid":"TA0010","name":"窃取"}],"techniques":[{"uuid":"T1003.008","name":"/etc/passwd&amp;shadow"},{"uuid":"T1552","name":"不安全的凭证"},{"uuid":"T1552.001","name":"文件中的凭证"},{"uuid":"T1552.003","name":"BASH 历史记录"},{"uuid":"T1552.004","name":"私钥"}],"platforms":[21,11,31],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T06:33:30Z","rule_roles":["1"],"rule_details":{"content":"(process_create.acmd pmatch (\"java.*?((tomcat)|(shiro)|(zoomkeeper)|(log4j)|(weaver)|([rR]esin)|(dubbo)|(WebSphere)|(spring)|(jenkins)|(jira)|(atlassian)|(elasticsearch)|(jboss)|(solr)|(nexus)|(jackson)|(fastjson)|(activemq)|[cC][mM][sS]|[wW][eE][bB])\", \"apache\", \"httpd\", \"php-fpm\", \"postgres\", \"redis-server\", \"goahead\") or process_create.apname in (node)) and process_create.cmd matches \"((cat|head|tail|tac|less|more|vi|vim|nano|getent|vipw|vigr)\\s+|echo[^>]*?[>]{1,2}\\s*)((\\/etc\\/passwd)|(\\/etc\\/shadow)|(\\/etc\\/hostname)|(.*bash_history)|(\\/etc\\/group)|(\\/etc\\/sudoers)|(.*mysql_history)|(~\\/id_rsa)|(~\\/authorized_keys))\""},"group_id":""},{"uuid":"299982922144124751","rule_name":"Java Web 执行系统命令_a","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现疑似Java Web执行系统命令，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"Java Web进程执行了系统关键命令比如powershell，systeminfo，攻击者通常使用漏洞让web进程执行这些命令进行信息收集和进一步获取权限。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T03:45:36Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd matches \"java\\.exe.*?([tT][oO][mM][cC][aA][tT]|org\\.apache\\.catalina\\.startup\\.Bootstrap|[sS][eE][eE][yY][oO][nN])\" and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe ) and process_create.cmd matches \"^((?!\\s+Get-WinEvent\\s+.*?-HideTableHeaders).)*$\""},"group_id":""},{"uuid":"299982922144124632","rule_name":"Web应用操作敏感文件","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web应用查看系统敏感文件的可疑命令%(cmd)","handle_desc":"结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"通过导出/etc/passwd和/etc/shadow的文件内容，攻击者可以进行离线密码破解，攻击者也可以在bash历史记录文件或数据库历史记录文件中发现用户输入的明文密码。"}],"score":8,"tactics":[{"uuid":"TA0006","name":"凭证访问"},{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1003","name":"系统凭证转储"},{"uuid":"T1003.008","name":"/etc/passwd&amp;shadow"},{"uuid":"T1087","name":"账户发现"},{"uuid":"T1087.001","name":"本地账户"},{"uuid":"T1552","name":"不安全的凭证"},{"uuid":"T1552.001","name":"文件中的凭证"},{"uuid":"T1552.003","name":"BASH 历史记录"},{"uuid":"T1552.004","name":"私钥"}],"platforms":[11,12,21,31,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-17T03:42:58Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (apache,apache2,httpd,php-fpm) and process_create.cmd matches \"(cat|head|tail|tac|less|more|vi|vim|nano|getent|vipw|vigr)\\s+|echo[^>]*?[>]{1,2}\\s*((\\/etc\\/passwd)|(\\/etc\\/shadow)|(\\/etc\\/hostname)|(.*bash_history)|(\\/etc\\/group)|(\\/etc\\/sudoers)|(.*mysql_history)|(~\\/id_rsa)|(~\\/authorized_keys))\""},"group_id":""},{"uuid":"299982922144124784","rule_name":"导出系统注册表抓密码Hash","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似恶意行为，windows通过导出系统注册表抓密码Hash","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"windows系统注册表路径hklm\\sam和hklm\\system中保存着系统的密码hash，攻击者通过reg命令导出系统注册表中的密码Hash，用来爆破明文密码。"}],"score":10,"tactics":[{"uuid":"TA0005","name":"逃避防御"},{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1574.011","name":"服务注册表权限缺陷"},{"uuid":"T1112","name":"修改注册表"},{"uuid":"T1201","name":"密码策略发现"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-12T07:59:27Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (reg.exe) and process_create.cmd matches \"[rR][eE][gG]\\s+[sS][aA][vV][eE]\\s+[hH][kK][lL][mM]\\\\([sS][aA][mM]|[sS][yY][sS][tT][eE][mM]).*\""},"group_id":""},{"uuid":"299982922144124804","rule_name":"添加注册表自启动项","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"通过注册表项实现后门持久化","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者在进行权限维持时，会通过注册表项实现后门持久化，修改指定的注册表项值为恶意程序，windows开机或登录时就会自动执行恶意程序。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037.005","name":"自启动项"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-12T07:57:09Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname = reg.exe and process_create.cmd matches \"add\\s+.*?CurrentVersion[\\\\]+(\\b(Run|ShellServiceObjectDelayLoad|Image File Execution Options)\\b|\\bWinlogon\\b.*?\\b(Shell|Userinit|Notify)\\b)\""},"group_id":""},{"uuid":"299982922144124780","rule_name":"使用gost代理工具","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用gost代理工具","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过gost工具建立端口转发通道或代理隧道，访问或窃取内网资源。gost工具可以帮助用户在NAT网络环境下暴露本地服务到公网中，同时支持TCP、UDP等多种协议和流量加密等功能。"}],"score":10,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1090.001","name":"内网代理"},{"uuid":"T1090","name":"代理"},{"uuid":"T1572","name":"协议隧道"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:13:40Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"gost(?:-(?:linux|windows).*?(?:\\.exe)?)?\\s+-L=(?:(?:(?:tcp|rtcp|rudp|http2|socks5):\\/\\/)|\\w+:\\S+@\\w+)?:\\d+\""},"group_id":""},{"uuid":"299982922144124779","rule_name":"使用goproxy代理工具","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用goproxy代理工具，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过goproxy工具建立端口转发通道或代理隧道，访问或窃取内网资源。goproxy是一个go语言开发的内网代理工具，可以帮助用户在NAT网络环境下暴露本地服务到公网中，同时支持TCP、UDP等多种协议和流量加密等功能。"}],"score":10,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1572","name":"协议隧道"},{"uuid":"T1090.001","name":"内网代理"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:13:32Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"proxy(?:\\.exe)?\\s+(?:(?:socks|http|tcp)\\s+-t\\s+(?:tcp|tls|ssh)\\s+-p\\s+['\\\"]?(?:(?:(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(?:\\.(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3}))?:\\d+['\\\"]|(?:tcp|udp|client)\\s+-p\\s+['\\\"]?(?:(?:(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(?:\\.(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3}))?:\\d+['\\\"]?(?:\\s+-t\\s+(?:tcp|tls|udp)\\s+-p\\s+.*?:\\d+|(?:\\s+-[CK]\\s+\\w+\\.\\w+){2}))\""},"group_id":""},{"uuid":"299982922144124758","rule_name":"Pen_Fpipe","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用fpipe内网穿透工具，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过fpipe工具建立端口转发通道或代理隧道，访问或窃取内网资源。fpipe是一款专门用来端口重定向的小工具，可以将访问某个端口的流量转发给另一个主机的某个端口。"}],"score":9,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1572","name":"协议隧道"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:13:26Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (fpipe.exe) and process_create.cmd matches \"-[lisr]\\s+\\d+\""},"group_id":""},{"uuid":"299982922144124693","rule_name":"Pen_Iox","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用iox内网代理工具，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过iox工具建立端口转发通道或代理隧道，访问或窃取内网资源。iox是一个高性能的反向代理工具，可以帮助用户在NAT网络环境下暴露本地服务到公网中，同时支持TCP、UDP等多种协议和流量加密等功能。"}],"score":9,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1572","name":"协议隧道"},{"uuid":"T1090","name":"代理"},{"uuid":"T1090.001","name":"内网代理"}],"platforms":[21,12,11,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:13:18Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (iox,iox.exe) and process_create.cmd matches \"(fwd|proxy)\""},"group_id":""},{"uuid":"299982922144124691","rule_name":"Pen_Frp_Linux","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用frp代理工具，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过frp工具建立端口转发通道或代理隧道，访问或窃取内网资源。frp是一个高性能的反向代理工具，可以帮助用户在NAT网络环境下暴露本地服务到公网中，同时支持TCP、UDP等多种协议和流量加密等功能。"}],"score":10,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1219","name":"远程访问软件"},{"uuid":"T1090","name":"代理"},{"uuid":"T1090.001","name":"内网代理"},{"uuid":"T1572","name":"协议隧道"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:13:09Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (frpc,frps) and process_create.cmd matches \"-c\\s+[\\.\\/\\w]+\\.ini\""},"group_id":""},{"uuid":"299982922144124695","rule_name":"Pen_Ngrok","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用ngrok进行内网穿透，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者使用ngrok工具建立端口转发通道或代理隧道，访问或窃取内网资源。ngrok是一个高性能的反向代理工具，可以帮助用户在NAT网络环境下暴露本地服务到公网中，同时支持TCP、UDP等多种协议和流量加密等功能。"}],"score":9,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1219","name":"远程访问软件"}],"platforms":[21,11,12,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:12:57Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ngrok,ngrok.exe) and process_create.cmd matches \"-(domain|config)\""},"group_id":""},{"uuid":"299982922144124690","rule_name":"Pen_Ew","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用ew代理工具，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过ew工具建立端口转发通道或代理隧道，访问或窃取内网资源。ew全称EarthWorm，是一个高性能的反向代理工具，可以帮助用户在NAT网络环境下暴露本地服务到公网中，同时支持TCP、UDP等多种协议和流量加密等功能。"}],"score":10,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1572","name":"协议隧道"},{"uuid":"T1090","name":"代理"},{"uuid":"T1090.001","name":"内网代理"},{"uuid":"T1090.003","name":"多级代理"}],"platforms":[21,11,12,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:12:50Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ew,ew_for_linux64,ew_for_linux32,ew.exe,ew_for_Win.exe) and process_create.cmd matches \"-s\\s+(ssocksd|rcsocks|rssocks|lcx_slave|lcx_listen|lcx_tran)\""},"group_id":""},{"uuid":"299982922144124752","rule_name":"Pen_Frp_win","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用frp代理工具，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过frp工具建立端口转发通道或代理隧道，访问或窃取内网资源。frp是一个高性能的反向代理工具，可以帮助用户在NAT网络环境下暴露本地服务到公网中，同时支持TCP、UDP等多种协议和流量加密等功能。"}],"score":10,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1219","name":"远程访问软件"},{"uuid":"T1090","name":"代理"},{"uuid":"T1090.001","name":"内网代理"},{"uuid":"T1572","name":"协议隧道"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:12:43Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (frpc.exe,frps.exe) and process_create.cmd matches \"-c\\s+\\w+\\.ini\""},"group_id":""},{"uuid":"299982922144124689","rule_name":"Pen_Dnscat","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用dnscat隧道工具，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过dnscat工具建立端口转发通道，访问或窃取内网资源。Dnscat是一种基于DNS协议的后渗透工具，使用dns协议连接控制端，通常用来逃避检测。"}],"score":10,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1572","name":"协议隧道"},{"uuid":"T1071","name":"应用层协议"},{"uuid":"T1071.004","name":"DNS"}],"platforms":[21,11,12,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:11:57Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (dnscat,dnscat.exe) and process_create.cmd matches \"--dns|–ping\""},"group_id":""},{"uuid":"299982922144124696","rule_name":"Pen_Portmap","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用portmap端口转发工具，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过portmap工具建立端口转发通道，访问或窃取内网资源。portmap是一个端口映射工具，可以将内网其他主机的端口映射到多网卡主机的某个端口。"}],"score":9,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1572","name":"协议隧道"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:11:43Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (portmap) and process_create.cmd matches \"-m\\s+[123]\\s+-h[12]\""},"group_id":""},{"uuid":"299982922144124694","rule_name":"Pen_lcx","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用lcx端口转发工具，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过lcx工具建立端口转发通道，访问或窃取内网资源。lcx是一个比较早期的端口转发和代理工具，可以将NAT模式下内网的主机暴露到公网，也可以用来将内网端口映射到多网卡主机上。"}],"score":9,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1572","name":"协议隧道"}],"platforms":[21,11,12,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:10:20Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (lcx,nb,lcx.exe,nb.exe) and process_create.cmd matches \"-(listen|slave|tran)\\s+\\d{1,5}\""},"group_id":""},{"uuid":"299982922144124697","rule_name":"Pen_Tgcd","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用tgcd端口转发工具，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过tgcd工具建立端口转发通道，和恶意控制端建立连接。tgcd是一个内网穿透工具，可以帮助用户在NAT网络环境下快速、安全地暴露本地服务到公网中，同时支持TCP、UDP等多种协议和流量加密等功能。"}],"score":9,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1572","name":"协议隧道"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T09:08:45Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (tgcd) and process_create.cmd matches \"-(domain|config)\""},"group_id":""},{"uuid":"299982922144124692","rule_name":"Pen_Iodine","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用iodine工具建立dns隧道，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过Iodine工具建立端口转发通道访问或窃取内网资源。Iodine是一个反向代理工具，可以帮助用户在NAT网络环境下暴露本地服务到公网中，同时支持TCP、UDP等多种协议和流量加密等功能。"}],"score":9,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1572","name":"协议隧道"},{"uuid":"T1071","name":"应用层协议"},{"uuid":"T1071.004","name":"DNS"}],"platforms":[21,11,12,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T08:56:07Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (iodined,iodine.iodine.exe,iodined.exe) and process_create.cmd matches \"-f\""},"group_id":""},{"uuid":"299982922144124777","rule_name":"使用EHole工具进行资产指纹识别","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似使用EHole工具对网络资产进行扫描识别","handle_desc":"杀死进程，排查入侵痕迹","action_desc":"EHole是一个信息收集工具，能够快速从C段、大量杂乱的资产中精准定位到易被攻击的系统，以及相关的漏洞，攻击者可以使用这些漏洞快速获取权限。"}],"score":9,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1119","name":"自动收集"}],"platforms":[12,11,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-04-11T05:42:35Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"(?:EHole)(?:\\.exe)?\\s+(?:(?:-f\\s+(?:(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(?:\\.(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})\\/\\d+)|(?:-l\\s+\\w+\\.\\w+\\s+-json\\s+\\w+\\.json))\""},"group_id":""},{"uuid":"299982922144124823","rule_name":"SyncAppvPublishingServer执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"SyncAppvPublishingServer执行远程下载命令,疑似恶意","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"SyncAppvPublishingServer执行远程下载命令。SyncAppvPublishingServer可以间接执行powershell命令，常用来绕过对powershell的检测。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"},{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"shuo.zhang","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-23T09:48:59Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (syncappvpublishingserver.exe) and process_create.cmd matches \"[sS][yY][nN][cC][aA][pP][pP][vV][pP][uU][bB][lL][iI][sS][hH][iI][nN][gG][sS][eE][rR][vV][eE][rR].*(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"452146708256653357","rule_name":"rundll32调用syssetup.dll执行恶意inf文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现rundll32调用syssetup.dll执行恶意inf文件","handle_desc":"删除恶意文件，结束有关恶意进程，排查并溯源","action_desc":"syssetup.dll是windows的一个动态链接库，攻击者使用syssetup.dll里的导出函数可以执行恶意inf文件。"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"},{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"chengzhi.zuo","created_at":"2023-03-17T05:13:59Z","updated_at":"2023-03-23T08:42:32Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"syssetup\\.dll\\s*?\\,\\s*?SetupInfObjectInstallAction\\s+?DefaultInstall\\s+?\\w+?\\s+?[Cc]\\:.+?\\.inf\""},"group_id":""},{"uuid":"452026980389355565","rule_name":"发现疑似PrintBrm.exe执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现疑似PrintBrm.exe执行远程下载命令","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"PrintBrm.exe执行远程下载命令。PrintBrm.exe是打印备份和还原管理器的一部分，可以控制其他主机的打印队列，攻击者可以用这个命令从远程服务器上下载文件。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-16T09:24:36Z","updated_at":"2023-03-23T08:14:39Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (PrintBrm.exe) and process_create.cmd matches \"[Pp][Rr][Ii][Nn][Tt][Bb][Rr][Mm]\\s*\\-b\\s*\\-d\\s*\\\\\\\\(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"299982922144124625","rule_name":"nc反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现nc反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-21T02:18:26Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (nc,netcat,ncat,busybox) and process_create.cmd matches \"(?:-e\\s+.*?\\b(?:ba|z|k|tc|c|da)sh\\s+.*?(?:(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(?:\\.(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3}))|(?:(?:(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(?:\\.(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})\\s+.*?-e\\s+.*?\\b(?:ba|z|k|tc|c|da)sh\\b)\""},"group_id":""},{"uuid":"299982922144124834","rule_name":"evil_pip_pkgs","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现命令疑似安装带有恶意代码的pip包","handle_desc":"杀死进程，对命令来源进行排查，进行攻击溯源。","action_desc":"疑似安装带有恶意代码的pip包，攻击者会把恶意代码包装到python仓库中，在pip安装Python库的时候执行。"}],"score":8,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,11,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T07:32:47Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"pip\\d?(?:.exe)?\\s+install\\s+.*?\\b(?:venom22|Asqwed|emilrocks|kckdpjdkleinjncanh|tlnvxkmvepwftirvjc|zerbaxwdzxpztvucdf3|aqswdefrgt|hellonati|qpxtqpkdlzcskofmpe|zerbaxwdzxpztvucdf|danarules|ixkydxhatdkusgwovo|rxlujjgxogcctrxaoe|zerbaxwdzxpztvucdf2)\\b\""},"group_id":""},{"uuid":"299982922144124827","rule_name":"bitsadmin执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"bitsadmin执行远程下载命令,疑似恶意","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"bitsadmin执行的参数包含http，攻击者常用这种方法下载远程服务器上的恶意文件。bitsadmin是一个命令行工具，用于创建、下载或上传文件的。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T07:30:04Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (bitsadmin.exe) and process_create.cmd matches \"[bB][iI][tT][sS][aA][dD][mM][iI][nN].*(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/)|(\\\\\\\\))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"299982922144124826","rule_name":"mshta执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"mshta执行远程下载命令,疑似恶意","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"mshta执行的参数包含http字符串，攻击者常用这种方法下载远程服务器上的恶意文件。mshta是windows用来执行HTA文件程序，可以执行远程的hta文件或者通过恶意hta文件下载其他恶意程序。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"},{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T07:28:40Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (mshta.exe) and process_create.cmd matches \"[mM][sS][hH][tT][aA].*(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/)|(\\\\\\\\))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""}],"total":336}

{"data":[{"uuid":"299982922144124825","rule_name":"msiexec执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"msiexec执行远程下载命令，疑似恶意","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"msiexec执行的参数包含http字符串，攻击者常用这种方法下载远程服务器上的恶意文件。msiexec用于安装windows的msi安装包，允许通过url安装，隐藏常被用来下载恶意文件。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T07:27:24Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (msiexec.exe) and process_create.cmd matches \"[mM][sS][iI][eE][xX][eE][cC].*(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"299982922144124824","rule_name":"certutil执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"certutil执行远程下载命令,疑似恶意","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"certutil执行的参数包含http，攻击者常用这种方法下载远程服务器上的恶意文件。Certutil.exe是作为证书服务的一部分安装的命令行程序，用来操作证书。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"},{"uuid":"T1569","name":"系统服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T07:26:26Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (certutil.exe) and process_create.cmd matches \"[cc][eE][rR][tT][uU][tT][iI][lL].*(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"299982922144124822","rule_name":"IEExec执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"IEExec执行远程下载命令,疑似恶意","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"IEExec执行的参数包含http字符串，攻击者常用这种方法下载远程服务器上的恶意文件。IEExec是.NET Framework附带程序,存在于多个系统白名单内，常用被攻击者用来绕过检测。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"},{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T07:14:49Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ieexec.exe) and process_create.cmd matches \"[iI][eE][eE][xX][eE][cC].*(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"299982922144124821","rule_name":"msxsl执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"msxsl执行远程下载命令,疑似恶意","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"msxsl执行的参数包含http，攻击者常用这种方法下载远程服务器上的恶意文件。msxsl是微软的xml语言解析器，用来解释xml语言的，xml中包含远程配置就会下载远程的代码。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"},{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T06:49:27Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (msxsl.exe) and process_create.cmd matches \"[mM][sS][xX][sS][lL].*(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"452134591247941677","rule_name":"利用系统命令获取进程信息_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)获取系统进程信息的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后，可通过系统自带命令tasklist等获取系统中运行的进程列表。"}],"score":1,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1057","name":"进程发现"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T03:13:37Z","updated_at":"2023-03-20T06:40:55Z","rule_roles":["1"],"rule_details":{"content":"((process_create.pname in (wmic.exe) and process_create.cmd contains \"process\" and not process_create.cmd matches \"where.*?processid\") or process_create.pname in (tasklist.exe,netstat.exe) or process_create.cmd matches \"schtasks\\.exe.*?\\/query\") and process_create.ppname in (cmd.exe,powershell.exe) and not process_create.pppath contains \"SysWOW64\""},"group_id":""},{"uuid":"299982922144124828","rule_name":"sqlserver执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"sqlserver执行系统命令,疑似恶意","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者通过web命令执行漏洞执行一些常见的命令，例如 passwd、useradd等，进行信息收集或者下一步渗透"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T06:38:15Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (sqlserver.exe,sqlservr.exe,MSSQL.exe,mssql.exe) and process_create.pname in (powershell.exe,net.exe,systeminfo.exe,query.exe,arp.exe,route.exe,dsquery.exe,schtasks.exe)"},"group_id":""},{"uuid":"299982922144124818","rule_name":"QuarksPwDump获取用户凭据","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"使用QuarksPwDump获取用户凭据，疑似恶意行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"使用QuarksPwDump获取用户凭据。QuarksPwDump是一个用户密码提取开源工具，可以抓取windows平台下多种类型的用户凭据，包括：本地帐户、域帐户、缓存的域帐户和Bitlocker。"}],"score":9,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1005","name":"本地系统数据"},{"uuid":"T1119","name":"自动收集"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T06:31:25Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (quarkspwdump.exe)"},"group_id":""},{"uuid":"299982922144124816","rule_name":"NTDSDumpEx获取用户哈希","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"使用NTDSDumpEx获取用户哈希，疑似恶意行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"使用NTDSDumpEx获取用户哈希。NTDSDumpEx是常用的从NTDS中获取系统用户哈希的工具。"}],"score":9,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1005","name":"本地系统数据"},{"uuid":"T1119","name":"自动收集"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T06:27:30Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ntdsdump.exe,ntdsdumpex.exe)"},"group_id":""},{"uuid":"299982922144124814","rule_name":"cscript执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似cscript执行恶意远程下载命令","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"cscript执行的参数中包含http，攻击者常用这种方法下载远程服务器上的恶意文件。cscript是脚本解释器程序，可以用来执行vbs或者js脚本。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T06:25:48Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (cscript.exe) and process_create.cmd matches \"[cC][sS][cC][rR][iI][pP][tT].*(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/)|(\\\\\\\\))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost|www\\.microsoft\\.com)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"299982922144124813","rule_name":"wmic远程执行命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"wmic远程执行命令，疑似恶意行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"wmic远程执行命令，wmic是wmi的扩展，提供了从命令行接口和批命令脚本执行系统管理的支持，可以调用各种脚本和命令行。攻击者常用wmic对远程主机进行控制。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0008","name":"横向移动"}],"techniques":[{"uuid":"T1047","name":"WMI"},{"uuid":"T1569","name":"系统服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T06:20:10Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (wmic.exe) and process_create.cmd matches \"\\/[nN][oO][dD][eE].*\\/[uU][sS][eE][rR].*\\/[pP][aA][sS][sS][wW][oO][rR][dD].*[pP][rR][oO][cC][eE][sS][ss].*\""},"group_id":""},{"uuid":"299982922144124812","rule_name":"Powershell清理Windows事件日志","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"使用Powershell清理Windows事件日志，疑似恶意行为","handle_desc":"排查攻击来源，确认是否恶意行为","action_desc":"通过Powershell命令清理Windows事件日志，消除攻击者痕迹。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1059.001","name":"POWERSHELL"},{"uuid":"T1070","name":"主机数据删除"},{"uuid":"T1070.001","name":"清除 WINDOWS 事件日志"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T06:16:36Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (powershell.exe) and process_create.cmd matches \"\\-[cC][oO][mM][mM][aA][nN][dD].*[cC][lL][eE][aA][rR]\\-[eE][vV][eE][nN][tT][lL][oO][gG].*\""},"group_id":""},{"uuid":"299982922144124811","rule_name":"psexesvc执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用psexesvc执行系统命令的行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"PsExec远程管理主机时，会在目标主机上执行 PSEXESVC.exe 进程，PsExec是windows常用的远程控制工具，通过账户和密码就可以打开一个目标主机的交互式cmd命令行。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T06:12:57Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (psexesvc.exe) and process_create.pname in (\"powershell.exe\",\"cmd.exe\",\"whoami\",\"ipconfig\",\"netstat\",\"net.exe\",\"systeminfo.exe\",\"query.exe\",\"arp.exe\",\"route.exe\",\"dsquery.exe\",\"schtasks.exe\")"},"group_id":""},{"uuid":"299982922144124806","rule_name":"添加防火墙RDP策略","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过netsh添加防火墙RDP策略的可疑命令行%(cmd)","handle_desc":"杀死恶意进程，排查攻击者如何获得系统权限，进行溯源。","action_desc":"攻击者通过netsh.exe添加防火RDP墙策略，设置策略为允许后，才可以从公网上连接主机的RDP端口，进一步控制主机。"}],"score":8,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1543.003","name":"WINDOWS 服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T05:18:56Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (netsh.exe) and process_create.cmd matches \"netsh(\\.exe)?\\s+firewall\\s+set\\s+service\\s+type.*?remotedesktop\\s+mode.*?enable\""},"group_id":""},{"uuid":"299982922144124803","rule_name":"无参数的rundll32","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"rundll32进程无参数，疑似被注入后门","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"rundll32进程无参数，疑似被注入后门。rundll32正常执行的时候必须有参数，当攻击者利用rundll32完成进程注入时，才可能出现无参情况。比如CS的进程注入就会产生无参数的rundll32进程。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T04:56:06Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname = rundll32.exe and process_create.cmd matches \"rundll32.exe$\""},"group_id":""},{"uuid":"299982922144124802","rule_name":"开启RDP服务","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用reg.exe操作注册表开启RDP服务的行为，进程命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者通过reg.exe修改注册表，修改默认远程桌面服务（RDP）配置项，打开RDP服务，进而通过远程桌面控制主机。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1133","name":"外部远程服务"},{"uuid":"T1543.003","name":"WINDOWS 服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T04:52:10Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (reg.exe) and process_create.cmd matches \"reg(\\.exe)?\\s+add\\s+.*?Terminal Server.*?\\/v(['\\\"]?|\\s+)fDenyTSConnections['\\\"]?\\s+.*?reg_dword.*?0\""},"group_id":""},{"uuid":"299982922144124801","rule_name":"PsExec远程执行系统命令_b","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似使用PsExec命令，远程执行系统命令(%cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"使用PsExec命令，远程执行系统命令。PsExec是windows常用的远程控制工具，通过账户和密码就可以打开一个目标主机的交互式cmd命令行。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T04:51:21Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (cmd.exe,powershell.exe) and process_create.cmd matches \"\\\\\\\\[0-9\\s\\.]*\\-u\\s.*\\-p\\s.*\""},"group_id":""},{"uuid":"299982922144124800","rule_name":"常用提权工具","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"检测到使用常用提权工具进程%(pname)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"Potato，又名烂土豆，利用已知的Windows中的权限问题，以获得本地权限提升"}],"score":10,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1053.002","name":"AT (WINDOWS)"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T04:49:21Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (potato.exe,MSFRottenPotato.exe) and process_create.cmd matches \"potato\""},"group_id":""},{"uuid":"299982922144124799","rule_name":"procdump异常Dump内存_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现恶意使用procdump.exe程序Dump lsass.exe进程内存","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"使用procdump.exe程序Dump lsass.exe进程内存。procdump.exe是非常常用的windows内存dump工具。"}],"score":9,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1119","name":"自动收集"},{"uuid":"T1005","name":"本地系统数据"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T03:48:10Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (cmd.exe,powershell.exe) and process_create.cmd matches \"\\-accepteula.*\\-.{0,3}m.*lsass\\.exe.*\""},"group_id":""},{"uuid":"299982922144124798","rule_name":"导出系统账户SAM信息","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现导出系统账户SAM信息的行为，命令行为%(cmd)","handle_desc":"关闭恶意进程，排查攻击来源，删除存在的恶意文件。","action_desc":"SAM文件是存储用户信息的关键文件，保存在内存和注册表中，攻击者通过注册表reg命令导出SAM文件，以获取系统密码。"}],"score":9,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1005","name":"本地系统数据"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T03:47:08Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname = reg.exe and process_create.cmd matches \"save.+(HKEY_LOCAL_MACHINE|hklm)\\\\(system|sam)\""},"group_id":""},{"uuid":"299982922144124797","rule_name":"复制系统命令并重命名","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过进程重命名系统命令","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者通过复制并重命名system目录下的系统命令程序到其他为止执行，以逃避检测，比如rundl32或者curtutil等程序"}],"score":10,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1036.003","name":"重命名系统程序"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T03:44:41Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (cmd.exe,xcopy.exe) and process_create.cmd matches \"copy(?:\\.exe)?\\s+c:\\\\windows\\\\system32\\\\\\b(?:cmd|certutil|regsvr32|rundll)\\b(?:\\.exe)?\\s+(?:(?:(?!\\b(?:cmd.exe|certutil|regsvr32|rundll)\\b).)*?)\\.exe\\b\""},"group_id":""},{"uuid":"299982922144124795","rule_name":"replace.exe执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现疑似replace.exe执行远程下载命令","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"replace.exe执行的参数包含http，攻击者常用这种方法下载远程服务器上的恶意文件。Replace.exe这个程序用来替换保护文件和正在运行的文件，正常情况下不会访问远程文件。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T03:41:03Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (replace.exe) and process_create.cmd matches \"[rR][eE][pP][lL][aA][cC][eE].*\\\\\\\\(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"299982922144124794","rule_name":"HH执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现疑似HH.exe执行远程下载命令","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"HH.exe执行的参数包含http，攻击者常用这种方法下载远程服务器上的恶意文件。hh.exe是windows用来打开chm格式文件的程序，正常情况下不会访问远程文件。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T03:38:21Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (HH.exe,hh.exe) and process_create.cmd matches \"[hH][hH].*https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"299982922144124791","rule_name":"wmic执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现wmic执行远程下载命令(%cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"wmic执行的参数包含http，攻击者常用这种方法下载远程服务器上的恶意文件。wmic是wmi的扩展，提供了从命令行接口和批命令脚本执行系统管理的支持，可以调用各种脚本和命令行。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0008","name":"横向移动"}],"techniques":[{"uuid":"T1047","name":"WMI"},{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T03:36:24Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (wmic.exe) and process_create.cmd matches \"[wW][mM][iI][cC].*https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"299982922144124788","rule_name":"异常添加管理员组用户","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"异常添加管理员组用户，疑似恶意行为(%cmd)","handle_desc":"排查攻击来源，删除恶意账户","action_desc":"通过net命令向管理员组添加一个新的管理员用户，在业务场景中直接添加管理员用户的场景很少，非常可疑。"}],"score":9,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1136","name":"创建账户"},{"uuid":"T1136.001","name":"本地账户"},{"uuid":"T1078.003","name":"本地账户"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T03:14:38Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (net.exe) and process_create.cmd matches \"[nN][eE][tT]\\s+[lL][oO][cC][aA][lL][gG][rR][oO][uU][pP].+[aA][dD][mM][iI][nN].+\\/[aA][dD][dD]\""},"group_id":""},{"uuid":"299982922144124787","rule_name":"修改TitanAgent服务","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现可疑的修改TitanAgent服务行为。命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查溯源。","action_desc":"攻击者通过sc.exe恶意修改TitanAgent服务,sc.exe是windows的服务管理工具，用于控制服务运行，暂停，自启等基础操作。"}],"score":10,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1070.004","name":"文件删除"},{"uuid":"T1562.001","name":"禁用或修改工具"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T03:09:12Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (sc.exe) and process_create.cmd matches \"\\b(delete|config)\\b\\s+titanagent\\b\""},"group_id":""},{"uuid":"299982922144124786","rule_name":"regsvr32执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现regsvr32执行远程下载命令%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"regsvr32执行的参数包含http，攻击者常用这种方法下载远程服务器上的恶意文件。regsvr32是Windows系统提供的用来向系统注册控件或者卸载控件的命令。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"},{"uuid":"T1218","name":"利用签名程序代理执行"},{"uuid":"T1218.010","name":"REGSVR32"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T03:06:13Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (regsvr32.exe) and process_create.cmd matches \"[rR][eE][gG][sS][vV][rR]32.*(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/)|(\\\\\\\\))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\..*[sS][cC][rR][oO][bB][jJ].*\""},"group_id":""},{"uuid":"299982922144124785","rule_name":"异常文件下载命令_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"异常文件下载命令，疑似恶意行为(%cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者使用xwizard.exe使用http协议从远程服务器中下载恶意文件执行。xwizard.exe是Windows NT 4.0 资源工具包中的文件比对工具。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"},{"uuid":"T1553.002","name":"代码签名"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-20T03:02:23Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (xwizard.exe) and process_create.cmd matches \"[xX][wW][iI][zZ][aA][rR][dD].*https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"299982922144124783","rule_name":"隐藏可执行文件属性","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现windows 隐藏可执行文件属性行为(%cmd)","handle_desc":"排查攻击来源，确认隐藏文件是否恶意，关闭恶意进程并删除恶意文件","action_desc":"攻击者通过attrib命令的-h参数，将windows可执行文件属性设置为隐藏，以维持权限。"}],"score":8,"tactics":[{"uuid":"TA0005","name":"逃避防御"},{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1564.005","name":"隐藏文件系统"},{"uuid":"T1564.001","name":"隐藏文件和目录"},{"uuid":"T1564","name":"隐藏方式"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-17T09:18:40Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (attrib.exe) and process_create.cmd matches \"[aA][tT][tT][rR][iI][bB].*\\+[hH]\\s.*\\.([eE][xX][eE]|[dD][lL][lL]|[vV][bB][sS]|[hH][tT][aA]|[mM][sS][iI]|[cC][mM][dD]|[sS][cC][rR]|[pP][sS]1)$\""},"group_id":""},{"uuid":"452152241583816749","rule_name":"rundll32调用url.dll执行恶意vb代码","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现rundll32调用url.dll执行恶意vb代码","handle_desc":"删除恶意文件，结束相关进程，检查网络连接并排查溯源","action_desc":"Internet Shortcut Shell Extension DLL，可以调用OpenURL执行恶意vb代码"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"},{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T06:08:57Z","updated_at":"2023-03-17T06:08:57Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"url.dll\\s*?\\,\\s*?OpenURL\\s+?\\\"[cC]\\:\\\\.+?.hta\""},"group_id":""},{"uuid":"452139263887147053","rule_name":"利用系统程序将恶意文件从远程拷贝到主机上_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)下载恶意文件的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后通过系统命令将恶意文件远程拷贝到主机上方便进一步渗透"}],"score":1,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T04:00:02Z","updated_at":"2023-03-17T04:39:19Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (expand.exe,extrac32.exe,findstr.exe,gfxdownloadwrapper.exe,makecab.exe,winword.exe) and process_create.cmd matches \"\\\\\\\\|https?:\\/\\/\""},"group_id":""},{"uuid":"452142837635481645","rule_name":"rundll32调用shdocvw.dll执行url文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"疑似rundll32调用系统shdocvw.dll执行恶意二进制文件","handle_desc":"删除恶意文件并结束相关进程，排查网络连接并溯源","action_desc":"shdocvw.dll是为Windows应用程序添加基础文件和网络操作相关模块，调用调用shdocvw.dll的OpenURL可以执行url文件，url文件里面可以指定一个恶意的exe程序"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"admin","created_at":"2023-03-17T04:35:32Z","updated_at":"2023-03-17T04:35:32Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"shdocvw\\.dll\\s*?\\,\\s*?OpenURL\\s+?\\\"[Cc]\\:.+?.url"},"group_id":""},{"uuid":"452142330091143213","rule_name":"rundll32调用pcwutl.dll执行恶意二进制文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"疑似rundll32调用系统pcwutl.dll执行恶意二进制文件","handle_desc":"删除恶意文件并结束相关进程，排查网络连接并溯源","action_desc":"pcwutl.dll是微软 HTML 查看器，调用pcwutl.dll的LaunchApplication可以执行恶意hta文件"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"admin","created_at":"2023-03-17T04:30:29Z","updated_at":"2023-03-17T04:30:29Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"pcwutl\\.dll\\s*?\\,\\s*?LaunchApplication\\s+.+?.exe\""},"group_id":""},{"uuid":"452142046170316845","rule_name":"rundll32调用Mshtml.dll执行恶意hta文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"疑似rundll32调用系统ieframe.dll执行恶意hta文件","handle_desc":"删除恶意文件并结束相关进程，排查网络连接并溯源","action_desc":"Mshtml.dll是微软 HTML 查看器，调用ieframe.dll的OpenURLd可以执行恶意hta文件"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"admin","created_at":"2023-03-17T04:27:40Z","updated_at":"2023-03-17T04:27:40Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"Mshtml\\.dll\\s*?\\,\\s*?PrintHTML\\s+?\\\"[Cc]\\:.+?.hta\""},"group_id":""},{"uuid":"452139252629635117","rule_name":"rundll32调用ieframe.dll执行恶意url文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"疑似调用系统ieframe.dll执行恶意url文件","handle_desc":"删除恶意文件并结束相关进程，排查网络连接并溯源","action_desc":"ieframe.dll是用于翻译 HTML 代码的互联网浏览器 DLL，rundll32可以调用ieframe.dll执行恶意url文件"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"admin","created_at":"2023-03-17T03:59:55Z","updated_at":"2023-03-17T04:23:42Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"ieframe\\.dll\\s*?\\,\\s*?OpenURL\\s+?\\\"[Cc]\\:\\\\.+?.url\""},"group_id":""},{"uuid":"452138891751718957","rule_name":"rundll32调用desk.cpl执行恶意scr文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"疑似调用系统desk.cpl执行恶意scr文件","handle_desc":"删除恶意文件并结束相关进程，排查网络连接并溯源","action_desc":"desk.cpl是桌面设置控制面板，调用desk.cpl可以执行恶意scr文件"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"admin","created_at":"2023-03-17T03:56:20Z","updated_at":"2023-03-17T03:56:20Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"desk\\.cpl\\s*?\\,\\s*?InstallScreenSaver\\s+?.+?\\.scr\""},"group_id":""},{"uuid":"452138864086089773","rule_name":"Linux系统设置代理_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)修改终端代理的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后通过export proxy修改代理劫持bash命令执行流量"}],"score":1,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1090","name":"代理"}],"platforms":[31,11,21],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T03:56:03Z","updated_at":"2023-03-17T03:56:03Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"export.*?proxy.*?https?\""},"group_id":""},{"uuid":"452138385029464109","rule_name":"rundll32调用dfshim.dll","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"疑似调用系统dfshim.dll访问恶意域名","handle_desc":"删除恶意文件并结束相关进程，排查网络连接并溯源","action_desc":"dfshim.dll是Windows 中的 ClickOnce 引擎，调用dfshim.dll的ShOpenVerbApplication可以访问恶意域名执行恶意程序"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"admin","created_at":"2023-03-17T03:51:18Z","updated_at":"2023-03-17T03:54:30Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"dfshim\\.dll\\s*?\\,\\s*?ShOpenVerbApplication\\s+?[Hh][Tt][Tt][pP]\\:\""},"group_id":""},{"uuid":"452138211720822829","rule_name":"查看远程桌面连接历史_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)查看远程桌面连接历史的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后通过cmdkey命令查看远程桌面连接历史信息"}],"score":3,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1005","name":"本地系统数据"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T03:49:34Z","updated_at":"2023-03-17T03:49:34Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (cmd.exe,cmdkey.exe,powershell.exe) and process_create.cmd contains \"cmdkey\""},"group_id":""},{"uuid":"452137959894810669","rule_name":"利用quser命令查看用户RDP会话信息_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)获取当前登录的RDP会话信息的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后通过quser命令可了解当前是否有用户正在访问这台机器"}],"score":3,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1005","name":"本地系统数据"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T03:47:04Z","updated_at":"2023-03-17T03:47:57Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (cmd.exe,quser.exe,powershell.exe) and process_create.cmd contains \"quser\""},"group_id":""},{"uuid":"452133579783143469","rule_name":"rundll32调用setupapi.dll执行行恶意二进制文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"疑似调用系统setupapi.dll执行恶意二进制文件","handle_desc":"删除恶意文件并结束相关进程，排查网络连接并溯源","action_desc":"setupapi.dll是Windows 安装程序应用程序编程接口，调用setupapi.dll的InstallHinfSection、DefaultInstall可以执行恶意二进制文件"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"需要二次判断","operate_name":"admin","created_at":"2023-03-17T03:03:34Z","updated_at":"2023-03-17T03:47:38Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"setupapi\\.dll\\s*?\\,\\s*?InstallHinfSection\\s+?DefaultInstall\\s+?\\w+\\s[Cc]\\:\\\\\\\\.+?.inf\""},"group_id":""},{"uuid":"452137614200274989","rule_name":"获取系统密码策略_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)获取系统密码策略的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后获取系统密码策略以了解当前网络环境中设备密码的复杂度"}],"score":3,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1201","name":"密码策略发现"}],"platforms":[12,32,11,31,21],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T03:43:38Z","updated_at":"2023-03-17T03:47:16Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd pmatch (\"net1?(\\.exe)?\\s+accounts\", \"cat.*?\\/etc\\/pam\\.d\\/common-password\")"},"group_id":""},{"uuid":"452137260167462957","rule_name":"将dir输出重定向到temp目录以获取文件或目录信息_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)获取目录或文件信息的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后，可通dir命令获取目录信息"}],"score":3,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1083","name":"文件和目录发现"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T03:40:07Z","updated_at":"2023-03-17T03:40:07Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd pmatch (\"dir\\s+.*?>>.*?temp\", \"dir\\s+C:\\\\\\\\progra~1\")"},"group_id":""},{"uuid":"452136890917716013","rule_name":"ping探测存活主机_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)进行探测内网存活主机的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后，可通ping命令探测存活主机"}],"score":4,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1018","name":"远程系统发现"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T03:36:27Z","updated_at":"2023-03-17T03:36:27Z","rule_roles":["1"],"rule_details":{"content":"(process_create.pname in (cmd.exe) and process_create.cmd contains \"ping\" and process_create.cmd contains \"for\") or process_create.cmd matches \".*?ping\\s+.*?(?:(?:2(?:5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(?:\\.(?:(?:2(?:5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3}.*?\\/dev\\/null.*?echo\\s+true.*?echo\\s+false.*?\""},"group_id":""},{"uuid":"452136421055004717","rule_name":"疑似powershell端口扫描_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)进行端口扫描的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后，可通powershell命令进行端口扫描"}],"score":3,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1018","name":"远程系统发现"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T03:31:47Z","updated_at":"2023-03-17T03:31:47Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (powershell.exe) and process_create.cmd matches \"Sockets\\.TcpClient|Test-NetConnection\""},"group_id":""},{"uuid":"452136146344869933","rule_name":"使用sqldatasourceEnumerator获取内网存活主机_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)获取内网存活主机的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后，可通sqldatasourceEnumerator指令获取内网存活主机列表"}],"score":2,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1018","name":"远程系统发现"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T03:29:03Z","updated_at":"2023-03-17T03:30:13Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (powershell.exe) and process_create.cmd contains \"sqldatasourceEnumerator\""},"group_id":""},{"uuid":"452135923409223725","rule_name":"利用net、reg等命令获取有关系统的详细信息_lowscore","displays":[{"type":"process_create","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过命令%(cmd)获取系统信息的可疑行为","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者获取初始访问权限之后，可通过系统自带命令获取系统信息。"}],"score":1,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1057","name":"进程发现"}],"platforms":[31,11,21],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-17T03:26:51Z","updated_at":"2023-03-17T03:26:51Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (net.exe,reg.exe,nltest.exe,wmic.exe,cmd.exe,systeminfo,nslookup.exe,netdom.exe) and process_create.cmd pmatch (\"net.*?config\", \"reg.*?(?:\\\\Services\\\\Disk\\\\Enum|\\\\Cryptography)\", \"wmic.*?(?:environment|qfe|startup|OS)\", \"nltest.*?\\/DCLIST\", \"net.*?time.*?\\/domain\", \"systeminfo\", \"nslookup.*?type.*?SRV\", \"netdom.*?query.*?pdc\") and not process_create.cmd matches \"BootDevice|FreePhysicalMemory|FreeVirtualMemory|TotalVirtualMemorySize|TotalVisibleMemorySize|value\" and not process_create.pppath matches \"aliyun|code\\.exe|NetBackup\""},"group_id":""},{"uuid":"299982922144124659","rule_name":"web服务调用python脚本","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web服务异常执行python命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过python解释器执行恶意代码，实现反弹shell或命令执行等行为。"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-17T03:00:00Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (apache,apache2,httpd,php-fpm,java,postgres,redis-server) and process_create.pname in (python,python2,python3) and process_create.cmd matches \"subprocess\\.(PIPE|Popen|run|call|check_all|check_output|getoutput|getstatusoutput)\""},"group_id":""},{"uuid":"299982922144124775","rule_name":"windows内网扫描行为_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现内网扫描行为，疑似探测存活主机","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"通过cmd的for语法循环执行ping命令在内网寻找存活主机"}],"score":9,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1120","name":"外围设备发现"},{"uuid":"T1040","name":"网络嗅探"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-17T01:55:44Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (cmd.exe) and process_create.cmd matches \"[fF][oO][rR].*\\b([iI][nN]).*([pP][iI][nN][gG]|[tT][eE][lL][eE][nN][tT]).*\\..+\\..+\\..*\""},"group_id":""},{"uuid":"451877311164186669","rule_name":"wuauclt.exe加载恶意DLL","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现%(pname)加载恶意dll","handle_desc":"结束相关进程，删除恶意dll","action_desc":"wuauclt.exe为windows更新客户端"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"宽泛，后续需修改","operate_name":"admin","created_at":"2023-03-15T08:37:46Z","updated_at":"2023-03-16T10:29:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (wuauclt.exe) and process_create.cmd matches \"add\\s+?helper\\s+?.+?\\.dll\""},"group_id":""},{"uuid":"299982922144124774","rule_name":"PsExec远程执行系统命令_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用PsExec远程执行系统命令","handle_desc":"排查攻击来源，判断是否恶意，关闭恶意进程并删除恶意文件。","action_desc":"PsExec是一个很常用的windows远程命令执行工具，可以在目标主机不开启3389的情况下使用ipc共享执行命令。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T10:18:47Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (psexec.exe,psexec64.exe) and process_create.cmd matches \"\\\\\\\\.*\\-u\\s.*\""},"group_id":""}],"total":336}

{"data":[{"uuid":"299982922144124773","rule_name":"procdump异常Dump内存_b","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似恶意使用procdump.exe程序Dump系统进程内存","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"使用procdump.exe程序Dump系统进程内存，procdump是一个工具，用来抓取系统内存中的明文密码或者密码哈希。"}],"score":9,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1119","name":"自动收集"},{"uuid":"T1005","name":"本地系统数据"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T10:12:28Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (procdump.exe,procdump64.exe) and process_create.cmd matches \"(lsass\\.exe|\\-ma\\s*\\d{1,3})(\\s+|$)\""},"group_id":""},{"uuid":"452024837737545773","rule_name":"cmstp.exe远程下载文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"cmstp.exe远程下载文件","handle_desc":"检查是否为业务操作，删除文件，排查入侵痕迹","action_desc":"发现cmstp.exe远程下载文件，攻击者会使用该二进制程序从远程服务器下载文件。"}],"score":7,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1105","name":"入口工具转移"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-16T09:03:18Z","updated_at":"2023-03-16T10:11:36Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (cmstp.exe) and process_create.cmd matches \"cmstp\\.exe\\s*\\/ni\\s*\\/s\\s*https?\\:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)\""},"group_id":""},{"uuid":"452029017244041261","rule_name":"发现疑似Makecab.exe执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现疑似Makecab.exe执行远程下载命令","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"Makecab.exe执行远程下载命令,Makecab.exe是Windows系统自带的二进制文件，攻击者可以使用它绕过安全工具检测"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-16T09:44:50Z","updated_at":"2023-03-16T09:44:50Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (Makecab.exe) and process_create.cmd matches \"[Mm][Aa][Kk][Ee][Cc][Aa][Bb].*\\\\\\\\(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+.*\\.cab\""},"group_id":""},{"uuid":"452028238345011245","rule_name":"发现疑似print.exe执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现疑似print.exe执行远程下载命令","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"print.exe执行远程下载命令,print.exe是Windows系统自带的二进制文件，攻击者可以使用它绕过安全工具检测"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-16T09:37:06Z","updated_at":"2023-03-16T09:44:07Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (print.exe) and process_create.cmd matches \"[Pp][Rr][Ii][Nn][Tt]\\s*\\/[\\w]\\:[\\w]+.*\\\\\\\\(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\""},"group_id":""},{"uuid":"451988432604889133","rule_name":"verclsid.exe执行恶意COM对象","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现verclsid.exe执行恶意COM对象","handle_desc":"排查入侵痕迹，恢复恢复被修改的注册表","action_desc":"verclsid.exe是Microsoft XP 安全更新程序 (KB908531)，verclsid.exe可以被利用执行恶意COM对象"}],"score":7,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-16T03:01:39Z","updated_at":"2023-03-16T09:12:06Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (verclsid.exe) and process_create.cmd matches \"\\/[Ss]\\s+?\\/[cC]\\s+?\\{\""},"group_id":""},{"uuid":"299982922144124762","rule_name":"suspicious_service_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现服务运行文件在TEMP目录，疑似后门文件","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"服务对应的文件应该在系统目录，或者其他用户配置的目录下，不应该存在于临时目录。很多攻击者由于只有临时目录的权限，只能把对应恶意文件保存到临时目录并配置服务进行权限维持。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1569","name":"系统服务"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:59:08Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname[1] in (services.exe) and process_create.acmd[1] matches \"^[cC]:\\\\[wW]indows\\\\[sS]ystem32\\\\services\\.[eE][xX][eE]\" and process_create.cmd matches \"^[cC]:\\\\[wW]indows\\\\[tT]emp\\\\.*?\\.[eE][xX][eE]\""},"group_id":""},{"uuid":"299982922144124750","rule_name":"msiexec_rexec","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现msiexec执行远程msi程序，命令行为%(cmd)","handle_desc":"杀掉对应进程，排查入侵痕迹，进一步处理。","action_desc":"msiexec执行远程MSI安装包程序。msiexec是windows下用来安装.msi后缀安装包的程序，支持从远程服务器上自动下载安装msi，攻击者可以利用msiexec下载并安装远程服务器上的恶意msi进行权限维持。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:53:34Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (msiexec.exe) and process_create.cmd matches \"\\/passive\\s+\\/i\\s+https?:\\/\\/.*?.msi\""},"group_id":""},{"uuid":"299982922144124736","rule_name":"cmd命令混淆执行","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现cmd执行的命令被混淆，疑似恶意命令","handle_desc":"停止进程，删除恶意文件","action_desc":"cmd.exe执行的命令中，先设置变量，再调用变量执行，来绕过对cmd进程参数的检测。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.003","name":"WINDOWS COMMAND SHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:47:39Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname = cmd.exe and process_create.cmd matches \"set\\s+[^=\\s]+=[pP]\\w+\\s*&\\s*call\\s+%[^=\\s]+%\\w+\""},"group_id":""},{"uuid":"299982922144124734","rule_name":"winlogon产生可疑子进程","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现winlogon产生可疑cmd或者powershell子进程","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"疑似系统winlogon进程被注入恶意代码。winlogon是用于处理交互式用户登录和注销的进程，是开启和解锁之后首先会调用的进程之一，攻击者注入winlogon进程可以实现恶意程序自启动。"}],"score":8,"tactics":[{"uuid":"TA0003","name":"权限维持"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1547.004","name":"WINLOGON HELPER DLL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:46:10Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.ppname = winlogon.exe and (process_create.pname = cmd.exe or process_create.pname = powershell.exe)"},"group_id":""},{"uuid":"299982922144124732","rule_name":"rundll32执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用rundll32执行远程下载命令的可疑行为","handle_desc":"关闭恶意进程，排查并删除系统中被添加的恶意文件。","action_desc":"攻击者可以通过系统自带的程序实现恶意文件的远程下载或者代理执行恶意命令以逃避检测。比如使用rundll32调用davcint.dll下载公网上的脚本。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1218","name":"利用签名程序代理执行"},{"uuid":"T1218.011","name":"RUNDLL32"},{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:44:25Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"[rR][uU][nN][dD][lL][lL]32\\.exe(?!\\sC\\:\\\\[wW][iI][nN][dD][oO][wW][sS]\\\\[sS]ystem32\\\\davclnt\\.dll).*(?<!FileProtocolHandler\\s|CryptExtOpenCER\\s)(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/)|(\\\\\\\\))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[\\w\\-\\.\\:]+[\\\\\\/].*\""},"group_id":""},{"uuid":"299982922144124715","rule_name":"Impacket命令执行_c","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现cmd进程符合Impacket wmi横向移动的特征","handle_desc":"停止恶意进程，排查主机访问日志，排查windows日志，查找wmi请求来源ip，排查主机账号密码是否已经泄露。","action_desc":"攻击者通过Impacket中的wmiexec.py脚本在主机上执行命令的行为，特征为父进程名wmiprvse.exe，子进程为cmd.exe，参数包含/Q /c，2>&1，1<等重定向和127.0.0.1的本机ip。执行的命令为/c后的部分。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0008","name":"横向移动"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.003","name":"WINDOWS COMMAND SHELL"},{"uuid":"T1569","name":"系统服务"},{"uuid":"T1569.002","name":"服务执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:41:10Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname = \"cmd.exe\" and process_create.ppname = \"services.exe\" and process_create.cmd matches \"\\/C\\s+.*?>.*?\\\\Temp\\\\.*?\\.tmp\\s+2>&1\""},"group_id":""},{"uuid":"299982922144124714","rule_name":"Impacket命令执行_b","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现powershell进程符合Impacket wmi横向移动的特征","handle_desc":"停止恶意进程，排查主机访问日志，排查windows日志，查找wmi请求来源ip，排查主机账号密码是否已经泄露。","action_desc":"攻击者通过Impacket中的wmiexec.py脚本在主机上执行命令的行为，特征为父进程名wmiprvse.exe，子进程为posershell.exe，参数包含-NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0008","name":"横向移动"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.001","name":"POWERSHELL"},{"uuid":"T1047","name":"WMI"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:40:59Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname = \"powershell.exe\" and process_create.ppname = \"wmiprvse.exe\" and process_create.cmd matches \"-NoP\\s+-NoL\\s+-sta\\s+-NonI\\s+-W\\s+Hidden\\s+-Exec\\s+Bypass\\s+-Enc\""},"group_id":""},{"uuid":"299982922144124713","rule_name":"Impacket命令执行_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现cmd进程符合Impacket wmi横向移动的特征","handle_desc":"停止恶意进程，排查主机访问日志，排查windows日志，查找wmi请求来源ip，排查主机账号密码是否已经泄露。","action_desc":"攻击者通过Impacket中的wmiexec.py脚本在主机上执行命令的行为，特征为父进程名wmiprvse.exe，子进程为cmd.exe，参数包含/Q /c，2>&1，1<等重定向和127.0.0.1的本机ip。执行的命令为/c后的部分。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0008","name":"横向移动"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1047","name":"WMI"},{"uuid":"T1059.003","name":"WINDOWS COMMAND SHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:40:50Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname = \"cmd.exe\" and process_create.ppname matches \"((wmiprvse\\.exe)|(explorer\\.exe))\" and process_create.cmd matches \"\\/Q\\s+\\/c\\s.*?1>\\s*\\\\\\\\127\\.0\\.0\\.1\\\\.*?\\\\__.*?\\s+2>&1\""},"group_id":""},{"uuid":"299982922144124709","rule_name":"使用BOtB工具进行容器逃逸","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用BOtB工具进行容器逃逸%(cmd)","handle_desc":"删除恶意文件并杀死恶意进程，及时对漏洞进行修补，通过日志排查确定攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者可能使用BOtB工具，从容器逃逸到宿主机，这将使攻击者获取宿主机资源的访问权限。"}],"score":9,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1611","name":"容器逃逸"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:39:19Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (\"botb-linux-amd64\",\"botb-linux-386\")"},"group_id":""},{"uuid":"299982922144124707","rule_name":"ssh动态转发实现socks代理","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用ssh动态转发实现socks代理的可疑命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者利用ssh动态转发实现socks代理，访问或窃取内网资源。"}],"score":10,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1572","name":"协议隧道"},{"uuid":"T1090","name":"代理"},{"uuid":"T1090.001","name":"内网代理"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:37:58Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ssh) and process_create.cmd matches \"ssh.*\\-D\\s+[0-9]{1,5}.*\\..*\""},"group_id":""},{"uuid":"299982922144124706","rule_name":"ssh服务后门","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现创建ssh服务后门命令%(cmd)","handle_desc":"删除并停止后门服务进程或文件，通过日志排查并确定攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过创建ssh软连接，开启一个监听端口作为后门服务进行权限持久化。"}],"score":9,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1543","name":"创建或修改系统进程"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:37:19Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (su,chsh,chfn) and process_create.cmd matches \"^.*?(?:su|chfn|chsh)\\s+-(?:oPort|oport)=.*?$\""},"group_id":""},{"uuid":"299982922144124700","rule_name":"使用strace记录sshd服务用户名密码","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用strace记录sshd服务用户名密码的可疑命令%(cmd)","handle_desc":"删除并关闭恶意后门进程和文件，通过分析日志排查攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过strace捕获用户的输入，可以快速收集到用户输入的服务凭证信息。"}],"score":9,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1056","name":"输入捕获"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:35:29Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (bash,sh,dash,zsh,ksh,csh,tcsh,tclsh) and process_create.cmd matches \"strace\\s.*?((-p.*?ps.*?grep.*?sshd.*?awk.*?\\s)|(-e\\strace=read,write(,connect)?.*?\\s)|(-s\\s\\d+.*?)){3}\\s2>\\s.*?&\""},"group_id":""},{"uuid":"299982922144124688","rule_name":"Mv_EvilAct_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现重命名系统程序%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过重命名系统程序执行恶意命令，以逃避防御，比如将将wget重命名为mv，然后通过这个mv远程下载脚本执行。"}],"score":9,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1036.003","name":"重命名系统程序"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:30:25Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (mv) and process_create.cmd matches \"\\/usr\\/bin\\/(?:wget|curl)\""},"group_id":""},{"uuid":"299982922144124673","rule_name":"mount_bind命令隐藏进程信息","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用mount命令隐藏进程信息","handle_desc":"还原被隐藏的文件或目录，排查相关日志并确定攻击者如何获取到系统初始访问权限。","action_desc":"攻击者通过mount命令挂载恶意进程的proc路径到其他位置来隐藏进程相关的文件或目录。"}],"score":9,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1564","name":"隐藏方式"},{"uuid":"T1564.001","name":"隐藏文件和目录"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:29:03Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (mount) and process_create.cmd matches \"--bind\\s+(\\/.*?)+\\s+\\/proc\\/\\d+\""},"group_id":""},{"uuid":"299982922144124671","rule_name":"goby扫描进程","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现goby扫描进程%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过goby网络扫描工具发现内网中存活的服务、主机。"}],"score":10,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1040","name":"网络嗅探"},{"uuid":"T1046","name":"网络服务扫描"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:28:14Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (goby-cmd.exe,goby.exe) and process_create.cmd matches \"-\""},"group_id":""},{"uuid":"299982922144124739","rule_name":"cobaltstrike服务端","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现启动CobaltStrike服务端的可疑行为","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"进程命令行中包含cobalstrike服务端的特征，攻击者可能会把CS客户端部署到失陷的靶机中进一步控制内网。"}],"score":10,"tactics":[{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1219","name":"远程访问软件"},{"uuid":"T1573","name":"加密通道"}],"platforms":[21,12,11,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:27:51Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (java.exe) and process_create.cmd matches \"-Dcobaltstrike.server_port=\\d+\\s+-Djavax\\.net\\.ssl\\.keyStore=\\.\\/cobaltstrike.store\""},"group_id":""},{"uuid":"299982922144124660","rule_name":"篡改可执行文件","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现篡改系统可执行文件的可疑行为%(cmd)","handle_desc":"还原系统原始命令文件，杀掉恶意进程并通过日志排查攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者使用mv命令向环境变量包含的可执行文件搜索路径中添加文件，一般会把恶意文件伪造成正常二进制文件进行权限维持。"}],"score":3,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1036","name":"伪装"},{"uuid":"T1036.005","name":"匹配合法的名称或位置"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T08:06:58Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (mv) and process_create.cmd matches \"(\\/bin|\\/sbin)\""},"group_id":""},{"uuid":"299982922144124654","rule_name":"容器内可疑文件操作","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现可疑文件操作行为","handle_desc":"删除恶意文件，清理计划任务并删除恶意进程。","action_desc":"攻击者获取到容器访问权限后，会执行一些敏感的操作比如wget下载脚本，vim编辑文件等。"}],"score":3,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1053","name":"计划任务/作业"},{"uuid":"T1053.003","name":"CRON"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T07:45:32Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rm,mkdir,touch,cat,vim,vi,nano,bash,sh,dash,ksh,mv,curl,wget,find) and process_create.cmd matches \"sshd?_config|\\.ssh|authorized_keys|crond|profile|zshrc|bashrc|\\.service|\\/bin\\/culr|gates\\d+|dirtycow|ping6|xmrig|config\\.json|shell\\.py|nmap\""},"group_id":""},{"uuid":"299982922144124653","rule_name":"清除系统日志","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现清除系统日志的可疑行为%(cmd)","handle_desc":"删除恶意文件并停止恶意进程，通过云端记录的日志记录排查攻击者的入侵痕迹。","action_desc":"攻击者通过清除系统的secure或者其他log日志，进行防御逃避，隐藏自身入侵痕迹。"}],"score":4,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1070","name":"主机数据删除"},{"uuid":"T1070.002","name":"清除 LINUX 或 MAC 系统日志"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T07:44:13Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"rm\\s+.*?(secure|log)\" or process_create.cmd matches \"echo.*?>.*?(secure|\\.log)\""},"group_id":""},{"uuid":"299982922144124651","rule_name":"find查找私钥","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现查找私钥的恶意行为","handle_desc":"杀掉恶意进程，并通过日志排查确定攻击者如何获取系统的初始访问权限。","action_desc":"攻击者通过遍历查询磁盘数据，寻找用户的密码或者私钥文件，进行权限维持或者横向移动"}],"score":3,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1552","name":"不安全的凭证"},{"uuid":"T1552.004","name":"私钥"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T07:40:04Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (find) and process_create.cmd matches \"-name\\s+?(.*?key|.*?rsa)\""},"group_id":""},{"uuid":"299982922144124650","rule_name":"删除系统目录","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现删除系统目录的可疑操作%(cmd)","handle_desc":"还原数据或通过云端日志记录排查攻击者入侵痕迹。","action_desc":"攻击者通过删除主机文件内的关键文件，比如log日志，proc信息等，以逃避防御。"}],"score":3,"tactics":[{"uuid":"TA0040","name":"影响"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1070","name":"主机数据删除"},{"uuid":"T1070.004","name":"文件删除"},{"uuid":"T1561","name":"磁盘擦除"},{"uuid":"T1561.001","name":"磁盘内容擦除"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T07:39:30Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"rm\\s+-rf\\s+(\\/|\\/etc|\\/proc|\\/tmp|\\/lib|\\/lib64|\\/sys|\\/bin|\\/sbin|\\/var\\/log)($|\\/\\*?$|\\/\\*?\\s+|\\s+)\""},"group_id":""},{"uuid":"299982922144124646","rule_name":"perl远程下载并执行_b","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用perl远程下载并执行的可疑行为","handle_desc":"删除恶意文件并停止恶意进程，通过日志排查确定攻击者的入侵痕迹。","action_desc":"攻击者通过在命令行执行perl代码，从远程服务器上下载包含执行函数的恶意代码，到主机上执行。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T07:38:21Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (perl) and process_create.cmd matches \"(https?:\\/\\/|decode\\_base64).*((system\\()|(exec\\()|(readpipe\\()|eval\\().*\""},"group_id":""},{"uuid":"299982922144124645","rule_name":"perl远程下载并执行_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用perl远程下载并执行的可疑行为","handle_desc":"删除恶意文件并停止恶意进程，通过日志排查确定攻击者的入侵痕迹。","action_desc":"攻击者通过在命令行执行perl代码，从远程服务器上下载包含执行函数的恶意代码，到主机上执行。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T07:37:54Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (perl) and process_create.cmd matches \"((system\\()|(exec\\()|(readpipe\\()|eval\\().*(https?:\\/\\/|decode\\_base64).*\""},"group_id":""},{"uuid":"299982922144124641","rule_name":"python异常的uid切换","displays":[{"type":"default_source","alarm_type":"QTAL-004","alarm_name":"本地提权","alarm_title":"发现使用python进行suid提权的可疑行为","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过python的os.setuid函数设置进程的uid为0进行特权提升操作，0是root用户的uid。此操作可能要求执行的用户有sudu权限或者python进程有suid权限。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"},{"uuid":"T1548","name":"滥用权限控制机制"},{"uuid":"T1548.001","name":"SETUID 和 SETGID"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-16T07:36:10Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (python,python2,python3) and process_create.cmd matches \"os\\.setuid\\(0\\)\""},"group_id":""},{"uuid":"299982922144124631","rule_name":"远程下载脚本并执行","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现远程下载脚本并执行的可疑行为","handle_desc":"删除恶意文件并停止恶意进程，通过日志排查确定攻击者的入侵痕迹。","action_desc":"攻击者通过curl或者wget从远程服务器上下载恶意代码，在受害者系统上执行。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[21,11,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T09:49:12Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"(curl|wget).{1,15}\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost|(?:[\\w\\-]*\\.)*(?:byted\\.org|bytedance\\.net)\\b|(?:[\\w\\-]*\\.)*google\\.com\\b)[^;&|]{1,100}\\|[^;&|]{0,20}\\b(bash|sh|dash|tcsh|csh|ksh|zsh)\\b\""},"group_id":""},{"uuid":"299982922144124630","rule_name":"Python生成交互式shell","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用python生成交互式shell的可疑行为","handle_desc":"停止恶意进程并删除恶意文件，通过系统日志排查攻击者的入侵痕迹，及时修补漏洞。","action_desc":"攻击者可以通过python直接生成交互式反弹shell更方便远程控制的指令收发。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T09:48:30Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (python,python2,python3) and process_create.cmd matches \"python.*import.*pty.*pty\\.spawn.*sh\""},"group_id":""},{"uuid":"299982922144124624","rule_name":"使用logtamper修改linux日志","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用logtamper修改linux日志的可疑行为，命令行为%(cmd)","handle_desc":"删除恶意文件并停止恶意进程，结合其他告警或日志排查攻击者入侵途径。","action_desc":"攻击者使用logtamper-static工具来修改linux日志。logtamper-static是一个日志修改工具，在修改日志文件的同时，能够保留被修改文件的时间信息。"}],"score":9,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1070","name":"主机数据删除"},{"uuid":"T1070.002","name":"清除 LINUX 或 MAC 系统日志"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T09:48:02Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname = \"logtamper-static\""},"group_id":""},{"uuid":"299982922144124623","rule_name":"设置ssh任意密码登录后门","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现sshd服务文件被替换，命令行为%(cmd)","handle_desc":"删除恶意文件并停止恶意进程，结合其他日志或告警排查攻击者的入侵途径，及时修补漏洞。","action_desc":"攻击者通过替换sshd服务文件为后门文件，使用任意密码即可登录目标系统或记录用户输入的密码。"}],"score":10,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1556","name":"修改鉴权流程"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T09:46:49Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname = ln and process_create.cmd contains \"-sf\" and process_create.cmd contains \"/usr/sbin/sshd\""},"group_id":""},{"uuid":"299982922144124622","rule_name":"python 恶意命令执行_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用python执行混淆代码的恶意行为，命令行为:%(cmd)","handle_desc":"删除恶意文件并停止恶意进程，通过日志或其他告警排查攻击者的入侵途径，及时修补漏洞。","action_desc":"python进程的参数中包含exec执行函数以及可疑的解码包括base64，chr等，疑似攻击者在执行恶意命令"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T09:38:51Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (python,python2,python3) and process_create.cmd matches \"python.*(exec\\(.*base64|exec\\(.*chr\\(|exec\\(.*https?:\\/\\/).*\""},"group_id":""},{"uuid":"299982922144124621","rule_name":"疑似使用黑客工具","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用黑客工具的可疑命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过使用公开的黑客工具逃避防御或进行内网扫描，包括常见的nmap，masscan，hydra等。"}],"score":9,"tactics":[{"uuid":"TA0007","name":"发现"},{"uuid":"TA0011","name":"命令与控制"}],"techniques":[{"uuid":"T1040","name":"网络嗅探"},{"uuid":"T1046","name":"网络服务扫描"},{"uuid":"T1071.004","name":"DNS"},{"uuid":"T1572","name":"协议隧道"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T09:35:58Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (nmap,masscan,hydra,pingtunnel,dnstunnel,peirates)"},"group_id":""},{"uuid":"451871282254839853","rule_name":"搜索web配置文件","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现进程执行find命令搜索xml等配置文件后缀","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者经常用find命令搜索web配置文件，找数据库配置和密码。"}],"score":4,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1602","name":"配置仓库数据"}],"platforms":[11,31,21],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-15T07:37:52Z","updated_at":"2023-03-15T07:37:52Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (find) and process_create.cmd matches \"((application\\.((properties)|(yml)))|(web\\.xml))\""},"group_id":""},{"uuid":"299982922144124652","rule_name":"创建敏感文件软链接","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现创建敏感文件软链接的可疑操作%(cmd)","handle_desc":"删除恶意文件，并通过日志排查攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过创建/etc/passwd和/etc/shadow等文件的软链接文件，间接读取文件内容，以逃避防御。"}],"score":3,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1003.008","name":"/etc/passwd&amp;shadow"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T07:18:03Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ln,link) and process_create.cmd matches \"-s\\s+(\\/etc\\/passwd|\\/etc\\/shadow)\""},"group_id":""},{"uuid":"299982922144124665","rule_name":"脏牛漏洞提权","displays":[{"type":"default_source","alarm_type":"QTAL-004","alarm_name":"本地提权","alarm_title":"发现脏牛漏洞利用程序%(pname)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限，及时修补漏洞。","action_desc":"攻击者可以通过系统内核或软件的特权提升漏洞将较低的初始访问权限提升到系统最高权限，从而能够完全控制目标系统。"}],"score":2,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1068","name":"特权提升漏洞"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T07:15:22Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (dcow) and process_create.cmd matches \"(-s)\""},"group_id":""},{"uuid":"299982922144124647","rule_name":"数据库执行系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现数据库应用执行系统命令%(pname)","handle_desc":"删除恶意文件并停止恶意进程，通过数据库日志排查攻击者入侵痕迹。","action_desc":"攻击者在获取到数据库的初始访问权限之后，可能会直接利用数据库自身特性执行系统命令，以获取到主机访问权限。"}],"score":3,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T07:15:01Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (mysqld,oracle,sqlplus,redis-server,postgres) and process_create.pname in (man,uptime,users,service,pkill,pmap,wget,ftp,free,top,last,ps,shutdown,info,env,netstat,arp,df,du,init,nano,nslookup,shred,cat,pwd,locate,chown,alias,echo,cmp,mount,ifconfig,traceroute,sudo,route,ping,find,users,who,ls,tar,grep,su,awk,useradd,adduser,chattr,arp,passwd,base64,nc,netcat,curl,id,whoami,busybox,setenforce,getenforce,htop,kill,ss,ip,systemctl,iptables,ufw,mount,unmount,touch,tree,fdisk,visudo,crontab,unzip,ncat,bash,sh,dash,ksh)"},"group_id":""},{"uuid":"299982922144124658","rule_name":"web服务执行python脚本","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web服务异常执行python命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者利用python解码并执行base64加密的恶意代码，以此逃避防御并执行恶意命令。"}],"score":3,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1140","name":"解混淆/解码文件或信息"},{"uuid":"T1202","name":"间接执行命令"},{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T07:13:43Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (apache,apache2,httpd,php-fpm,java,postgres,redis-server) and process_create.pname in (python,python2,python3) and process_create.cmd matches \"exec.*b64decode\""},"group_id":""},{"uuid":"299982922144124661","rule_name":"删除敏感目录","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现删除系统敏感目录操作%(cmd)","handle_desc":"通过数据备份恢复被删除数据，通过日志排查并确定攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过删除系统重要目录，可造成系统或软件服务无法正常运行。"}],"score":2,"tactics":[{"uuid":"TA0040","name":"影响"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1070","name":"主机数据删除"},{"uuid":"T1070.004","name":"文件删除"},{"uuid":"T1561","name":"磁盘擦除"},{"uuid":"T1561.001","name":"磁盘内容擦除"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T07:13:29Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rm) and process_create.cmd matches \"(\\/etc|\\/bin)\""},"group_id":""},{"uuid":"451731285044363309","rule_name":"At.exe计划任务","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用系统自带文件%(pname)执行计划任务的可疑行为","handle_desc":"删除恶意文件，清理计划任务并删除恶意进程。","action_desc":"检测at.exe执行计划任务"}],"score":3,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1053","name":"计划任务/作业"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-14T08:27:07Z","updated_at":"2023-03-15T07:13:13Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (at.exe) and process_create.cmd matches \"at\\s+?\\d+?\\:\\d+?\\s+?\\/interactive\\s+?\\/every.+?\\.(exe|bat)\""},"group_id":""},{"uuid":"299982922144124648","rule_name":"添加SUID权限","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现添加SUID权限的可疑行为","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过程序或脚本的suid权限绕过防御进行特权提升操作。"}],"score":3,"tactics":[{"uuid":"TA0005","name":"逃避防御"},{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1548","name":"滥用权限控制机制"},{"uuid":"T1548.001","name":"SETUID 和 SETGID"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T07:08:13Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (chmod) and process_create.cmd matches \"(4[1-7]{3}\\s+.+)|(u\\+s\\s+?.+)\""},"group_id":""},{"uuid":"299982922144124716","rule_name":"web应用执行敏感系统命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现web应用异常执行系统命令%(pname)","handle_desc":"排查恶意的web文件进行清除，通过web日志或其他告警排查确定攻击者的入侵途径，及时修补漏洞。","action_desc":"攻击者通过webshell或web命令执行漏洞经常执行一些常见的命令，例如 passwd、useradd 等"}],"score":3,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-15T07:07:52Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (apache,apache2,httpd,php-fpm,java,postgres,redis-server,nginx) and process_create.pname in (id,ifconfig,uname,hostname,ping,cat,ps,w,who,whoami,nmap,nc,fping,hping,traceroute,mtr,telnet,masscan)"},"group_id":""},{"uuid":"299982922144124657","rule_name":"socat反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现socat反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[21,11,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T10:04:33Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (socat,socat.exe) and (process_create.cmd matches \"([Tt][Cc][Pp]|[Tt][Cc][Pp]\\-[Cc][Oo][Nn][Nn][Ee][Cc][Tt])\\:\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}:\\d{1,5}\\s[Ee][Xx][Ee][Cc]:((ba)|z|da|tc|c|k|z)?sh\" or process_create.cmd matches 'exec:.(\\/.*?\\/)?((ba)|z|da|tc|c|k|z)?sh(\\s-li)?.*?\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}:\\d{1,5}' or process_create.cmd matches \"\" )"},"group_id":""},{"uuid":"299982922144124768","rule_name":"python反弹cmd或powershell","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现python反弹cmd或者powershell命令行shell命令%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"python反弹cmd或者powershell命令行shell命令"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:59:12Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (python.exe,python2.exe,python3.exe) and process_create.acmd matches \"lambda\\s__y,\\s__g,\\s__contextlib:\\s\\[{7}\\s*\\(\\w+\\.connect(.*?lambda){9}.*?subprocess\\.Popen\\(\\['\\\\\\\\windows\\\\\\\\system32\\\\\\\\(cmd\\.exe|windowspowershell\\\\\\\\v1.0\\\\\\\\powershell\\.exe)(.*?lambda){18}\" and process_create.pname in (powershell.exe,cmd.exe)"},"group_id":""},{"uuid":"446501104574791729","rule_name":"rubeus_toolset","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用开源工具Rubeus进行域渗透%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者利用Rubeus工具可以完成域内用户的凭证窃取、票据伪造、PTH、PTT等大多数域渗透操作。"}],"score":10,"tactics":[{"uuid":"TA0008","name":"横向移动"},{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1550","name":"使用替代的身份验证材料"},{"uuid":"T1550.002","name":"哈希传递攻击"},{"uuid":"T1550.003","name":"票据传递攻击"},{"uuid":"T1003","name":"系统凭证转储"},{"uuid":"T1003.001","name":"LSASS 内存"},{"uuid":"T1003.003","name":"NTDS"},{"uuid":"T1003.005","name":"缓存的域凭证"},{"uuid":"T1003.006","name":"DCSYNC"},{"uuid":"T1558","name":"窃取或伪造 KERBEROS 票据"},{"uuid":"T1558.001","name":"黄金票据"},{"uuid":"T1558.002","name":"白银票据"},{"uuid":"T1558.003","name":"KERBEROASTING"},{"uuid":"T1558.004","name":"AS-REP ROASTING"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-02-06T06:29:57Z","updated_at":"2023-03-14T07:58:38Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"rubeus(?:\\.exe)?\\s+(?:asktgt|renew|brute|preauthscan|s4u|golden|silver|asktgs|diamond|klist|ptt|purge|triage|describe|dump|tgtdeleg|monitor|harvest|kerberoast|asreproast|changepw|hash|createnetonly|tgssub|currentluid|logonsession)\\b|\\.exe\\s+(?:asktgt\\s+.*?(?:\\/domain:|\\/rc4:[a-zA-Z0-9]{32}|\\/getcredentials\\+|\\/certificate:)|asktgs\\s+.*?(?:\\/ticket:|\\/u2u\\s+)|renew\\s+.*?(?:\\/ticket:)|brute\\s+.*?\\/noticket\\b|preauthscan\\s+.*?(?:\\/domain:|\\/dc:)|s4u\\s+.*?(?:\\/rc4:[a-zA-Z0-9]{32}|\\/impersonateuser:|\\/ptt\\b|\\/altservice:)|golden\\s+.*?(?:\\/aes256:[a-zA-Z0-9]{64}|\\/ldap\\b|\\/printcmd\\b)|silver\\s+.*?(?:\\/service:|\\/rc4:[a-zA-Z0-9]{32}|\\/nowrap\\b|\\/ptt\\b)|diamond\\s+.*?(?:\\/krbkey:[a-zA-Z0-9]{64}|\\/tgtdeleg\\b)|ptt\\s+.*?\\/ticket:\\S{10,}|(?:klist|triage|purge|dump)\\s+.*?(?:\\/luid:0x|\\/service:(?:krbtgt|ldap))|describe\\s+.*?\\/ticket:\\S{10,}|monitor\\s+\\/targetuser:\\S+\\$|kerberoast\\s+.*?(?:\\/ou:OU=|\\/user:|\\/domain:|\\/nowrap\\b|\\/ticket:\\S{10,}|\\/rc4opsec\\b)|asreproast\\s+(?:\\/ou:OU=|\\/user:|\\/domain:)|createnetonly\\s+.*?\\/program:.*?exe|changepw\\s+.*?(?:\\/ticket:\\S{10,})|tgssub\\s+(?:\\/ticket:\\S{10,}|\\/altservice:|\\/ptt\\b))\""},"group_id":""},{"uuid":"299982922144131264","rule_name":"利用 cscript.exe 代理执行恶意脚本","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现通过系统自带的脚本程序 cscript.exe 代理执行恶意脚本，进程命令行为%(cmd)","handle_desc":"停止相关进程并删除恶意文件。","action_desc":"攻击者通过系统自带的签名程序可以间接地执行命令或加载恶意文件，攻击者通常使用此项技术逃避防御。"}],"score":10,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1218","name":"利用签名程序代理执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T10:02:48Z","updated_at":"2023-03-14T07:58:27Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (cscript.exe) and process_create.cmd matches \"cscript(?:\\.exe['\\\"]?)?\\s+.*?(\\w:\\\\.*?\\.\\w+:\\w+\\.\\w+|\\\\\\\\\\S+\\\\\\w+\\.\\w+)\""},"group_id":""},{"uuid":"299982922144124817","rule_name":"使用黑客工具mimikatz","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用mimikatz抓取系统用户哈希或明文密码的行为，进程名为%(pname)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"mimikatz是一款黑客工具，用来抓取系统用户哈希或明文密码"}],"score":9,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1119","name":"自动收集"},{"uuid":"T1005","name":"本地系统数据"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:58:11Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (mimikatz.exe,mimilove.exe)"},"group_id":""},{"uuid":"299982922144124792","rule_name":"利用Rundll32导出系统进程内存","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用Rundll32导出lsass进程内存获取访问凭证的行为，命令行为%(cmd)","handle_desc":"杀死恶意进程，通过其他告警和日志排查入侵来源","action_desc":"攻击者会利用Rundll32进程恶意导出lsass进程内存获取访问凭证"}],"score":10,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1005","name":"本地系统数据"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:57:49Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname = rundll32.exe and process_create.cmd matches \"rundll32.*?comsvcs.*?(?:MiniDumpW?|#24)\\s+\\d{3}\\s+.*?\\s+full\""},"group_id":""}],"total":336}

{"data":[{"uuid":"299982922144124763","rule_name":"procdump_rename_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现恶意使用程序Dump lsass.exe进程内存","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"Sysinternals工具ProcDump.exe可能是恶意软件最常使用的工具，通过该工具可以dump lsass.exe进程内存"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:57:13Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"\\-accepteula.*\\-.{0,3}m.*lsass\\.exe.*\""},"group_id":""},{"uuid":"299982922144124731","rule_name":"impacket wmi横向移动","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现通过impacket的wmiexec工具在内网横向移动的行为，命令行为%(cmd)","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"攻击者通过SMB、WMI等Windows远程协议控制远程主机执行命令。"}],"score":10,"tactics":[{"uuid":"TA0008","name":"横向移动"}],"techniques":[{"uuid":"T1021","name":"远程服务"},{"uuid":"T1021.002","name":"SMB/WINDOWS 管理员共享"},{"uuid":"T1570","name":"横向工具传输"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:54:59Z","rule_roles":["1","2"],"rule_details":{"content":"(process_create.ppname in (wmiprvse.exe,explorer.exe) and process_create.pname in (cmd.exe) and process_create.cmd matches \"\\/Q\\s+\\/c\\s.*?1>\\s*\\\\\\\\127\\.0\\.0\\.1\\\\.*?\\\\__.*?\\s+2>&1\") or (process_create.ppname in (services.exe) and process_create.pname in (cmd.exe) and process_create.cmd matches \"\\/C\\s+.*?>.*?\\\\Temp\\\\.*?\\.tmp\\s+2>&1\") or (process_create.ppname in (wmiprvse.exe) and process_create.pname in (powershell.exe) and process_create.cmd matches \"-NoP\\s+-NoL\\s+-sta\\s+-NonI\\s+-W\\s+Hidden\\s+-Exec\\s+Bypass\\s+-Enc\")"},"group_id":""},{"uuid":"299982922144124672","rule_name":"疑似运行矿机进程","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现挖矿进程%(pname)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过抢占系统资源进行恶意挖矿，可能会使正常业务进程无法正常工作。"}],"score":10,"tactics":[{"uuid":"TA0040","name":"影响"}],"techniques":[{"uuid":"T1496","name":"资源劫持"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:53:26Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"--coin=\\s*.menoro|\\/c3pool\\/miner\\.sh|\\/xmrig\\s+--config=|\\/miner.sh\\s+--config=|cc\\s+-o\\s+~\\/bioset|cpu-max-threads-hint.*?donate-level\""},"group_id":""},{"uuid":"299982922144124668","rule_name":"疑似 CVE-2022-0847 漏洞利用","displays":[{"type":"default_source","alarm_type":"QTAL-004","alarm_name":"本地提权","alarm_title":"发现CVE-2022-0847漏洞利用命令%(cmd)","handle_desc":"停止并删除相关的恶意进程文件，及时对漏洞进行修补。","action_desc":"当攻击者获取到系统的初始访问权限时的进程执行用户可能并非root，通过利用系统内核或软件中存在的特权提升漏洞可以获取到系统的最高访问权限。"}],"score":10,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1068","name":"特权提升漏洞"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:53:19Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (sh,bash) and process_create.cmd matches \"(bash|sh)\\s+-c\\s+'\\(echo\\s+\\S+;\\s*cat\\)\\s*|\\s*su\\s+-\\s+-c\\s+\\\".*?cp\\s+\\/tmp\\/passwd.bak\\s+\\/etc\\/passwd;.*?(bash|sh).*?\\s+root'\""},"group_id":""},{"uuid":"299982922144124710","rule_name":"cat重定向远程文件下载执行","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现cat重定向远程下载并执行恶意文件","handle_desc":"删除有关恶意文件结束相关进程","action_desc":"攻击者通过rce漏洞拿到容器权限，使用cat重定向远程下载恶意文件对容器进行攻击"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059.004","name":"UNIX SHELL"},{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:53:05Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"(cat\\s*<\\s*\\/dev\\/tcp\\/((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\/\\d+\\s*\\>.+(&&|;|\\|\\|)\\s*chmod\\s+(a|u|g|o)?\\+x\\s+.+)\""},"group_id":""},{"uuid":"299982922144124701","rule_name":"sudo提权漏洞利用","displays":[{"type":"default_source","alarm_type":"QTAL-004","alarm_name":"本地提权","alarm_title":"发现sudo提权漏洞利用命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限，及时修补漏洞。","action_desc":"攻击者可以通过系统内核或软件的特权提升漏洞将较低的初始访问权限提升到系统最高权限，从而能够完全控制目标系统。"}],"score":10,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1068","name":"特权提升漏洞"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:52:27Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (sudo) and process_create.cmd matches \"sudo\\s*-u#-?\\d+\\s+.*\""},"group_id":""},{"uuid":"299982922144124636","rule_name":"Linux添加uid为0的账户","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现添加管理员用户的异常操作","handle_desc":"删除恶意后门账户，通过系统日志或其他告警排查攻击者的入侵途径。","action_desc":"攻击者通过在系统中添加uid为0的管理员后门账户来进行权限维持。"}],"score":9,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1136","name":"创建账户"},{"uuid":"T1136.001","name":"本地账户"}],"platforms":[11,31,21],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:52:03Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (useradd) and process_create.cmd matches \"useradd.*\\-u\\s+0.*\""},"group_id":""},{"uuid":"299982922144124699","rule_name":"rename_shell_reverse","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现反弹shell命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者可以通过系统shell程序执行反弹shell操作，执行后攻击者可以远程控制该系统，有时攻击者会重命名系统程序以逃避防御。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"},{"uuid":"T1036.003","name":"重命名系统程序"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:51:56Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"\\-[a-zA-Z]{0,5}i\\s+\\>\\&\\s+\\/dev\\/(tcp|udp)\\/[\\w\\.]+\\/[\\s\\d]+(\\<|\\>)\\&\""},"group_id":""},{"uuid":"299982922144124615","rule_name":"使用arp欺骗工具","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用arp欺骗工具%(pname)","handle_desc":"删除恶意文件并停止恶意进程，结合其他告警或日志排查攻击者的入侵途径，及时修补漏洞。","action_desc":"攻击者通过在两个或多个设备之间使用中间人攻击技术来收集信息或窃取凭证。"}],"score":9,"tactics":[{"uuid":"TA0006","name":"凭证访问"},{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1557","name":"中间人攻击"},{"uuid":"T1557.002","name":"ARP 缓存投毒"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:51:49Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (arpspoof,arpsniffer,ettercap,dsniff,bettercap,netdiscover)"},"group_id":""},{"uuid":"299982922144124790","rule_name":"利用mimikatz工具","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似利用利用mimikatz工具","handle_desc":"杀死恶意进程，排查工具来源","action_desc":"通过mimikatz可以提升进程权限注入进程读取进程内存"}],"score":10,"tactics":[{"uuid":"TA0009","name":"收集"}],"techniques":[{"uuid":"T1119","name":"自动收集"},{"uuid":"T1005","name":"本地系统数据"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:51:21Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"lsadump::lsa|lsadump::dcsync|sekurlsa::logonpasswords|privilege::debug|kerberos::list|kerberos::purge|sekurlsa::kerberos|sekurlsa::tickets|kerberos::golden|kerberos::ptt|lsadump::sam|misc::memssp|misc::skeleton|misc::cmd|misc::regedit|misc::taskmgr|sekurlsa::pth\""},"group_id":""},{"uuid":"299982922144124703","rule_name":"ua_parser_js","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现安装被投毒的npm模块%(cmd)","handle_desc":"卸载被投毒的模块依赖，检查当前系统中是否存在其他异常进程或文件。","action_desc":"攻击者对软件的依赖包进行供应链投毒，利用软件更新、分发机制入侵受害者系统。"}],"score":10,"tactics":[{"uuid":"TA0001","name":"初始访问"}],"techniques":[{"uuid":"T1195","name":"供应链攻击"},{"uuid":"T1195.002","name":"软件供应链投毒"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:51:11Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (npm,npm.exe) and process_create.cmd matches \"npm(\\.exe)?\\s+install\\s+.*?ua-parser-js@(?:0\\.7\\.29|0\\.8\\.0|1\\.0\\.0)\""},"group_id":""},{"uuid":"299982922144124704","rule_name":"AntSword执行命令","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现利用蚁剑工具执行命令%(cmd)","handle_desc":"排查并删除恶意的webshell文件，杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"蚁剑是一个webshell管理工具，攻击者可以上传webshell到系统上维持权限，并通过蚁剑工具连接webshell远程控制该系统。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"},{"uuid":"T1505","name":"服务器软件组件"},{"uuid":"T1505.003","name":"WEB SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:50:51Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (sh) and process_create.cmd matches \"cd\\s+.*?;.*?;echo\\s+([0-9a-f]{5,13}|\\[S\\]);pwd;echo\\s+([0-9a-f]{5,13}|\\[E\\])\""},"group_id":""},{"uuid":"299982922144124789","rule_name":"利用icmpdoor反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似利用icmpdoor工具进行反弹shell","handle_desc":"杀死进程，并结合其他告警和日志排查溯源。","action_desc":"攻击者通常使用反弹shell控制被害者机器，并进行后续的内网渗透"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"},{"uuid":"T1059.006","name":"PYTHON"}],"platforms":[12,11,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:49:56Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"(?:icmpdoor|icmp-cnc)(?:\\.py|\\.exe)?\\s+(?:-i\\s+\\S+\\s+)?-d\\s+(?:(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(?:\\.(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})\""},"group_id":""},{"uuid":"299982922144124702","rule_name":"telnet双端口反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"疑似执行反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会利用系统自带的命令执行反弹shell来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:41:09Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"-c\\s+.(telnet|nc|ncat|netcat|nc.traditional)\\s+.*?\\s+\\d{1,5}\\s*\\|[^|]+\\|\\s*(telnet|nc|ncat|netcat|nc.traditional)\\s+.*?\\s+\\d{1,5}\""},"group_id":""},{"uuid":"299982922144124771","rule_name":"wmic_rexec","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现wmic执行远程xsl文件，进程命令行为%(cmd)","handle_desc":"关闭进程，删除文件，进行入侵排查等后续操作","action_desc":"攻击者通过wmic执行远程xsl文件进行恶意行为操作"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1204.002","name":"恶意文件"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:38:10Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (cmd.exe) and process_create.cmd matches \"wmic\\s+os\\s+get\\s+\\/format:['\\\"]https?:\\/\\/.*?xsl\""},"group_id":""},{"uuid":"299982922144124705","rule_name":"ssh实现端口转发","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现ssh端口转发命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过系统自带的ssh命令可以实现端口转发，对后续的横向移动、发现、收集、数据窃取等操作做数据传输通道。"}],"score":9,"tactics":[{"uuid":"TA0008","name":"横向移动"}],"techniques":[{"uuid":"T1021","name":"远程服务"},{"uuid":"T1021.004","name":"SSH"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T07:34:17Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ssh) and process_create.cmd matches \"ssh.*(?:\\-[fgN]*(L|R)[fgN]*[\\d\\s]*:.+:\\d{1,5}.*\\..*|\\-fCN[RL]\\s+[^:]+:\\d+:[^:]+:\\d+\\s+)\""},"group_id":""},{"uuid":"299982922144124686","rule_name":"msf_telnet_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:37:58Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (bash,sh,dash,zsh,ksh,csh,tcsh,tclsh) and process_create.cmd matches \"-c\\s+.*?telnet(\\s+-z)?\\s+\\d+\\.\\d+\\.\\d+\\.\\d+\\s+\\d+.*?while.*?(?:ba|z|da|tc|c|k|\\s+|\\/)sh.*?telnet(\\s+-z)?\\s+.*?\\s+\\d+.*?null\""},"group_id":""},{"uuid":"299982922144124670","rule_name":"exec反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:36:31Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (exec) and process_create.cmd matches \"((\\d*<>)|.*(ba|z|da|tc|c|k|)sh\\s+\\d+<)\\s*\\/dev\\/(tcp|upd)\\/(.*)\\/(.*)\""},"group_id":""},{"uuid":"299982922144124680","rule_name":"msf_openssl_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:36:25Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (bash,sh,dash,zsh,ksh,csh,tcsh,tclsh) and process_create.cmd matches \"-c\\s+.*?openssl\\s+s_client.*?-connect\\s+.*?:\\d+.*?while.*?(?:ba|z|da|tc|c|k|\\s+|\\/)sh.*?openssl.*?s_client.*?:\\d+.*?null\""},"group_id":""},{"uuid":"299982922144124674","rule_name":"msf_awk_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:36:10Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (awk,gawk) and process_create.cmd matches \"BEGIN\\s*\\{.*?\\/inet\\/tcp\\/(?:\\d+\\/0\\/0|0\\/\\d+\\.\\d+\\.\\d+\\.\\d+\\/\\d+).*?if.*?getline.*?while.*?getline.*?while.*?exit.*?close\""},"group_id":""},{"uuid":"299982922144124656","rule_name":"whois反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现whois反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:31:03Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (whois) and process_create.cmd matches \"-h\\s+.*-p\\s+\\d+\""},"group_id":""},{"uuid":"299982922144124712","rule_name":"spark漏洞利用","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现通过spark漏洞执行系统命令的行为%(cmd)","handle_desc":"排查父进程是否为spark，版本是否在漏洞影响范围内，如果是，排查spark访问日志溯源，升级spark修复漏洞，排查是否有攻击者留下的其他后门","action_desc":"攻击者通过spark命令注入漏洞CVE-2022-33891执行恶意命令，命令行特征为bash -c id -Gn test;恶意命令"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:28:43Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.ppname contains \"java\" and process_create.pname = \"bash\" and process_create.cmd matches \"-c\\sid\\s-Gn\\s+.*\\s*[|;&`$]+\""},"group_id":""},{"uuid":"299982922144131265","rule_name":"利用系统自带的 DataSvcUtils.exe 程序加载远程恶意文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现通过.NET框架自带的 DataSvcUtils.exe 程序将远程恶意文件加载到本地，进程命令行为%(cmd)","handle_desc":"停止相关进程并删除恶意文件。","action_desc":"攻击者通过系统自带的签名程序可以间接地执行命令或加载恶意文件，攻击者通常使用此项技术逃避防御。"}],"score":9,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1218","name":"利用签名程序代理执行"},{"uuid":"T1127","name":"利用受信任的开发工具代理执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T10:02:48Z","updated_at":"2023-03-14T06:27:20Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (DataSvcUtil.exe) and process_create.cmd matches \"DataSvcUtil(?:\\.exe)?\\s+\\/out:.*?\\s+\\/uri:(\\S+)\""},"group_id":""},{"uuid":"299982922144131263","rule_name":"利用 conhost.exe 代理执行可疑文件","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现通过系统自带程序 conhost.exe 代理执行可疑文件，进程命令行为%(cmd)","handle_desc":"停止相关进程并删除恶意文件。","action_desc":"攻击者通过系统自带的签名程序可以间接地执行命令或加载恶意文件，攻击者通常使用此项技术逃避防御。"}],"score":9,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1218","name":"利用签名程序代理执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T10:02:48Z","updated_at":"2023-03-14T06:27:13Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (conhost.exe) and process_create.cmd matches \"conhost(?:\\.exe)?\\s+([\\w\\s]+\\.exe)\""},"group_id":""},{"uuid":"299982922144124744","rule_name":"Ladon_tool","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现命令行中存在Ladon扫描器的特征%(cmd)","handle_desc":"停止进程，删除工具，进行分析排查入侵路径","action_desc":"Ladon一款用于大型内网渗透的多线程插件化综合扫描神器，含端口扫描、服务识别、网络资产、密码爆破、高危漏洞检测"}],"score":10,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1040","name":"网络嗅探"},{"uuid":"T1046","name":"网络服务扫描"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:25:53Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"\\S+\\s+\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\/24\\s+(OnlinePC|OsScan|OnlineIP|MS17010|SMBGhost|PortScan|WhatCMS|MysqlScan|TomcatScan|TomcatExp)\""},"group_id":""},{"uuid":"442007765741731889","rule_name":"python执行反弹shell_c","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现python反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-01-06T06:32:38Z","updated_at":"2023-03-14T06:25:42Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (python,python2,python3) and process_create.cmd matches \"import.*?socket.*?\\.socket.*?\\.connect.*?while.*?(?:subprocess\\.Popen.*?\\.send|\\.send.*?os\\.popen)\""},"group_id":""},{"uuid":"299982922144124617","rule_name":"python执行反弹shell_b","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现python反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:25:31Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (python,python2,python3) and process_create.cmd matches \"-c.*import\\s+pty.*?\\.spawn\\(.*?\\).*<*\\/dev\\/(tcp|udp)\\/.*?\\/.*\""},"group_id":""},{"uuid":"299982922144124627","rule_name":"lua执行反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现lua反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:25:27Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (lua) and process_create.cmd matches \"-e\\s*[\\'\\|\\\"]?require.*?socket.tcp\\(\\).*?connect.*?os\\.execute\\(.*?\\)\""},"group_id":""},{"uuid":"442007651992207409","rule_name":"php执行反弹shell_b","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现php反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-01-06T06:31:30Z","updated_at":"2023-03-14T06:25:22Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (php) and process_create.cmd matches \"(fsockopen|socket_create).*?while.*?(proc_open\\(|popen\\()\""},"group_id":""},{"uuid":"299982922144124626","rule_name":"php执行反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现php反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:25:17Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (php) and process_create.cmd matches \"-r\\s*[\\'|\\\"]?.*?fsockopen\\(.*?\\);.*?((exec|proc_open|shell_exec|system|popen)\\(.*?\\);|`.*?(bash|sh|dash|tcsh|csh|ksh|zsh))\""},"group_id":""},{"uuid":"442007554332033073","rule_name":"ruby反弹shell_b","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现ruby反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-01-06T06:30:32Z","updated_at":"2023-03-14T06:25:12Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ruby) and process_create.cmd matches \"TCPSocket\\.(new|open).*?while.*?\\.gets.*?\\.popen\""},"group_id":""},{"uuid":"299982922144124633","rule_name":"ruby反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现ruby反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:25:08Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ruby) and process_create.cmd matches \"\\-rsocket\\s+-e\\s*[\\'\\|\\\"]?.*?=TCPSocket\\.((new.*?IO.popen)|(open.*?\\.to_i;exec))\""},"group_id":""},{"uuid":"442007455765889073","rule_name":"perl执行反弹shell_b","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现perl反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-01-06T06:29:33Z","updated_at":"2023-03-14T06:25:03Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (perl) and process_create.cmd matches \"IO::Socket::(SSL|INET).*?fdopen.*?system.*?while<>\""},"group_id":""},{"uuid":"299982922144124628","rule_name":"perl执行反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现perl反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T06:24:57Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (perl) and process_create.cmd matches \"(-MIO\\s+-e\\s*[\\\"\\|\\']?.*?IO::Socket::INET\\(PeerAddr.*?STDIN.*?fdopen.*?system)|(-e\\s*[\\'\\|\\\"]?use\\s+Socket;.*?exec)\""},"group_id":""},{"uuid":"442007317941059633","rule_name":"lua执行反弹shell_b","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现lua反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-01-06T06:28:11Z","updated_at":"2023-03-14T06:24:52Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (lua) and process_create.cmd matches \"require.*?socket.*?connect.*?while.*?receive.*?\\.popen.*?read.*?send\""},"group_id":""},{"uuid":"299982922144124741","rule_name":"for循环ping探测存活主机","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似使用for循环ping探测网段中存活主机","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统权限。","action_desc":"通过cmd.exe使用for循环ping探测网段中存活的主机"}],"score":10,"tactics":[{"uuid":"TA0007","name":"发现"}],"techniques":[{"uuid":"T1040","name":"网络嗅探"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T04:01:55Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname = cmd.exe and process_create.cmd matches \"for\\s+.*?%\\w\\s+in.*?do\\s+@?ping\\s+.*?\\.%\\w.*?\\|.*?\\bfindstr\\b.*?TTL=\""},"group_id":""},{"uuid":"299982922144124678","rule_name":"msf_lua_backdoor_b","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T04:00:30Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"lua.*?\\s+-e\\s+.*?require.*?socket.*?assert.*?connect.*?while\\s+true.*?receive.*?assert.*?read.*?send\""},"group_id":""},{"uuid":"299982922144124748","rule_name":"msf_ruby_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T04:00:05Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ruby.exe) and process_create.cmd matches \"-rsocket\\s+-e\\s+['\\\"]exit\\s+if\\s+fork.*?TCPServer\\.new\\((?:\\\"::\\\",)?\\\"\\d+\\\"\\);while.*?accept.*?while\\(.*?\\.gets\\);IO\\.popen.*?io\\.read.*?end;end\""},"group_id":""},{"uuid":"299982922144124629","rule_name":"php执行shell-stream_socket_client反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现php反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T03:59:59Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (php) and process_create.cmd matches \"-r\\s*[\\\"\\'].*?stream_socket_client\\(.*?STREAM_CLIENT_CONNECT.*?while.*?exec\""},"group_id":""},{"uuid":"299982922144124681","rule_name":"msf_py_stager","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现Metasploit框架生成的木马指令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过Metasploit攻击框架可以生成python代码，执行后攻击者可以在服务端远程控制该服务器。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"},{"uuid":"T1140","name":"解混淆/解码文件或信息"},{"uuid":"T1202","name":"间接执行命令"}],"platforms":[21,12,11,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T03:59:48Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.cmd matches \"python.*?exec\\(__import__\\('base64'\\)\\.b64decode\\(__import__\\('codecs'\\)\\.getencoder\\('utf-8'\\)\\('[a-zA-Z0-9+=\\/]+'\\)\\[0\\]\\)\""},"group_id":""},{"uuid":"299982922144124687","rule_name":"msf_zsh_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T03:59:01Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (zsh) and process_create.cmd matches \"-c\\s+.zmodload\\s+zsh\\/net\\/tcp.*?zsh\\s+>&\\$.*?2>&\\$.*?0>&\\$\""},"group_id":""},{"uuid":"299982922144124761","rule_name":"cve_2021_40444_fishing_attack_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用Microsoft MSHTML远程代码执行漏洞发起钓鱼攻击","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"Microsoft MSHTML远程代码执行漏洞发起钓鱼攻击"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0001","name":"初始访问"}],"techniques":[{"uuid":"T1566","name":"钓鱼"},{"uuid":"T1566.003","name":"通过服务钓鱼"},{"uuid":"T1203","name":"利用客户端漏洞获取执行权限"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T03:58:49Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname[1] in (winword.exe,excel.exe,powerpnt.exe) and process_create.pname in (control.exe) and process_create.cmd matches \"\\.cpl:\\.\\.\""},"group_id":""},{"uuid":"299982922144124759","rule_name":"cve_2021_40444_fishing_attack_b","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用Microsoft MSHTML远程代码执行漏洞发起钓鱼攻击","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"利用Microsoft MSHTML远程代码执行漏洞发起钓鱼攻击"}],"score":10,"tactics":[{"uuid":"TA0001","name":"初始访问"},{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1566","name":"钓鱼"},{"uuid":"T1566.003","name":"通过服务钓鱼"},{"uuid":"T1203","name":"利用客户端漏洞获取执行权限"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T03:58:15Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"Control_RunDLL.*?inf\""},"group_id":""},{"uuid":"299982922144124685","rule_name":"msf_tclsh_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T03:57:47Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (bash,sh,dash,zsh,ksh,csh,tcsh,tclsh) and process_create.cmd matches \"set\\s+.*?socket\\s+\\d+\\.\\d+\\.\\d+\\.\\d+\\s+\\d+\\].*?set.*?while.*?exit.*?flush.*?gets.*?exec.*?catch.*?eval.*?puts.*?flush.*?close\""},"group_id":""},{"uuid":"299982922144124684","rule_name":"msf_r_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[21,12,11,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T03:57:23Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (R) and process_create.cmd matches \"-e\\s+.s<-socketConnection\\((?:host=.*?,)?port=\\d+.*?server=(?:TRUE|FALSE).*?while\\(TRUE\\)\\{writeLines\\(readLines\\(pipe\\(readLines\""},"group_id":""},{"uuid":"299982922144124682","rule_name":"msf_ruby_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T03:57:12Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ruby) and process_create.cmd matches \"-rsocket\\s+-e\\s+.exit\\s+if\\s+fork.*?TCPServer\\.new\\((?:.::.,)?.\\d+.\\);while.*?accept.*?while\\(.*?\\.gets\\);IO\\.popen.*?io\\.read.*?end;end\""},"group_id":""},{"uuid":"299982922144124683","rule_name":"msf_ruby_pingback_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[21,11,12,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T03:56:59Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (ruby,ruby.exe) and process_create.cmd matches \"require'socket';s=TCPServer\\.new\\(\\d+\\);c=s\\.accept;s\\.close;c\\.puts'[a-zA-Z0-9+=\\/]+'\\.unpack\\('m0'\\);\""},"group_id":""},{"uuid":"299982922144124796","rule_name":"powershell反弹shell_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现powershell反弹shell(%cmd)","handle_desc":"排查攻击来源，确认反弹ip是否恶意","action_desc":"发现powershell反弹shell"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059.001","name":"POWERSHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T03:56:12Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (powershell.exe) and process_create.cmd matches \"[nN][eE][wW]\\-[oO][bB][jJ][eE][cC][tT].*[sS][oO][cC][kK][eE][tT][sS]\\.[tT][cC][pP][cC][lL][iI][eE][nN][tT]\""},"group_id":""},{"uuid":"299982922144124781","rule_name":"使用Rundll32执行恶意JS代码","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用Rundll32执行恶意JS代码","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的权限。","action_desc":"攻击者通过Rundll32调用系统自带的DLL实现命令执行以逃避防御。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1055.001","name":"DLL 注入"},{"uuid":"T1202","name":"间接执行命令"},{"uuid":"T1218.011","name":"RUNDLL32"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T02:48:53Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (rundll32.exe) and process_create.cmd matches \"rundll32.*?javascript.*?mshtml.*?(?:RunHTMLApplication|#135\\s+).*?WScript\\.Shell.*?\\.run\\(.*?close\""},"group_id":""},{"uuid":"299982922144124760","rule_name":"Powershell_reshell","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现powershell反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059.001","name":"POWERSHELL"},{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T02:48:44Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (powershell.exe) and process_create.cmd matches \"[Nn][Ee][Ww]\\-[Oo][Bb][Jj][Ee][Cc][Tt]\\s*([Ss][Yy][Ss][Tt][Ee][Mm]\\.)[Nn][Ee][Tt]\\.[Ss][Oo][Cc][Kk][Ee][Tt][Ss]\\.[Tt][Cc][Pp][Cc][Ll][Ii][Ee][Nn][Tt]\\(\\s*['\\\"].*?,\\w+.*?[Gg][Ee][Tt][Ss][Tt][Rr][Ee][Aa][Mm]\\s*\\(.*?[Ww][Hh][Ii][Ll][Ee].*?[Rr][Ee][Aa][Dd]\\(.*?[Ww][Rr][Ii][Tt][Ee]\\s*\\(.*?[Cc][Ll][Oo][Ss][Ee]\\(\""},"group_id":""}],"total":336}

{"data":[{"uuid":"299982922144124815","rule_name":"使用黑客工具rubeus","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用疑似rubeus黑客工具进行域渗透测试","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"rubeus是一款黑客工具，用来做域渗透测试"}],"score":9,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1558.003","name":"KERBEROASTING"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T02:46:04Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (rubeus.exe) and process_create.cmd matches \"(asktgt|renew|ptt|purge|describe|createnetonly|kerberoast|asreproast|dump|monitor|harvest).*\""},"group_id":""},{"uuid":"299982922144124832","rule_name":"使用nc执行反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"使用nc执行反弹shell,疑似恶意","handle_desc":"排查攻击来源，确认反弹ip及行为是否恶意，关闭恶意进程并删除恶意文件。","action_desc":"使用nc执行反弹shell"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T02:44:21Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (nc.exe,nc64.exe) and process_create.cmd matches \"\\-[eE].*([cC][mM][dD]|[pP][oO][wW][eE][rR][sS][hH][eE][lL][lL]).*\""},"group_id":""},{"uuid":"299982922144131262","rule_name":"利用 control.exe 加载隐藏在 ADS 中的恶意 DLL","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现通过系统自带的控制面板程序 control.exe 加载隐藏DLL 文件，进程命令行为%(cmd)。","handle_desc":"停止相关进程并删除恶意 DLL 文件。","action_desc":"攻击者通过系统自带的签名程序可以间接地执行命令或加载恶意文件，攻击者通常使用此项技术逃避防御。"}],"score":8,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1218","name":"利用签名程序代理执行"},{"uuid":"T1218.002","name":"控制面板"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T10:02:48Z","updated_at":"2023-03-14T02:29:03Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (control.exe) and process_create.cmd matches \"control(?:\\.exe)?\\s+(\\w:\\\\.*?\\.\\w+:\\w+\\.\\w+)\""},"group_id":""},{"uuid":"299982922144124807","rule_name":"疑似CVE-2022-30190漏洞利用","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似CVE-2022-30190漏洞利用","handle_desc":"通过更新或者官方公布的漏洞处理手册进行修复，并排查攻击者操作。","action_desc":"CVE-2022-30190是微软支持诊断工具MSDT的远程代码执行漏洞，可以通过msdt.exe执行任意代码。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T02:26:48Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname = msdt.exe and process_create.cmd matches \"ms-msdt:\\/id.*?IT_BrowseForFile.*?(\\.\\.\\/)+.*?mpsigstub\\.exe\""},"group_id":""},{"uuid":"299982922144124772","rule_name":"使用 netsh 配置端口转发","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用 netsh 配置端口转发的可疑行为，进程命令行为%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过netsh.exe可以实现端口转发，对后续的横向移动、发现、收集、数据窃取等操作做数据传输通道。"}],"score":9,"tactics":[{"uuid":"TA0008","name":"横向移动"}],"techniques":[{"uuid":"T1021","name":"远程服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T02:20:59Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (netsh.exe,netsh) and process_create.cmd matches \"\\binterface\\b.*\\bportproxy\\b.*\\badd\\b\""},"group_id":""},{"uuid":"299982922144124619","rule_name":"awk反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现awk反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,21,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T02:19:43Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (awk,gawk) and process_create.cmd matches \"BEGIN\\s*\\{.*?\\/inet\\/tcp\\/.*?(for|while).*?getline.*?while.*?getline\""},"group_id":""},{"uuid":"299982922144124778","rule_name":"使用fscan内网扫描工具","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用fscan内网扫描工具的命令","handle_desc":"杀死进程，排查入侵痕迹","action_desc":"攻击者使用fscan作为内网综合扫描工具,方便一键自动化、全方位漏洞扫描。"}],"score":10,"tactics":[{"uuid":"TA0043","name":"侦查"}],"techniques":[{"uuid":"T1595.002","name":"漏洞扫描"}],"platforms":[12,11,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-03-14T02:19:34Z","rule_roles":["1","2"],"rule_details":{"content":"process_create.pname in (SharpRDP.exe) and process_create.cmd matches \"(?:^\\S*\\bfscan(?:_\\S+|\\d+)?(?:\\.exe)?\\b)|(-h\\s+(?:(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(?:\\.(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})\\/\\d+\\s+(?:-m\\s+(?:ssh|smb|ms17010(?:-exp)?|icmp|netbios|all|fcgiscan|mssql|mysql|redis|rdp|webtitle|scanner|CVE-2020-0796|wmiexec)|-rf\\s+\\S+\\.pub|(?:-rs|-socks5)\\s+\\d+(?:\\.\\d+){3}:\\d+|[\\s\\.\\w-]*?(?:-nopoc|-pwdf\\s+|-c\\s+(?:whoami|id)|(?:-np\\s+|-no\\s+){2}[\\s\\.\\w-]*?-p\\s+\\d+)))\""},"group_id":""},{"uuid":"449861005783072813","rule_name":"调用IColorDataProxy接口BypassUAC(DccwCOM)","displays":[{"type":"default_source","alarm_type":"QTAL-035","alarm_name":"BypassUAC","alarm_title":"发现攻击者通过调用IColorDataProxy接口绕过UAC执行恶意命令%(cmd)","handle_desc":"停止恶意进程，删除恶意文件。","action_desc":"攻击者利用系统白名单程序或COM接口绕过UAC之后可获取到完整的管理员权限。"}],"score":8,"tactics":[{"uuid":"TA0004","name":"权限提升"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1548","name":"滥用权限控制机制"},{"uuid":"T1548.002","name":"绕过用户账户控制"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-01T10:47:34Z","updated_at":"2023-03-01T10:53:59Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd matches \"DllHost\\.exe\\s+.*?\\/Processid:\\{D2E7041B-2927-42FB-8E9F-7CE93B6DC937\\}\" and process_create.pname in (rundll32.exe, powershell.exe, cmd.exe, mshta.exe, regsvr32.exe, hh.exe) and process_create.integrity_level in (High, System)"},"group_id":""},{"uuid":"449703983221571633","rule_name":"调用ICMLuaUtil接口BypassUAC(ICMLuaUtilShellExec)","displays":[{"type":"default_source","alarm_type":"QTAL-035","alarm_name":"BypassUAC","alarm_title":"发现攻击者通过调用ICMLuaUtil接口绕过UAC执行恶意命令%(cmd)","handle_desc":"停止恶意进程，删除恶意文件。","action_desc":"攻击者利用系统白名单程序或COM接口绕过UAC之后可获取到完整的管理员权限。"}],"score":8,"tactics":[{"uuid":"TA0004","name":"权限提升"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1548","name":"滥用权限控制机制"},{"uuid":"T1548.002","name":"绕过用户账户控制"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-02-28T08:47:41Z","updated_at":"2023-03-01T10:53:49Z","rule_roles":["1"],"rule_details":{"content":"process_create.acmd matches \"DllHost\\.exe\\s+.*?\\/Processid:\\{3E5FC7F9-9A51-4367-9063-A120244FBEC7\\}\" and process_create.pname in (rundll32.exe, powershell.exe, cmd.exe, mshta.exe, regsvr32.exe, hh.exe) and process_create.integrity_level in (High, System)"},"group_id":""},{"uuid":"299982922144124649","rule_name":"容器内执行系统管理命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现容器内执行管理命令%(cmd)","handle_desc":"删除恶意文件并停止恶意进程，通过日志排查确定攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者在容器内执行管理命令，可以获取到容器的各种敏感信息以及操作或查看系统配置。"}],"score":4,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1609","name":"容器管理命令"}],"platforms":[11,21,31],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-02-20T08:17:14Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (man,uptime,users,service,pkill,pmap,wget,ftp,free,top,last,ps,shutdown,info,env,netstat,arp,df,du,init,nano,nslookup,shred,cat,pwd,locate,chown,alias,echo,cmp,mount,ifconfig,traceroute,sudo,route,ping,find,who,tar,grep,su,awk,useradd,adduser,chattr,arp,passwd,base64,nc,netcat,curl,id,whoami,busybox,setenforce,getenforce,htop,kill,ss,ip,systemctl,iptables,ufw,mount,unmount,touch,tree,fdisk,visudo,crontab,unzip,ncat,python,ruby,ssh,scp,ln,docker,kubeclt,redis-cli,mknod,telnet,socat) or process_create.cmd matches \"busybox|docker|kubectl|systemctl|services|iptables|ufw\\s+|ping|ipconfig|ifconfig|ssh\\s+|which\\s+|awk\\s+|netcat|nc\\s+|ncat\\s+\""},"group_id":""},{"uuid":"299982922144124831","rule_name":"disable_firewall","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用 netsh 关闭防火墙的可疑命令行%(cmd)","handle_desc":"杀死进程，根据其他告警或日志进行排查入侵痕迹","action_desc":"攻击者会使用netsh命令关闭防火墙以进行更深入的渗透"}],"score":9,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1562.004","name":"禁用或修改系统防火墙"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-02-20T07:51:23Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname = netsh.exe and process_create.cmd pmatch(\"\\s+advfirewall\\s+set\\s+.*profile.*\\s+state\\s+off\",\"netsh\\s+firewall\\s+set\\s+opmode\\s+mode=disable\",\"stop\\s+.*mpssvc\")"},"group_id":""},{"uuid":"299982922144124769","rule_name":"wevtutil_del_history","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用wevtutil清除 Windows 事件日志的可疑行为，命令行为%(cmd)","handle_desc":"通过云端记录的windows审计日志排查攻击者执行的操作。","action_desc":"攻击者通过清理Windows 事件日志历史记录来逃避防御。"}],"score":8,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1070.001","name":"清除 WINDOWS 事件日志"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-02-20T06:58:40Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (wevtutil.exe) and process_create.cmd matches \"\\bcl\\b\""},"group_id":""},{"uuid":"299982922144124737","rule_name":"使用net命令增加管理员用户","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现使用net命令在管理员用户组中增加用户的行为，命令行为%(cmd)","handle_desc":"停止进程，进行相关排查，删除恶意文件","action_desc":"使用net命令在本地添加管理员用户，或在域控用户组domain admins中添加域管理员用户"}],"score":9,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1136","name":"创建账户"},{"uuid":"T1136.002","name":"域账户"},{"uuid":"T1136.001","name":"本地账户"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-02-20T06:46:09Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname = net.exe and process_create.cmd pmatch (\"group\\s['\\\"]domain\\s+admins['\\\"].*?\\/add\",\"localgroup\\s+administrators.*\\/add\")"},"group_id":""},{"uuid":"299982922144124733","rule_name":"powershell执行远程下载命令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现利用powershell远程下载脚本并执行的行为，命令行为%(cmd)","handle_desc":"停止恶意进程，删除恶意文件。","action_desc":"攻击者可以通过系统自带的powershell远程下载脚本执行恶意代码。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.001","name":"POWERSHELL"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-02-20T06:44:12Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (powershell.exe,cmd.exe) and process_create.cmd pmatch (\"\\-[eE][xX][eE][cC].*[bB][yY][pP][aA][sS][sS].*\\s+['\\\"]?\\\\\\\\(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\\\\\S+\\.[pP][sS]1['\\\"]?$\", \"([iI][nN][vV][oO][kK][eE]\\-[wW][eE][bB][rR][eE][qQ][uU][eE][sS][tT]|[iI][wW][rR]).*(([hH][tT][tT][pP][sS]?\\:\\/\\/)|(\\\\\\\\))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\.[^;&]*?([c-fC-F]:(\\\\\\w+)+?|-OutFile\\s+)\", \"(([iI][eE][xX]\\s*\\([iI][wW][rR]\\s*https?:\\/\\/)|(https?:\\/\\/.*[iI][eE][xX]\\s*\\([iI][wW][rR])).*\", \"(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost|[\\w\\-\\.\\/]*agent\\/winDownloader\\?k=|[\\w\\-\\.\\/\\:]*TitanAgent\\_for\\_All).*[nN][eE][wW]\\-[oO][bB][jJ][eE][cC][tT].*[dD][oO][wW][nN][lL][oO][aA][dD].*\", \"[nN][eE][wW]\\-[oO][bB][jJ][eE][cC][tT].*[dD][oO][wW][nN][lL][oO][aA][dD].*(([hH][tT][tT][pP]\\:\\/\\/)|([hH][tT][tT][pP][sS]\\:\\/\\/))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost|[\\w\\-\\.\\/]*agent\\/winDownloader\\?k=|[\\w\\-\\.\\/\\:]*TitanAgent\\_for\\_All).*\",\"[iI][eE][xX]\\s*\\([nN][eE][wW]\\-[oO][bB][jJ][eE][cC][tT]\\s+([sS][yY][sS][tT][eE][mM]\\.)?[nN][eE][tT]\\.[wW][eE][bB][cC][lL][iI][eE][nN][tT]\\)\\.[dD][oO][wW][nN][lL][oO][aA][dD][Ss][tT][rR][iI][nN][gG]\",\"IEX\\(-join\\[.*?\\[\\]\\]\\$.\\)\")"},"group_id":""},{"uuid":"299982922144124717","rule_name":"本地敏感文件上传至外网","displays":[{"type":"default_source","alarm_type":"QTAL-011","alarm_name":"Web命令执行","alarm_title":"发现通过curl命令将服务器敏感文件发送到外网的行为，命令行为%(cmd)","handle_desc":"停止恶意进程，删除恶意文件，排查WEB访问日志确定攻击者入侵途径，及时修补漏洞。","action_desc":"攻击者通过WEB服务漏洞获取系统初始访问权限，并执行数据窃取、添加后门等恶意命令。"}],"score":9,"tactics":[{"uuid":"TA0001","name":"初始访问"},{"uuid":"TA0002","name":"执行"},{"uuid":"TA0010","name":"窃取"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"},{"uuid":"T1190","name":"利用互联网上应用程序的缺陷"},{"uuid":"T1567","name":"使用 WEB 服务窃取"}],"platforms":[21,11,31],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-02-20T06:40:51Z","rule_roles":["1"],"rule_details":{"content":"process_create.apname in (java,apache,apache2,httpd,php-fpm) and process_create.pname in (curl,sh,bash) and process_create.cmd matches \"curl\\s+-X\\s+POST\\s+-F\\s+\\w+=@(?:\\/etc\\/(?:passwd|shadow)|\\/root\\/\\.ssh\\/(?:id_rsa|authorized_keys))\\s+http(?:s)?:\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost|(?:[\\w\\-]*\\.)*(?:byted\\.org|bytedance\\.net)|(?:[\\w\\-]*\\.)*google\\.com)\\S+$\""},"group_id":""},{"uuid":"299982922144124840","rule_name":"读取系统敏感文件","displays":[{"type":"default_source","alarm_type":"QTAL-009","alarm_name":"凭证窃取","alarm_title":"发现进程%(pname)读取密码文件/etc/passwd","handle_desc":"停止相关进程并进行溯源。","action_desc":"攻击者可以通过读取/etc/passwd或者/etc/shadow获取密码hash，再通过hash碰撞获取明文密码"}],"score":4,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1552.001","name":"文件中的凭证"}],"platforms":[12,21,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:42Z","updated_at":"2023-02-20T03:20:57Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (cat,head,tail,tac,less,more,vi,vim,nano,getent,vipw,vigr) and process_create.cmd matches \"((\\/etc\\/passwd)|(\\/etc\\/shadow))\""},"group_id":""},{"uuid":"299982922144124655","rule_name":"数据库服务操作敏感文件","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现数据库应用查看系统敏感文件的可疑命令%(cmd)","handle_desc":"结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"通过导出/etc/passwd和/etc/shadow的文件内容，攻击者可以进行离线密码破解，攻击者也可以在bash历史记录文件或数据库历史记录文件中发现用户输入的明文密码。"}],"score":8,"tactics":[{"uuid":"TA0007","name":"发现"},{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1003","name":"系统凭证转储"},{"uuid":"T1003.008","name":"/etc/passwd&amp;shadow"},{"uuid":"T1552","name":"不安全的凭证"},{"uuid":"T1552.001","name":"文件中的凭证"},{"uuid":"T1552.003","name":"BASH 历史记录"},{"uuid":"T1552.004","name":"私钥"},{"uuid":"T1087","name":"账户发现"},{"uuid":"T1087.001","name":"本地账户"}],"platforms":[11,31,21],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-01-09T02:53:12Z","rule_roles":["1"],"rule_details":{"content":"process_create.ppname in (postgres,redis-server) and process_create.cmd matches \"(cat|head|tail|tac|less|more|vi|vim|nano|getent|vipw|vigr)\\s+|echo[^>]*?[>]{1,2}\\s*((\\/etc\\/passwd)|(\\/etc\\/shadow)|(\\/etc\\/hostname)|(.*bash_history)|(\\/etc\\/group)|(\\/etc\\/sudoers)|(.*mysql_history)|(~\\/id_rsa)|(~\\/authorized_keys))\""},"group_id":""},{"uuid":"299982922144124666","rule_name":"容器内执行sudo命令(存在提权逃逸风险)","displays":[{"type":"default_source","alarm_type":"QTAL-004","alarm_name":"本地提权","alarm_title":"发现使用sudo的异常行为","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者可能会使用sudo提升权限或使用其他用户身份执行命令。"}],"score":9,"tactics":[{"uuid":"TA0004","name":"权限提升"}],"techniques":[{"uuid":"T1548","name":"滥用权限控制机制"},{"uuid":"T1548.003","name":"SUDO 和 SUDO 缓存"}],"platforms":[11,21,31],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-01-09T02:52:55Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (sudo)"},"group_id":""},{"uuid":"299982922144124664","rule_name":"容器删除大量数据","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现删除大量数据操作%(cmd)","handle_desc":"通过数据备份恢复被删除数据，通过日志排查并确定攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过删除系统中的大量数据，可造成系统或软件服务无法正常运行。"}],"score":9,"tactics":[{"uuid":"TA0040","name":"影响"}],"techniques":[{"uuid":"T1485","name":"数据销毁"}],"platforms":[11,21,31],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:35Z","updated_at":"2023-01-09T02:52:43Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (rm) and process_create.cmd matches \"(\\/opt|\\/tmp)\""},"group_id":""},{"uuid":"299982922144124841","rule_name":"Dump系统Hash","displays":[{"type":"default_source","alarm_type":"QTAL-009","alarm_name":"凭证窃取","alarm_title":"发现进程%(pname)尝试获取明文密码","handle_desc":"停止相关进程并删除恶意文件。","action_desc":"通过mimikatz的lsadump功能尝试从注册表导出结果中获取系统明文密码。"}],"score":10,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1003.001","name":"LSASS 内存"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:42Z","updated_at":"2022-12-02T08:17:28Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"lsadump::sam\\s+\\/sam:.{1,20}\\s+\\/system:\""},"group_id":""},{"uuid":"299982922144124839","rule_name":"读取mysql哈希","displays":[{"type":"default_source","alarm_type":"QTAL-009","alarm_name":"凭证窃取","alarm_title":"发现进程%(pname)读取mysql密码文件user.MYD中的Hash","handle_desc":"停止相关进程并进行溯源。","action_desc":"user.MYD中存储了mysql的密码hash，读取hash后可以通过hash碰撞得到明文密码"}],"score":9,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1552.001","name":"文件中的凭证"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:42Z","updated_at":"2022-12-01T11:00:40Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname = grep and process_create.cmd contains \"mysql/user.MYD\""},"group_id":""},{"uuid":"299982922144124616","rule_name":"远程下载文件并执行","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现远程下载文件并执行的恶意命令%(cmd)","handle_desc":"删除恶意文件并杀死恶意进程，通过日志排查确定攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者可以通过curl或wget下载远程文件并通过管道传递给bash执行，或下载到磁盘后使用chmod命令添加可执行权限后执行。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"(curl|wget).{1,15}\\/\\/(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost|(?:[\\w\\-]*\\.)*byted\\.org\\b|(?:[\\w\\-]*\\.)*google\\.com\\b).*?(&&|;).*?chmod[^&;]+(&&|;)[^&;]+((&&|;)\\s*(rm|curl)\\b|$)\""},"group_id":""},{"uuid":"299982922144124620","rule_name":"python执行反弹shell","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现python反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (python,python2,python3) and process_create.cmd matches \"import.*?socket.*?socket\\(.*?\\).*?connect\\(.*?\\).*?((Popen\\(.*?PIPE.*?\\))|(os\\.dup2.*?(call|pty\\.spawn)\\())\""},"group_id":""},{"uuid":"299982922144124640","rule_name":"python 恶意命令执行_c","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现利用python反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (python,python2,python3) and process_create.cmd matches \"python.*(https?:\\/\\/|socket\\.socket\\().*(os\\.(system|popen|exec.{0,3}|dup2)|subprocess\\.(PIPE|Popen|run|call|check_all|check_output|getoutput|getstatusoutput)|commands\\.getoutput|commands\\.getstatusoutput).*\""},"group_id":""},{"uuid":"299982922144124644","rule_name":"执行异常base64编码指令","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现异常执行base64编码指令","handle_desc":"删除恶意文件并停止恶意进程，通过日志排查确定攻击者的入侵痕迹。","action_desc":"攻击者通过使用base64编码将恶意代码加密，以此逃避防御，在受害者系统中利用系统命令解码还原并执行恶意代码。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1027","name":"混淆的文件或信息"},{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (bash,sh,dash,tcsh,csh,ksh,tclsh,echo) and process_create.cmd matches \"echo.*\\|[\\s\\{]*base64[\\s,]*\\-d[\\s}]*\\|.{1,10}(bash|dash|sh|tcsh|csh|ksh|tclsh)\""},"group_id":""},{"uuid":"299982922144124663","rule_name":"磁盘删除文件数据","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现可疑的删除磁盘文件数据操作%(cmd)","handle_desc":"通过数据备份恢复被删除数据，通过日志排查并确定攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过删除磁盘中的重要文件数据，可造成系统或软件服务无法正常运行。"}],"score":8,"tactics":[{"uuid":"TA0040","name":"影响"}],"techniques":[{"uuid":"T1561","name":"磁盘擦除"},{"uuid":"T1561.001","name":"磁盘内容擦除"}],"platforms":[11,12,21,31,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (shred,mkfs,mke2fs)"},"group_id":""},{"uuid":"299982922144124669","rule_name":"安装恶意的python模块","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现安装恶意python模块的可疑行为","handle_desc":"通过资产清点排查恶意模块是否已经成功安装到了系统上，如果已经安装需立即删除该恶意模块，并结合其他相关告警进行溯源排查。","action_desc":"恶意模块名通常和常用的python模块名极其相似，可能仅有一个字母的差别，执行恶意python模块的安装操作后，系统将自动执行攻击者托管在远端的恶意代码，生成系统的初始访问权限。"}],"score":9,"tactics":[{"uuid":"TA0001","name":"初始访问"}],"techniques":[{"uuid":"T1195","name":"供应链攻击"},{"uuid":"T1195.001","name":"软件依赖和开发工具投毒"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (pip) and process_create.cmd matches \"pip\\d?(?:.exe)?\\s+install\\s+.*?(?:venom22|Asqwed|emilrocks|kckdpjdkleinjncanh|tlnvxkmvepwftirvjc|zerbaxwdzxpztvucdf3|aqswdefrgt|hellonati|qpxtqpkdlzcskofmpe|zerbaxwdzxpztvucdf|danarules|ixkydxhatdkusgwovo|rxlujjgxogcctrxaoe|zerbaxwdzxpztvucdf2)\""},"group_id":""},{"uuid":"299982922144124675","rule_name":"msf_busybox_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.004","name":"UNIX SHELL"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"telnetd\\s+-l\\s+(.*?\\/)?(?:ba|z|da|tc|c|k)?sh\\s+-p\\s+\\d+\""},"group_id":""},{"uuid":"299982922144124676","rule_name":"msf_jjs_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-005","alarm_name":"反弹shell","alarm_title":"发现可疑的反弹shell命令%(cmd)","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"反弹shell是服务器主动连接其他主机的行为，攻击者通常会通过反弹shell方式来控制内网中的主机。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"eval\\(new\\s+java\\.lang\\.String\\(java\\.util\\.Base64\\.decoder\\.decode\\('[a-zA-Z0-9+=\\/]+'\\)\\)\\);\""},"group_id":""},{"uuid":"299982922144124677","rule_name":"msf_lua_backdoor_a","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现Metasploit框架生成的后门命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过Metasploit攻击框架可以生成lua代码，执行后攻击者可以在服务端远程控制该服务器。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[11,12,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"lua.*?\\s+-e\\s+.*?require\\('socket'\\).*?assert.*?bind\\('\\*',\\d+\\).*?accept.*?while\\s+true.*?receive.*?assert\\(io\\.popen.*?assert.*?read.*?send.*?close\""},"group_id":""},{"uuid":"299982922144124679","rule_name":"msf_nodejs_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现Metasploit框架生成的后门命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过Metasploit攻击框架可以生成nodejs代码，执行后攻击者可以在服务端远程控制该服务器。"}],"score":9,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.007","name":"JAVASCRIPT"}],"platforms":[21,12,11,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname = node.exe and process_create.cmd matches \"-e\\s+'eval\\(\\\"(?:\\\\x[0-9a-zA-Z]{2})+\\\"\\);'\""},"group_id":""},{"uuid":"299982922144124698","rule_name":"py_hex_exec","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"发现异常执行python命令%(cmd)","handle_desc":"杀掉恶意进程并结合其他告警进行排查，确认攻击者如何获取到系统的初始访问权限。","action_desc":"攻击者通过python解释器解码并执行hex编码的恶意代码。"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"},{"uuid":"T1059.006","name":"PYTHON"},{"uuid":"T1140","name":"解混淆/解码文件或信息"},{"uuid":"T1202","name":"间接执行命令"}],"platforms":[21,11,12,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (python,python3,python.exe,python3.exe) and process_create.cmd matches \"import\\s+builtins.*?getattr\\(builtins, bytes\\.fromhex\\(.65786563.\\)\\.decode\\(\\)\\)\""},"group_id":""},{"uuid":"299982922144124749","rule_name":"msf_vbs_backdoor","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似MSF工具生成的恶意指令","handle_desc":"杀掉对应进程，判断是否有相关的文件和入侵痕迹，进一步处理。","action_desc":"疑似MSF工具生成的恶意指令通过cmd.exe执行"}],"score":10,"tactics":[{"uuid":"TA0002","name":"执行"}],"techniques":[{"uuid":"T1059","name":"命令行脚本解释器"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.pname in (cmd.exe) and process_create.cmd pmatch (\"CreateObject.*?XMLHTTP.*?Open.*?GET.*?Send.*?Execute.*?responseText\",\"CreateObject.*?XMLHTTP.*?Open.*?GET.*?Send.*?CreateObject.*?ADODB\\.Stream.*?SaveToFile.*?exe.*?WScript.Shell.*?Run.*?exe\")"},"group_id":""},{"uuid":"299982922144124782","rule_name":"使用scaninfo工具进行资产信息收集","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似使用scaninfo工具进行网络服务扫描或端口扫描","handle_desc":"杀死相关进程，通过告警和日志排查入侵痕迹","action_desc":"疑似使用开源的红队内外网打点扫描器，具有快速的端口扫描和服务。"}],"score":10,"tactics":[{"uuid":"TA0043","name":"侦查"}],"techniques":[{"uuid":"T1595","name":"主动扫描"},{"uuid":"T1590","name":"搜集网络信息"}],"platforms":[12,11,21,31,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd matches \"scaninfo(?:_linux_x64|_windows_x64)?(?:\\.exe)?\\s+.*?(?:(?:(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(?:\\.(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})\\/\\d+|-m\\s+\\b(?:ftp|ssh|smb|mssql|mysql|mgo|redis|psql|ms17010|smbghost|webfinger|netbios|findnet|all|port|ping|mem)\\b)\""},"group_id":""},{"uuid":"299982922144124793","rule_name":"利用sharpwmi工具","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似远程使用sharpwmi工具","handle_desc":"排查攻击来源，关闭恶意进程并删除恶意文件。","action_desc":"sharpwmi基于rpc的横向移动工具,具有上传和执行命令功能"}],"score":10,"tactics":[{"uuid":"TA0008","name":"横向移动"}],"techniques":[{"uuid":"T1570","name":"横向工具传输"},{"uuid":"T1021","name":"远程服务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"process_create.cmd pmatch (\"powershell\\s+-enc\\s+JAB3AG0AaQAgAD0AIABbAHcAbQBpAGMAbABhAHMAcwBdACIAUgBvAG8AdABcAGQAZQBmAGEAdQBsAHQAOgBzAHQAZABSAGUAZwBQAHIAbwB2ACIAOwAkAGQAYQB0AGEAPQAoACQAdwBtAGkALgBHAGUAdABTAHQAcgBpAG4AZwBWAGEAbAB1AGUA.*?(?:\\s|$)\",\"\\.exe\\s+(?:(?:(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(?:\\.(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3})\\s+\\w+\\s+\\S+|pth\\s+(?:(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(?:\\.(?:(?:2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3}))\\s+(?:cmd\\s+|upload\\s+.*?\\.exe\\s+[c-e]:\\\\.*?\\.exe)\",\"powershell\\s+-enc\\s+JABhAD0AKABwAG8AdwBlAHIAcwBoAGUAbABsACAALQBlAG4AYwAgA.*?(?:\\s|$)\")"},"group_id":""},{"uuid":"299982922144124808","rule_name":"禁用Defence服务","displays":[{"type":"default_source","alarm_type":"QTAL-002","alarm_name":"可疑进程参数","alarm_title":"疑似禁用Defence服务","handle_desc":"排查命令是否是正常操作，恢复Defender服务，通过其他告警和日志排查是否存在入侵痕迹","action_desc":"通过利用注册表禁用 Defender 日志记录，或禁用Defender计划任务"}],"score":9,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1543.003","name":"WINDOWS 服务"},{"uuid":"T1053","name":"计划任务/作业"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"system","created_at":"2022-12-01T09:48:35Z","updated_at":"2022-12-01T09:48:35Z","rule_roles":["1"],"rule_details":{"content":"pro.args pmatch (\"reg\\s+add.*?Autologger.*?(?:DefenderApiLogger|DefenderAuditLogger).*?Start.*?0\",\"reg\\s+add\\s+.*?CurrentControlSet.*?Services.*?(?:WdBoot|WdFilter|WdNisDrv|WdNisSvc|WinDefend).*?Start.*?REG_DWORD.*?4\",\"schtasks.*?Change.*?Windows\\s+Defender\\s+(?:Scheduled Scan|Verification).*?Disable\",\"reg\\s+add.*?Windows\\s+Defender.*?Disable.*?1\")"},"group_id":""}],"total":336}

{"data":[{"uuid":"299982922144145799","rule_name":"未知进程访问lsass进程_test","displays":[{"type":"default_source","alarm_type":"QTAL-009","alarm_name":"凭证窃取","alarm_title":"发现进程%(pname)尝试获取明文密码","handle_desc":"停止相关进程并删除恶意文件。","action_desc":"通过mimikatz的lsadump功能尝试从注册表导出结果中获取系统明文密码。"}],"score":10,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1003.001","name":"LSASS 内存"}],"platforms":[12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2022-12-13T10:27:01Z","updated_at":"2023-04-12T04:12:09Z","rule_roles":["2","1"],"rule_details":{"content":"process_access.pname in (\"mimikatz.exe\", \"procdump.exe\",\"Sqldumper.exe\",\"procdump64.exe\",\"rundll32.exe\",\"powershell.exe\") and process_access.dst_pname in (\"lsass.exe\")"},"group_id":""},{"uuid":"455908975171338285","rule_name":"恶意利用系统程序","displays":[{"type":"default_source","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现利用系统程序进程%(pname)异常获取系统进程内存写权限，疑似被写入恶意代码","handle_desc":"停止恶意进程，删除恶意文件","action_desc":"实时监控系统程序的进程访问行为"}],"score":10,"tactics":[{"uuid":"TA0004","name":"权限提升"},{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1003.001","name":"LSASS 内存"},{"uuid":"T1055","name":"进程注入"},{"uuid":"T1068","name":"特权提升漏洞"}],"platforms":[12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2023-04-12T04:08:45Z","updated_at":"2023-04-12T04:12:03Z","rule_roles":["2","1"],"rule_details":{"content":"process_access.pname in (\"rundll32.exe\", \"svchost.exe\") and process_access.dst_pname in (\"winlogon.exe\") and process_access.granted_access in (0x38, 0x143a, 0x1438, 0x3a, 0x1fffff)"},"group_id":""}],"total":2}

{"data":[{"uuid":"440698864912039985","rule_name":"计划任务regsvr32后门","displays":[{"type":"scheduled_task_scan","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"扫描发现计划任务%(scheduled_task.name)调用regsvr32命令加载远程恶意代码","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者利用计划任务定时执行regsvr32恶意命令，以实现无文件类型的权限维持，更加隐蔽。"},{"type":"scheduled_task_create","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"发现新创建的计划任务%(scheduled_task.name)调用regsvr32命令加载远程恶意代码","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者利用计划任务定时执行regsvr32恶意命令，以实现无文件类型的权限维持，更加隐蔽。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1053","name":"计划任务/作业"},{"uuid":"T1053.005","name":"计划任务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2022-12-28T05:49:52Z","updated_at":"2023-03-31T02:14:40Z","rule_roles":[],"rule_details":{"content":"scheduled_task.task_content matches \"<Command>(?:.(?:!<Command>))*?[rR][eE][gG][sS][vV][rR]32.*?(?:(?:[hH][tT][tT][pP]\\:\\/\\/)|(?:[hH][tT][tT][pP][sS]\\:\\/\\/)|(?:\\\\\\\\))(?!127\\.0\\.0\\.1|10\\.|172\\.[1-3][0-9]\\.|192\\.168\\.|localhost)[\\w\\-]+\\..*[sS][cC][rR][oO][bB][jJ].*?<\\/Arguments>\""},"group_id":""},{"uuid":"440700860092121137","rule_name":"计划任务cmd变量拼接执行后门","displays":[{"type":"scheduled_task_scan","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"扫描发现计划任务%(scheduled_task.name)利用cmd变量拼接混淆执行恶意命令","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意的cmd命令添加到计划任务中定时执行，以实现权限维持。"},{"type":"scheduled_task_create","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"发现新创建的计划任务%(scheduled_task.name)利用cmd变量拼接混淆执行恶意命令","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意的cmd命令添加到计划任务中定时执行，以实现权限维持。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1053","name":"计划任务/作业"},{"uuid":"T1053.005","name":"计划任务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2022-12-28T06:09:42Z","updated_at":"2023-03-31T02:13:27Z","rule_roles":[],"rule_details":{"content":"scheduled_task.task_content matches \"<Command>(?:.(?:!<Command>))*?cmd(?:\\.exe)?.*?\\/c\\s+['\\\"].*?\\bset\\s+\\w+=\\w+\\s*&\\s*call\\s+%\\w+%\\w+\\s+.*?<\\/Arguments>\""},"group_id":""},{"uuid":"440699489963999281","rule_name":"计划任务powershell远程下载后门","displays":[{"type":"scheduled_task_scan","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"扫描发现计划任务%(scheduled_task.name)调用powershell远程下载执行恶意代码","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意的powershell命令添加到计划任务中定时执行，以实现无文件类型的权限维持，更加隐蔽。"},{"type":"scheduled_task_create","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"发现新创建的计划任务%(scheduled_task.name)调用powershell远程下载执行恶意代码","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意的powershell命令添加到计划任务中定时执行，以实现无文件类型的权限维持，更加隐蔽。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1053","name":"计划任务/作业"},{"uuid":"T1053.005","name":"计划任务"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2022-12-28T05:56:05Z","updated_at":"2023-03-31T02:13:11Z","rule_roles":[],"rule_details":{"content":"scheduled_task.task_content matches \"<Command>(?:.(?:!<Command>))*?(?:(?:[iI][eE][xX]\\s*\\(?:[iI][wW][rR]\\s*https?:\\/\\/)|(?:https?:\\/\\/.*[iI][eE][xX]\\s*\\(?:[iI][wW][rR])).*?<\\/Arguments>\""},"group_id":""},{"uuid":"440696974371455025","rule_name":"计划任务恶意EXE文件检测","displays":[{"type":"scheduled_task_scan","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"扫描发现计划任务%(scheduled_task.name)执行恶意的EXE文件%(fpath)","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意后门添加到计划任务中定时执行，以实现权限维持。"},{"type":"scheduled_task_create","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"发现新创建的计划任务%(scheduled_task.name)执行恶意的EXE文件%(fpath)","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意后门添加到计划任务中定时执行，以实现权限维持。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1053","name":"计划任务/作业"},{"uuid":"T1053.005","name":"计划任务"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-28T05:31:06Z","updated_at":"2023-02-21T02:24:37Z","rule_roles":[],"rule_details":{"content":"scheduled_task.task_content gmatch \"(?-sm)<Command>['\\\"]?\\b([a-zA-Z]:(?:\\\\|\\/)(?:(?!\\b(?:python(?:\\d(?:\\.\\d+)?)?|powershell|system32\\\\(?:cmd|regsvr32|mshta|rundll32))\\.exe).)*?\\.exe)['\\\"]?<\\/Command>\""},"group_id":""},{"uuid":"440698090475749425","rule_name":"计划任务恶意PS1文件检测","displays":[{"type":"scheduled_task_scan","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"扫描发现计划任务%(scheduled_task.name)执行恶意的powershell脚本%(script.fpath)","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意powershell脚本后门添加到计划任务中定时执行，以实现权限维持。"},{"type":"scheduled_task_create","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"发现新创建的计划任务%(scheduled_task.name)执行恶意的powershell脚本%(script.fpath)","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意powershell脚本后门添加到计划任务中定时执行，以实现权限维持。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1053","name":"计划任务/作业"},{"uuid":"T1053.005","name":"计划任务"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-28T05:42:11Z","updated_at":"2023-02-21T02:24:29Z","rule_roles":[],"rule_details":{"content":"scheduled_task.task_content gmatch \"<Command>.*?powershell(?:\\.exe)?.*?\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.ps1).*?<\\/Arguments>\""},"group_id":""},{"uuid":"440697896749236273","rule_name":"计划任务恶意PY文件检测","displays":[{"type":"scheduled_task_scan","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"扫描发现计划任务%(scheduled_task.name)执行恶意的python脚本%(script.fpath)","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意python脚本后门添加到计划任务中定时执行，以实现权限维持。"},{"type":"scheduled_task_create","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"发现新创建的计划任务%(scheduled_task.name)执行恶意的python脚本%(script.fpath)","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意python脚本后门添加到计划任务中定时执行，以实现权限维持。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1053","name":"计划任务/作业"},{"uuid":"T1053.005","name":"计划任务"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-28T05:40:15Z","updated_at":"2023-02-21T02:24:19Z","rule_roles":[],"rule_details":{"content":"scheduled_task.task_content gmatch \"<Command>.*?python[\\d.]*(?:\\.exe)?.*?\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.py).*?<\\/Arguments>\""},"group_id":""},{"uuid":"440697376286441521","rule_name":"计划任务恶意BAT文件检测","displays":[{"type":"scheduled_task_scan","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"扫描发现计划任务%(scheduled_task.name)执行恶意的BAT脚本%(script.fpath)","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意的BAT脚本后门添加到计划任务中定时执行，以实现权限维持。"},{"type":"scheduled_task_create","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"发现新创建的计划任务%(scheduled_task.name)执行恶意的BAT脚本%(script.fpath)","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意的BAT脚本后门添加到计划任务中定时执行，以实现权限维持。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1053","name":"计划任务/作业"},{"uuid":"T1053.005","name":"计划任务"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-28T05:35:05Z","updated_at":"2023-02-21T02:24:11Z","rule_roles":[],"rule_details":{"content":"scheduled_task.task_content gmatch \"<Command>['\\\"]?\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.bat)['\\\"]?<\\/Command>\" or scheduled_task_create.task_content matches \"<Arguments>.*?['\\\"]?\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.bat)['\\\"]?.*?<\\/Arguments>\""},"group_id":""},{"uuid":"440698141411377201","rule_name":"计划任务恶意DLL文件检测","displays":[{"type":"scheduled_task_scan","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"扫描发现计划任务%(scheduled_task.name)执行恶意DLL文件%(fpath)","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意DLL后门添加到计划任务中定时执行，以实现权限维持。"},{"type":"scheduled_task_create","alarm_type":"QTAL-023","alarm_name":"恶意计划任务","alarm_title":"发现新创建的计划任务%(scheduled_task.name)执行恶意DLL文件%(fpath)","handle_desc":"删除相关计划任务以及恶意文件。","action_desc":"攻击者可将恶意DLL后门添加到计划任务中定时执行，以实现权限维持。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1053","name":"计划任务/作业"},{"uuid":"T1053.005","name":"计划任务"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-28T05:42:41Z","updated_at":"2023-02-21T02:23:30Z","rule_roles":[],"rule_details":{"content":"scheduled_task.task_content gmatch \"<Command>.*?rundll32(?:\\.exe)?.*?\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.dll).*?<\\/Arguments>\""},"group_id":""}],"total":8}

{"data":[{"uuid":"436769414918963248","rule_name":"凭证窃取-读文件","displays":[{"type":"default_source","alarm_type":"QTAL-009","alarm_name":"凭证窃取","alarm_title":"发现进程%(pname)读取Edge密码文件passwd.txt(此处自测创建的文件)","handle_desc":"停止相关进程并进行溯源。","action_desc":"攻击者可以通过读取/etc/passwd或者/etc/shadow获取密码hash，再通过hash碰撞获取明文密码"}],"score":2,"tactics":[{"uuid":"TA0002","name":"执行"},{"uuid":"TA0001","name":"初始访问"}],"techniques":[{"uuid":"T1053.005","name":"计划任务"}],"platforms":[31,11],"data_type":2,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T03:14:18Z","updated_at":"2023-05-17T09:32:24Z","rule_roles":["2"],"rule_details":{"content":"file_read.pname not in ('bash', 'ssh', 'sshd') and (file_read.fpath = '/etc/passwd')","file_handle_type":"1"},"group_id":""},{"uuid":"455769637322227757","rule_name":"变更系统文件权限为所有人或普通用户可读可写","displays":[{"type":"default_source","alarm_type":"QTAL-028","alarm_name":"系统文件权限变更","alarm_title":"发现进程%(pname)将系统文件%(fname)的权限变更为普通用户可读可写的可疑行为","handle_desc":"停止恶意进程，将系统文件权限恢复","action_desc":"系统system32目录下的文件权限被修改，攻击者可以篡改该系统目录中的文件内容劫持系统进程执行流程。"}],"score":7,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1574","name":"劫持执行流程"},{"uuid":"T1574.010","name":"服务文件权限缺陷"},{"uuid":"T1574.005","name":"可执行安装文件权限缺陷"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"bing.fang","created_at":"2023-04-11T05:04:33Z","updated_at":"2023-05-11T03:39:31Z","rule_roles":["1"],"rule_details":{"content":"file_permission_change.fpath contains \"c:\\windows\\system32\" and not file_permission_change.old_sd matches \"\\(A;[^\\s\\(\\)]*;FA;[^\\s\\(\\)]+(?:WD|BU)\\)\" and file_permission_change.new_sd matches \"\\(A;[^\\s\\(\\)]*;FA;[^\\s\\(\\)]+(?:WD|BU)\\)\"","file_handle_type":"4"},"group_id":""},{"uuid":"455769477166923821","rule_name":"变更系统文件所有者TrustedInstaller为其他用户","displays":[{"type":"default_source","alarm_type":"QTAL-028","alarm_name":"系统文件权限变更","alarm_title":"发现进程%(pname)修改敏感系统文件%(fname)的所有者","handle_desc":"停止恶意进程，将系统文件权限恢复","action_desc":"系统system32目录下的文件所有者被修改，攻击者可以篡改该系统目录中的文件内容劫持系统进程执行流程。"}],"score":7,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1574","name":"劫持执行流程"},{"uuid":"T1574.010","name":"服务文件权限缺陷"},{"uuid":"T1574.005","name":"可执行安装文件权限缺陷"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"bing.fang","created_at":"2023-04-11T05:02:57Z","updated_at":"2023-05-11T03:39:05Z","rule_roles":["1"],"rule_details":{"content":"file_permission_change.fpath contains \"c:\\\\windows\\\\system32\" and file_permission_change.old_sd matches \"^O:S-1-5-80-\" and not file_permission_change.new_sd matches \"^O:S-1-5-80-\"","file_handle_type":"4"},"group_id":""},{"uuid":"449696754086969393","rule_name":"NIC投毒","displays":[{"type":"default_source","alarm_type":"QTAL-035","alarm_name":"BypassUAC","alarm_title":"发现非.NET框架进程%(pname)修改镜像缓存文件%(fpath)，疑似利用NIC投毒绕过UAC","handle_desc":"停止恶意进程，删除恶意文件。","action_desc":"攻击者利用系统白名单程序或COM接口绕过UAC之后可获取到完整的管理员权限。"}],"score":9,"tactics":[{"uuid":"TA0004","name":"权限提升"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1548","name":"滥用权限控制机制"},{"uuid":"T1548.002","name":"绕过用户账户控制"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"bing.fang","created_at":"2023-02-28T07:35:52Z","updated_at":"2023-05-11T03:35:45Z","rule_roles":["1"],"rule_details":{"content":"file_write_close.fpath matches \"\\\\windows\\\\assembly\\\\nativeimages_v.*?\\.ni\\.dll$\" and not file_write_close.path contains \"Microsoft.NET\"","file_handle_type":"5"},"group_id":""},{"uuid":"451843463097352237","rule_name":"窃取Firefox浏览器中保存的凭证","displays":[{"type":"default_source","alarm_type":"QTAL-009","alarm_name":"凭证窃取","alarm_title":"发现可疑进程%(pname)尝试读取Firefox浏览器中保存凭证的数据库文件%(fpath)","handle_desc":"停止恶意进程","action_desc":"攻击者通过对Firefox浏览器数据目录中保存的用户数据文件离线破解可获取用户登录过的网站凭证"}],"score":6,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1539","name":"窃取 WEB 会话 COOKIE"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-15T03:01:31Z","updated_at":"2023-04-25T05:31:53Z","rule_roles":["1","2"],"rule_details":{"content":"file_read.fpath matches \"AppData\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\\\\.*?default\" and not file_read.pname matches \"firefox\\.exe|everything\\.exe|titanagent\\.exe\"","file_handle_type":"1"},"group_id":""},{"uuid":"451842562211184685","rule_name":"窃取360浏览器中保存的凭证","displays":[{"type":"default_source","alarm_type":"QTAL-009","alarm_name":"凭证窃取","alarm_title":"发现非360浏览器进程%(pname)读取在360浏览器中保存的凭证文件%(fpath)","handle_desc":"停止恶意进程，删除恶意文件。","action_desc":"攻击者可对浏览器数据目录中获取到保存Web访问凭证的数据库文件进行离线破解，获取用户登录过的网站凭证信息。"}],"score":6,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1539","name":"窃取 WEB 会话 COOKIE"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-15T02:52:34Z","updated_at":"2023-04-25T05:31:50Z","rule_roles":["1","2"],"rule_details":{"content":"file_read.fpath matches \"AppData\\\\Roaming\\\\360se\\d+\\\\User Data\\\\Default\\\\.*?assis2\\.db\" and not file_read.pname matches \"360se\\.exe||360chrome\\.exe|everything\\.exe|titanagent\\.exe\"","file_handle_type":"1"},"group_id":""},{"uuid":"451749988435755053","rule_name":"窃取chrome浏览器中保存的凭证","displays":[{"type":"default_source","alarm_type":"QTAL-009","alarm_name":"凭证窃取","alarm_title":"发现可疑进程%(pname)尝试读取chrome保存凭证的数据文件%(fpath)","handle_desc":"停止恶意进程","action_desc":"攻击者通过解析chrome浏览器的会话数据文件获取用户网站凭证"}],"score":6,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1539","name":"窃取 WEB 会话 COOKIE"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-14T11:32:56Z","updated_at":"2023-04-25T05:31:47Z","rule_roles":["1","2"],"rule_details":{"content":"file_read.fpath matches \"AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\(?:History|Bookmarks|Cookies)\" and not file_read.pname matches \"chrome\\.exe|everything\\.exe|titanagent\\.exe\"","file_handle_type":"1"},"group_id":""},{"uuid":"451844059510603821","rule_name":"窃取SecureCRT工具中保存的凭证","displays":[{"type":"default_source","alarm_type":"QTAL-009","alarm_name":"凭证窃取","alarm_title":"发现可疑进程%(pname)尝试读取SecureCRT配置文件%(fpath)中保存的凭证信息","handle_desc":"停止恶意进程","action_desc":"攻击者通过解析SecureCRT配置文件中获取用户服务器登录凭证"}],"score":6,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1539","name":"窃取 WEB 会话 COOKIE"}],"platforms":[12,32],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-15T03:07:26Z","updated_at":"2023-04-25T05:31:44Z","rule_roles":["1","2"],"rule_details":{"content":"file_read.fpath matches \"AppData\\\\Roaming\\\\VanDyke\\\\Config\\\\Sessions\\\\.*?\\.ini\" and not file_read.pname matches \"securecrt\\.exe|everything\\.exe|titanagent\\.exe\"","file_handle_type":"1"},"group_id":""},{"uuid":"299982922144124845","rule_name":"读取系统敏感文件","displays":[{"type":"default_source","alarm_type":"QTAL-009","alarm_name":"凭证窃取","alarm_title":"发现进程%(pname)读取账号密码相关的敏感文件","handle_desc":"停止相关进程并进行溯源。","action_desc":"攻击者可以通过读取/etc/passwd或者/etc/shadow获取密码hash，再通过hash碰撞获取明文密码"}],"score":2,"tactics":[{"uuid":"TA0006","name":"凭证访问"}],"techniques":[{"uuid":"T1552.001","name":"文件中的凭证"}],"platforms":[11,31],"data_type":1,"active":2,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-01T09:48:43Z","updated_at":"2023-04-25T05:31:40Z","rule_roles":["1"],"rule_details":{"content":"file_read.pname in (cat,head,tail,tac,less,more,vi,vim,nano,getent,vipw,vigr)  and file_read.fpath matches \"((\\/etc\\/passwd)|(\\/etc\\/shadow))\"","file_handle_type":"1"},"group_id":""},{"uuid":"451739232545800237","rule_name":"利用bitsadmin写远程可执行文件到本地","displays":[{"type":"file_write","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现攻击者利用系统签名程序bitsadmin.exe写入可执行文件%(fpath)","handle_desc":"删除恶意文件，停止相关的恶意进程。","action_desc":"bitsadmin.exe是系统自带的程序，可以被攻击者恶意利用于远程文件下载，将远程可执行文件写入到系统上并执行。"}],"score":8,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1218","name":"利用签名程序代理执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"只配置监控了临时目录、桌面目录位置","operate_name":"admin","created_at":"2023-03-14T09:46:05Z","updated_at":"2023-03-14T11:17:26Z","rule_roles":["1","2"],"rule_details":{"content":"file_write.fpath matches \"\\.exe$\" and file_write.pname in (\"bitsadmin.exe\")","file_handle_type":"2"},"group_id":""},{"uuid":"451748401680220205","rule_name":"利用bitsadmin写远程脚本文件到本地","displays":[{"type":"file_write","alarm_type":"QTAL-010","alarm_name":"恶意利用系统文件","alarm_title":"发现攻击者利用系统签名程序bitsadmin.exe写入脚本文件%(fpath)","handle_desc":"删除恶意文件，停止相关的恶意进程。","action_desc":"bitsadmin.exe是系统自带的程序，可以被攻击者恶意利用于远程文件下载，将远程脚本文件写入到系统上并执行。"}],"score":8,"tactics":[{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1218","name":"利用签名程序代理执行"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"只配置监控了临时目录、桌面目录位置","operate_name":"admin","created_at":"2023-03-14T11:17:10Z","updated_at":"2023-03-14T11:17:10Z","rule_roles":["1","2"],"rule_details":{"content":"file_write.fpath matches \"\\.(?:ps1|bat|py|js|txt)$\" and file_write.pname in (\"bitsadmin.exe\")","file_handle_type":"2"},"group_id":""}],"total":11}

{"data":[{"uuid":"456059552916308013","rule_name":"调用ICMLuaUtil接口BypassUAC","displays":[{"type":"default_source","alarm_type":"QTAL-035","alarm_name":"BypassUAC","alarm_title":"发现进程%(pname)尝试加载系统关键COM组件%(fname)，疑似调用ICMLuaUtil接口绕过UAC执行恶意命令","handle_desc":"停止恶意进程，删除恶意文件。","action_desc":"攻击者利用系统白名单程序或COM接口绕过UAC之后可获取到完整的管理员权限。"}],"score":8,"tactics":[{"uuid":"TA0004","name":"权限提升"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1548","name":"滥用权限控制机制"},{"uuid":"T1548.002","name":"绕过用户账户控制"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2023-04-13T05:04:36Z","updated_at":"2023-04-14T09:27:19Z","rule_roles":[],"rule_details":{"content":"module_load.p_signature_status =invalid and module_load.module_fpath matches \"C:\\\\Windows\\\\(?:System32|SysWOW64)\\\\(?:cmlua|cmutil)\\.dll\" and not module_load.path contains \"explorer.exe\""},"group_id":""},{"uuid":"456059628849987629","rule_name":"调用IColorDataProxy接口BypassUAC(DccwCOM)_test","displays":[{"type":"default_source","alarm_type":"QTAL-035","alarm_name":"BypassUAC","alarm_title":"发现进程%(pname)尝试加载系统关键COM组件%(fname)，疑似调用IColorDataProxy接口绕过UAC执行恶意命令","handle_desc":"停止恶意进程，删除恶意文件。","action_desc":"攻击者利用系统白名单程序或COM接口绕过UAC之后可获取到完整的管理员权限。"}],"score":8,"tactics":[{"uuid":"TA0004","name":"权限提升"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1548","name":"滥用权限控制机制"},{"uuid":"T1548.002","name":"绕过用户账户控制"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2023-04-13T05:05:21Z","updated_at":"2023-04-13T05:05:21Z","rule_roles":[],"rule_details":{"content":"module_load.p_integrity_level in (Low, Medium) and module_load.p_signature_status =invalid and module_load.module_fpath matches \"C:\\\\Windows\\\\(?:System32|SysWOW64)\\\\colorui\\.dll\" and not module_load.path contains \"explorer.exe\""},"group_id":""},{"uuid":"449861227896635437","rule_name":"调用IColorDataProxy接口BypassUAC(DccwCOM)","displays":[{"type":"default_source","alarm_type":"QTAL-035","alarm_name":"BypassUAC","alarm_title":"发现进程%(pname)尝试加载系统关键COM组件%(fname)，疑似调用IColorDataProxy接口绕过UAC执行恶意命令","handle_desc":"停止恶意进程，删除恶意文件。","action_desc":"攻击者利用系统白名单程序或COM接口绕过UAC之后可获取到完整的管理员权限。"}],"score":8,"tactics":[{"uuid":"TA0004","name":"权限提升"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1548","name":"滥用权限控制机制"},{"uuid":"T1548.002","name":"绕过用户账户控制"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2023-03-01T10:49:46Z","updated_at":"2023-04-13T05:04:56Z","rule_roles":[],"rule_details":{"content":"module_load.p_integrity_level in (Low, Medium) and module_load.p_signature_status =invalid and module_load.module_fpath matches \"C:\\\\Windows\\\\(?:System32|SysWOW64)\\\\colorui\\.dll\" and module_load.cmd contains \"explorer.exe\" and not module_load.path contains \"explorer.exe\""},"group_id":""},{"uuid":"449708272887267377","rule_name":"调用ICMLuaUtil接口BypassUAC(ICMLuaUtilShellExec)","displays":[{"type":"default_source","alarm_type":"QTAL-035","alarm_name":"BypassUAC","alarm_title":"发现进程%(pname)尝试加载系统关键COM组件%(fname)，疑似调用ICMLuaUtil接口绕过UAC执行恶意命令","handle_desc":"停止恶意进程，删除恶意文件。","action_desc":"攻击者利用系统白名单程序或COM接口绕过UAC之后可获取到完整的管理员权限。"}],"score":8,"tactics":[{"uuid":"TA0004","name":"权限提升"},{"uuid":"TA0005","name":"逃避防御"}],"techniques":[{"uuid":"T1548","name":"滥用权限控制机制"},{"uuid":"T1548.002","name":"绕过用户账户控制"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2023-02-28T09:30:18Z","updated_at":"2023-04-13T05:03:44Z","rule_roles":[],"rule_details":{"content":"module_load.p_integrity_level in (low, medium) and module_load.p_signature_status =invalid and module_load.module_fpath matches \"C:\\\\Windows\\\\(?:System32|SysWOW64)\\\\(?:cmlua|cmutil)\\.dll\" and module_load.cmd contains \"explorer.exe\" and not module_load.path contains \"explorer.exe\""},"group_id":""}],"total":4}

{"data":[{"uuid":"459418748357443629","rule_name":"性能测试规则","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现Userinit注册表值为%(registry.value)，其中包含恶意命令","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者可以通过修改Winlogon默认的Userinit配置，令用户登录时 Winlogon 进程将自动执行恶意命令实现权限维持。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程修改Userinit注册表值为%(registry.value)，包含恶意命令","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者可以通过修改Winlogon默认的Userinit配置，令用户登录时 Winlogon 进程将自动执行恶意命令实现权限维持。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":2,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"na.mei","created_at":"2023-05-06T09:15:12Z","updated_at":"2023-05-06T09:15:12Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and   registry.new_value matches \"abcdef\""},"group_id":""},{"uuid":"440577815369220144","rule_name":"Winlogon Userinit配置检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现Userinit注册表值为%(registry.value)，其中包含恶意命令","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者可以通过修改Winlogon默认的Userinit配置，令用户登录时 Winlogon 进程将自动执行恶意命令实现权限维持。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程修改Userinit注册表值为%(registry.value)，包含恶意命令","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者可以通过修改Winlogon默认的Userinit配置，令用户登录时 Winlogon 进程将自动执行恶意命令实现权限维持。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"na.mei","created_at":"2022-12-27T09:47:21Z","updated_at":"2023-05-06T09:14:15Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\b\" and registry.value_name in (Userinit) and registry.new_value matches \"userinit\\.exe,.*?(?:powershell|cmd|rundll32)\""},"group_id":""},{"uuid":"440884517473878065","rule_name":"IFEO映像劫持检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现可疑的IFEO注册表项%(registry.value_name)，%(registry.value_name)命令执行时将被劫持执行%(registry.value)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过添加IFEO注册表项，可以实现劫持目标程序的执行流程。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程添加可疑的IFEO注册表项%(registry.value_name)，%(registry.value_name)命令执行时将被劫持执行%(registry.value)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过添加IFEO注册表项，可以实现劫持目标程序的执行流程。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2022-12-29T12:34:10Z","updated_at":"2023-05-06T04:21:52Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\b\" and registry.value_name contains \"Debugger\""},"group_id":""},{"uuid":"440575588562894896","rule_name":"Run自启动项EXE检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现Run自启动项%(registry.value_name)中包含恶意的二进制文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加Run自启动项可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程%(registry.action)的Run自启动项%(registry.value_name)中包含恶意的二进制文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加Run自启动项可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"liwei.liu","created_at":"2022-12-27T09:25:14Z","updated_at":"2023-04-14T09:52:17Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.exe)\""},"group_id":""},{"uuid":"452607838410244141","rule_name":"系统服务项脚本检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现注册表%(registry.path)中包含恶意的服务脚本文件%(script.fpath)","handle_desc":"清理相关服务以及恶意文件。","action_desc":"攻击者通过将恶意文件注册为系统服务可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程添加恶意系统服务，该服务对应的脚本文件%(script.fpath)包含恶意代码","handle_desc":"清理相关服务以及恶意文件。","action_desc":"攻击者通过将恶意文件注册为系统服务可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-20T09:34:54Z","updated_at":"2023-03-20T09:34:54Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.(?:bat|ps1|py|vbs))\""},"group_id":""},{"uuid":"440883617678229553","rule_name":"系统服务项EXE检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现注册表%(registry.path)中包含恶意的服务二进制文件%(registry.value)","handle_desc":"清理相关服务以及恶意文件。","action_desc":"攻击者通过将恶意文件注册为系统服务可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程添加恶意系统服务，该服务对应的二进制文件%(fpath)包含恶意代码","handle_desc":"清理相关服务以及恶意文件。","action_desc":"攻击者通过将恶意文件注册为系统服务可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[12,32],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-29T12:25:14Z","updated_at":"2023-03-20T09:34:04Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.exe)\""},"group_id":""},{"uuid":"452607717446516781","rule_name":"RunServices自启动项脚本检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现RunServices自启动项%(registry.value_name)中包含恶意脚本文件%(script.fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunServices自启动项可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程添加的RunServices自启动项%(registry.value_name)中包含恶意脚本文件%(script.fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunServices自启动项可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-20T09:33:42Z","updated_at":"2023-03-20T09:33:42Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServices\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.(?:bat|ps1|py|vbs))\""},"group_id":""},{"uuid":"440577298849071152","rule_name":"RunServices自启动项EXE检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现RunServices自启动项%(registry.value_name)中包含恶意二进制文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunServices自启动项可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程添加的RunServices自启动项%(registry.value_name)中包含恶意二进制文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunServices自启动项可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-27T09:42:13Z","updated_at":"2023-03-20T09:33:12Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServices\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.exe)\""},"group_id":""},{"uuid":"452607654464847917","rule_name":"Run自启动项脚本检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现Run自启动项%(registry.value_name)中包含恶意的脚本文件%(script.fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加Run自启动项可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程添加的Run自启动项%(registry.value_name)中包含恶意的脚本文件%(script.fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加Run自启动项可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-20T09:33:04Z","updated_at":"2023-03-20T09:33:04Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.(?:bat|ps1|py|vbs))\""},"group_id":""},{"uuid":"452607601817944109","rule_name":"RunOnceEx自启动项脚本检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现RunOnceEx自启动项%(registry.value_name)中包含恶意的脚本文件%(script.fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunOnceEx自启动项可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程添加的RunOnceEx自启动项%(registry.value_name)中包含恶意的脚本文件%(script.fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunOnceEx自启动项可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-20T09:32:33Z","updated_at":"2023-03-20T09:32:33Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.(?:bat|ps1|py|vbs))\""},"group_id":""},{"uuid":"440576273140416560","rule_name":"RunOnceEx自启动项EXE检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现RunOnceEx自启动项%(registry.value_name)中包含恶意的二进制文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunOnceEx自启动项可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程添加的RunOnceEx自启动项%(registry.value_name)中包含恶意的二进制文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunOnceEx自启动项可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-27T09:32:02Z","updated_at":"2023-03-20T09:31:51Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.exe)\""},"group_id":""},{"uuid":"452607425741062189","rule_name":"RunServicesOnce自启动项脚本检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现RunServicesOnce自启动项%(registry.value_name)中包含恶意的脚本文件%(script.fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunServicesOnce自启动项可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程添加的RunServicesOnce自启动项%(registry.value_name)中包含恶意的脚本文件%(script.fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunServicesOnce自启动项可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-20T09:30:48Z","updated_at":"2023-03-20T09:30:48Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServicesOnce\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.(?:bat|ps1|py|vbs))\""},"group_id":""},{"uuid":"440577350388678704","rule_name":"RunServicesOnce自启动项EXE检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现RunServicesOnce自启动项%(registry.value_name)中包含恶意的二进制文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunServicesOnce自启动项可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程添加的RunServicesOnce自启动项%(registry.value_name)中包含恶意的二进制文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunServicesOnce自启动项可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-27T09:42:44Z","updated_at":"2023-03-20T09:28:59Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServicesOnce\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.exe)\""},"group_id":""},{"uuid":"452607213861601325","rule_name":"RunOnce自启动项脚本检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现RunOnce自启动项%(registry.value_name)中包含恶意的脚本文件%(script.fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunOnce自启动项可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)j进程添加的RunOnce自启动项%(registry.value_name)中包含恶意的脚本文件%(script.fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunOnce自启动项可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2023-03-20T09:28:42Z","updated_at":"2023-03-20T09:28:42Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.(?:bat|ps1|py|vbs))\""},"group_id":""},{"uuid":"440576171772477488","rule_name":"RunOnce自启动项EXE检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现RunOnce自启动项%(registry.value_name)中包含恶意的二进制文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunOnce自启动项可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)j进程添加的RunOnce自启动项%(registry.value_name)中包含恶意的二进制文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunOnce自启动项可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-27T09:31:02Z","updated_at":"2023-03-20T09:23:26Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.exe)\""},"group_id":""},{"uuid":"440576461213007920","rule_name":"RunOnceEx自启动DLL项检测","displays":[{"type":"registry_scan","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"扫描发现RunOnceEx自启动项%(registry.value_name)中包含恶意的DLL文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunOnceEx自启动DLL可以实现恶意程序的开机自启动。"},{"type":"registry_monitor","alarm_type":"QTAL-025","alarm_name":"可疑注册表操作","alarm_title":"发现%(pname)进程添加的RunOnceEx自启动项%(registry.value_name)中包含恶意的DLL文件%(fpath)","handle_desc":"清理相关注册表以及恶意文件。","action_desc":"攻击者通过在注册表中添加RunOnceEx自启动DLL可以实现恶意程序的开机自启动。"}],"score":10,"tactics":[{"uuid":"TA0003","name":"权限维持"}],"techniques":[{"uuid":"T1037","name":"开机或登录自启动脚本"},{"uuid":"T1037.005","name":"自启动项"}],"platforms":[32,12],"data_type":1,"active":1,"custom":"default","min_version":"v1.0.0","max_version":"v999.999.999","comment":"","operate_name":"admin","created_at":"2022-12-27T09:33:54Z","updated_at":"2023-03-07T02:14:22Z","rule_roles":[],"rule_details":{"content":"registry.activity in (registry_value_create, registry_value_change) and registry.root_key matches \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\.*?\\\\Depend\\b\" and registry.new_value matches \"\\b([a-zA-Z]:(?:\\\\|\\/).*?\\.dll)\""},"group_id":""}],"total":16}